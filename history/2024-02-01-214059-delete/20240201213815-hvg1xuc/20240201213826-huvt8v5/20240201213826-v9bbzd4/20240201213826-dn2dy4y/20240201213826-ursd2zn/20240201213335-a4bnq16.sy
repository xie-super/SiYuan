{"ID":"20240201213335-a4bnq16","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240201213335-a4bnq16","title":"reentrantlock","updated":"20240201213335"},"Children":[{"ID":"20240201213336-vvr3z9n","Type":"NodeThematicBreak","Properties":{"id":"20240201213336-vvr3z9n","updated":"20240201213336"}},{"ID":"20240201213337-4ykglcb","Type":"NodeParagraph","Properties":{"id":"20240201213337-4ykglcb","updated":"20240201213337"},"Children":[{"Type":"NodeText","Data":"title: ä»ReentrantLockçš„å®ç°çœ‹AQSçš„åŸç†åŠåº”ç”¨"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"category: Java"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"tag:"}]},{"ID":"20240201213338-qjj4jyf","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213338-qjj4jyf","updated":"20240201213338"},"Children":[{"ID":"20240201213339-hb1e5ww","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213339-hb1e5ww","updated":"20240201213339"},"Children":[{"ID":"20240201213340-v3q0f6k","Type":"NodeParagraph","Properties":{"id":"20240201213340-v3q0f6k","updated":"20240201213340"},"Children":[{"Type":"NodeText","Data":"Javaå¹¶å‘"}]}]}]},{"ID":"20240201213341-wchw7wk","Type":"NodeThematicBreak","Properties":{"id":"20240201213341-wchw7wk","updated":"20240201213341"}},{"ID":"20240201213342-8nki081","Type":"NodeBlockquote","Properties":{"id":"20240201213342-8nki081","updated":"20240201213342"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213343-dz49zdv","Type":"NodeParagraph","Properties":{"id":"20240201213343-dz49zdv","updated":"20240201213343"},"Children":[{"Type":"NodeText","Data":"æœ¬æ–‡è½¬è½½è‡ªï¼š"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://tech.meituan.com/2019/12/05/aqs-theory-and-apply.html","TextMarkTextContent":"https://tech.meituan.com/2019/12/05/aqs-theory-and-apply.html"}]},{"ID":"20240201213344-lshkp3n","Type":"NodeParagraph","Properties":{"id":"20240201213344-lshkp3n","updated":"20240201213344"},"Children":[{"Type":"NodeText","Data":"ä½œè€…ï¼šç¾å›¢æŠ€æœ¯å›¢é˜Ÿ"}]}]},{"ID":"20240201213345-mbpgvif","Type":"NodeParagraph","Properties":{"id":"20240201213345-mbpgvif","updated":"20240201213345"},"Children":[{"Type":"NodeText","Data":"Java ä¸­çš„å¤§éƒ¨åˆ†åŒæ­¥ç±»ï¼ˆSemaphoreã€ReentrantLock ç­‰ï¼‰éƒ½æ˜¯åŸºäº AbstractQueuedSynchronizerï¼ˆç®€ç§°ä¸º AQSï¼‰å®ç°çš„ã€‚AQS æ˜¯ä¸€ç§æä¾›äº†åŸå­å¼ç®¡ç†åŒæ­¥çŠ¶æ€ã€é˜»å¡å’Œå”¤é†’çº¿ç¨‹åŠŸèƒ½ä»¥åŠé˜Ÿåˆ—æ¨¡å‹çš„ç®€å•æ¡†æ¶ã€‚"}]},{"ID":"20240201213346-nsgrwql","Type":"NodeParagraph","Properties":{"id":"20240201213346-nsgrwql","updated":"20240201213346"},"Children":[{"Type":"NodeText","Data":"æœ¬æ–‡ä¼šä»åº”ç”¨å±‚é€æ¸æ·±å…¥åˆ°åŸç†å±‚ï¼Œå¹¶é€šè¿‡ ReentrantLock çš„åŸºæœ¬ç‰¹æ€§å’Œ ReentrantLock ä¸ AQS çš„å…³è”ï¼Œæ¥æ·±å…¥è§£è¯» AQS ç›¸å…³ç‹¬å é”çš„çŸ¥è¯†ç‚¹ï¼ŒåŒæ—¶é‡‡å–é—®ç­”çš„æ¨¡å¼æ¥å¸®åŠ©å¤§å®¶ç†è§£ AQSã€‚ç”±äºç¯‡å¹…åŸå› ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦é˜è¿° AQS ä¸­ç‹¬å é”çš„é€»è¾‘å’Œ Sync Queueï¼Œä¸è®²è¿°åŒ…å«å…±äº«é”å’Œ Condition Queue çš„éƒ¨åˆ†ï¼ˆæœ¬ç¯‡æ–‡ç« æ ¸å¿ƒä¸º AQS åŸç†å‰–æï¼Œåªæ˜¯ç®€å•ä»‹ç»äº† ReentrantLockï¼Œæ„Ÿå…´è¶£åŒå­¦å¯ä»¥é˜…è¯»ä¸€ä¸‹ ReentrantLock çš„æºç ï¼‰ã€‚"}]},{"ID":"20240201213347-xgxb90z","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213347-xgxb90z","updated":"20240201213347"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"1 ReentrantLock"}]},{"ID":"20240201213348-96b1m3c","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213348-96b1m3c","updated":"20240201213348"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"1.1 ReentrantLock ç‰¹æ€§æ¦‚è§ˆ"}]},{"ID":"20240201213349-qouf8cn","Type":"NodeParagraph","Properties":{"id":"20240201213349-qouf8cn","updated":"20240201213349"},"Children":[{"Type":"NodeText","Data":"ReentrantLock æ„æ€ä¸ºå¯é‡å…¥é”ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿå¯¹ä¸€ä¸ªä¸´ç•Œèµ„æºé‡å¤åŠ é”ã€‚ä¸ºäº†å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£ ReentrantLock çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å…ˆå°† ReentrantLock è·Ÿå¸¸ç”¨çš„ Synchronized è¿›è¡Œæ¯”è¾ƒï¼Œå…¶ç‰¹æ€§å¦‚ä¸‹ï¼ˆè“è‰²éƒ¨åˆ†ä¸ºæœ¬ç¯‡æ–‡ç« ä¸»è¦å‰–æçš„ç‚¹ï¼‰ï¼š"}]},{"ID":"20240201213350-co0qbb1","Type":"NodeParagraph","Properties":{"id":"20240201213350-co0qbb1","updated":"20240201213350"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/412d294ff5535bbcddc0d979b2a339e6102264.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213351-16och9h","Type":"NodeParagraph","Properties":{"id":"20240201213351-16och9h","updated":"20240201213351"},"Children":[{"Type":"NodeText","Data":"ä¸‹é¢é€šè¿‡ä¼ªä»£ç ï¼Œè¿›è¡Œæ›´åŠ ç›´è§‚çš„æ¯”è¾ƒï¼š"}]},{"ID":"20240201213352-9km0chl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213352-9km0chl","updated":"20240201213352"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// **************************Synchronizedçš„ä½¿ç”¨æ–¹å¼**************************\n// 1.ç”¨äºä»£ç å—\nsynchronized (this) {}\n// 2.ç”¨äºå¯¹è±¡\nsynchronized (object) {}\n// 3.ç”¨äºæ–¹æ³•\npublic synchronized void test () {}\n// 4.å¯é‡å…¥\nfor (int i = 0; i \u003c 100; i++) {\n  synchronized (this) {}\n}\n// **************************ReentrantLockçš„ä½¿ç”¨æ–¹å¼**************************\npublic void test () throw Exception {\n  // 1.åˆå§‹åŒ–é€‰æ‹©å…¬å¹³é”ã€éå…¬å¹³é”\n  ReentrantLock lock = new ReentrantLock(true);\n  // 2.å¯ç”¨äºä»£ç å—\n  lock.lock();\n  try {\n    try {\n      // 3.æ”¯æŒå¤šç§åŠ é”æ–¹å¼ï¼Œæ¯”è¾ƒçµæ´»; å…·æœ‰å¯é‡å…¥ç‰¹æ€§\n      if(lock.tryLock(100, TimeUnit.MILLISECONDS)){ }\n    } finally {\n      // 4.æ‰‹åŠ¨é‡Šæ”¾é”\n      lock.unlock()\n    }\n  } finally {\n    lock.unlock();\n  }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213353-eozg6o3","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213353-eozg6o3","updated":"20240201213353"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"1.2 ReentrantLock ä¸ AQS çš„å…³è”"}]},{"ID":"20240201213354-41a4je5","Type":"NodeParagraph","Properties":{"id":"20240201213354-41a4je5","updated":"20240201213354"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡ä¸Šæ–‡æˆ‘ä»¬å·²ç»äº†è§£ï¼ŒReentrantLock æ”¯æŒå…¬å¹³é”å’Œéå…¬å¹³é”ï¼ˆå…³äºå…¬å¹³é”å’Œéå…¬å¹³é”çš„åŸç†åˆ†æï¼Œå¯å‚è€ƒã€Š"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://mp.weixin.qq.com/s?__biz=MjM5NjQ5MTI5OA==\u0026mid=2651749434\u0026idx=3\u0026sn=5ffa63ad47fe166f2f1a9f604ed10091\u0026chksm=bd12a5778a652c61509d9e718ab086ff27ad8768586ea9b38c3dcf9e017a8e49bcae3df9bcc8\u0026scene=38#wechat_redirect","TextMarkTextContent":"ä¸å¯ä¸è¯´çš„ Javaâ€œé”â€äº‹"},{"Type":"NodeText","Data":"ã€‹ï¼‰ï¼Œå¹¶ä¸” ReentrantLock çš„åº•å±‚å°±æ˜¯ç”± AQS æ¥å®ç°çš„ã€‚é‚£ä¹ˆ ReentrantLock æ˜¯å¦‚ä½•é€šè¿‡å…¬å¹³é”å’Œéå…¬å¹³é”ä¸ AQS å…³è”èµ·æ¥å‘¢ï¼Ÿ æˆ‘ä»¬ç€é‡ä»è¿™ä¸¤è€…çš„åŠ é”è¿‡ç¨‹æ¥ç†è§£ä¸€ä¸‹å®ƒä»¬ä¸ AQS ä¹‹é—´çš„å…³ç³»ï¼ˆåŠ é”è¿‡ç¨‹ä¸­ä¸ AQS çš„å…³è”æ¯”è¾ƒæ˜æ˜¾ï¼Œè§£é”æµç¨‹åç»­ä¼šä»‹ç»ï¼‰ã€‚"}]},{"ID":"20240201213355-5pry48u","Type":"NodeParagraph","Properties":{"id":"20240201213355-5pry48u","updated":"20240201213355"},"Children":[{"Type":"NodeText","Data":"éå…¬å¹³é”æºç ä¸­çš„åŠ é”æµç¨‹å¦‚ä¸‹ï¼š"}]},{"ID":"20240201213356-yo2u03k","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213356-yo2u03k","updated":"20240201213356"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.ReentrantLock#NonfairSync\n\n// éå…¬å¹³é”\nstatic final class NonfairSync extends Sync {\n  ...\n  final void lock() {\n    if (compareAndSetState(0, 1))\n      setExclusiveOwnerThread(Thread.currentThread());\n    else\n      acquire(1);\n    }\n  ...\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213357-4x49y7x","Type":"NodeParagraph","Properties":{"id":"20240201213357-4x49y7x","updated":"20240201213357"},"Children":[{"Type":"NodeText","Data":"è¿™å—ä»£ç çš„å«ä¹‰ä¸ºï¼š"}]},{"ID":"20240201213358-5mnuaam","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213358-5mnuaam","updated":"20240201213358"},"Children":[{"ID":"20240201213359-x5wcgou","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213359-x5wcgou","updated":"20240201213359"},"Children":[{"ID":"20240201213360-81au9jv","Type":"NodeParagraph","Properties":{"id":"20240201213360-81au9jv","updated":"20240201213360"},"Children":[{"Type":"NodeText","Data":"è‹¥é€šè¿‡ CAS è®¾ç½®å˜é‡ Stateï¼ˆåŒæ­¥çŠ¶æ€ï¼‰æˆåŠŸï¼Œä¹Ÿå°±æ˜¯è·å–é”æˆåŠŸï¼Œåˆ™å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºç‹¬å çº¿ç¨‹ã€‚"}]}]},{"ID":"20240201213361-gzqwojg","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213361-gzqwojg","updated":"20240201213361"},"Children":[{"ID":"20240201213362-q9gp0tx","Type":"NodeParagraph","Properties":{"id":"20240201213362-q9gp0tx","updated":"20240201213362"},"Children":[{"Type":"NodeText","Data":"è‹¥é€šè¿‡ CAS è®¾ç½®å˜é‡ Stateï¼ˆåŒæ­¥çŠ¶æ€ï¼‰å¤±è´¥ï¼Œä¹Ÿå°±æ˜¯è·å–é”å¤±è´¥ï¼Œåˆ™è¿›å…¥ Acquire æ–¹æ³•è¿›è¡Œåç»­å¤„ç†ã€‚"}]}]}]},{"ID":"20240201213363-ez3t45v","Type":"NodeParagraph","Properties":{"id":"20240201213363-ez3t45v","updated":"20240201213363"},"Children":[{"Type":"NodeText","Data":"ç¬¬ä¸€æ­¥å¾ˆå¥½ç†è§£ï¼Œä½†ç¬¬äºŒæ­¥è·å–é”å¤±è´¥åï¼Œåç»­çš„å¤„ç†ç­–ç•¥æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿè¿™å—å¯èƒ½ä¼šæœ‰ä»¥ä¸‹æ€è€ƒï¼š"}]},{"ID":"20240201213364-1rh2ylp","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213364-1rh2ylp","updated":"20240201213364"},"Children":[{"ID":"20240201213365-40yees7","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213365-40yees7","updated":"20240201213365"},"Children":[{"ID":"20240201213366-7dix13w","Type":"NodeParagraph","Properties":{"id":"20240201213366-7dix13w","updated":"20240201213366"},"Children":[{"Type":"NodeText","Data":"æŸä¸ªçº¿ç¨‹è·å–é”å¤±è´¥çš„åç»­æµç¨‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæœ‰ä»¥ä¸‹ä¸¤ç§å¯èƒ½ï¼š"}]}]}]},{"ID":"20240201213367-3p7rscv","Type":"NodeParagraph","Properties":{"id":"20240201213367-3p7rscv","updated":"20240201213367"},"Children":[{"Type":"NodeText","Data":"(1) å°†å½“å‰çº¿ç¨‹è·é”ç»“æœè®¾ç½®ä¸ºå¤±è´¥ï¼Œè·å–é”æµç¨‹ç»“æŸã€‚è¿™ç§è®¾è®¡ä¼šæå¤§é™ä½ç³»ç»Ÿçš„å¹¶å‘åº¦ï¼Œå¹¶ä¸æ»¡è¶³æˆ‘ä»¬å®é™…çš„éœ€æ±‚ã€‚æ‰€ä»¥å°±éœ€è¦ä¸‹é¢è¿™ç§æµç¨‹ï¼Œä¹Ÿå°±æ˜¯ AQS æ¡†æ¶çš„å¤„ç†æµç¨‹ã€‚"}]},{"ID":"20240201213368-2zy6cq4","Type":"NodeParagraph","Properties":{"id":"20240201213368-2zy6cq4","updated":"20240201213368"},"Children":[{"Type":"NodeText","Data":"(2) å­˜åœ¨æŸç§æ’é˜Ÿç­‰å€™æœºåˆ¶ï¼Œçº¿ç¨‹ç»§ç»­ç­‰å¾…ï¼Œä»ç„¶ä¿ç•™è·å–é”çš„å¯èƒ½ï¼Œè·å–é”æµç¨‹ä»åœ¨ç»§ç»­ã€‚"}]},{"ID":"20240201213369-jjxrgb0","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213369-jjxrgb0","updated":"20240201213369"},"Children":[{"ID":"20240201213370-m5m9ip9","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213370-m5m9ip9","updated":"20240201213370"},"Children":[{"ID":"20240201213371-zvp7xaw","Type":"NodeParagraph","Properties":{"id":"20240201213371-zvp7xaw","updated":"20240201213371"},"Children":[{"Type":"NodeText","Data":"å¯¹äºé—®é¢˜ 1 çš„ç¬¬äºŒç§æƒ…å†µï¼Œæ—¢ç„¶è¯´åˆ°äº†æ’é˜Ÿç­‰å€™æœºåˆ¶ï¼Œé‚£ä¹ˆå°±ä¸€å®šä¼šæœ‰æŸç§é˜Ÿåˆ—å½¢æˆï¼Œè¿™æ ·çš„é˜Ÿåˆ—æ˜¯ä»€ä¹ˆæ•°æ®ç»“æ„å‘¢ï¼Ÿ"}]}]},{"ID":"20240201213372-n360kzm","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213372-n360kzm","updated":"20240201213372"},"Children":[{"ID":"20240201213373-hyk84c1","Type":"NodeParagraph","Properties":{"id":"20240201213373-hyk84c1","updated":"20240201213373"},"Children":[{"Type":"NodeText","Data":"å¤„äºæ’é˜Ÿç­‰å€™æœºåˆ¶ä¸­çš„çº¿ç¨‹ï¼Œä»€ä¹ˆæ—¶å€™å¯ä»¥æœ‰æœºä¼šè·å–é”å‘¢ï¼Ÿ"}]}]},{"ID":"20240201213374-pdmpu26","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213374-pdmpu26","updated":"20240201213374"},"Children":[{"ID":"20240201213375-ekaley1","Type":"NodeParagraph","Properties":{"id":"20240201213375-ekaley1","updated":"20240201213375"},"Children":[{"Type":"NodeText","Data":"å¦‚æœå¤„äºæ’é˜Ÿç­‰å€™æœºåˆ¶ä¸­çš„çº¿ç¨‹ä¸€ç›´æ— æ³•è·å–é”ï¼Œè¿˜æ˜¯éœ€è¦ä¸€ç›´ç­‰å¾…å—ï¼Œè¿˜æ˜¯æœ‰åˆ«çš„ç­–ç•¥æ¥è§£å†³è¿™ä¸€é—®é¢˜ï¼Ÿ"}]}]}]},{"ID":"20240201213376-y1lou5z","Type":"NodeParagraph","Properties":{"id":"20240201213376-y1lou5z","updated":"20240201213376"},"Children":[{"Type":"NodeText","Data":"å¸¦ç€éå…¬å¹³é”çš„è¿™äº›é—®é¢˜ï¼Œå†çœ‹ä¸‹å…¬å¹³é”æºç ä¸­è·é”çš„æ–¹å¼ï¼š"}]},{"ID":"20240201213377-vg7lujy","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213377-vg7lujy","updated":"20240201213377"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.ReentrantLock#FairSync\n\nstatic final class FairSync extends Sync {\n  ...\n  final void lock() {\n    acquire(1);\n  }\n  ...\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213378-92dbi4r","Type":"NodeParagraph","Properties":{"id":"20240201213378-92dbi4r","updated":"20240201213378"},"Children":[{"Type":"NodeText","Data":"çœ‹åˆ°è¿™å—ä»£ç ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå­˜åœ¨è¿™ç§ç–‘é—®ï¼šLock å‡½æ•°é€šè¿‡ Acquire æ–¹æ³•è¿›è¡ŒåŠ é”ï¼Œä½†æ˜¯å…·ä½“æ˜¯å¦‚ä½•åŠ é”çš„å‘¢ï¼Ÿ"}]},{"ID":"20240201213379-ne60uav","Type":"NodeParagraph","Properties":{"id":"20240201213379-ne60uav","updated":"20240201213379"},"Children":[{"Type":"NodeText","Data":"ç»“åˆå…¬å¹³é”å’Œéå…¬å¹³é”çš„åŠ é”æµç¨‹ï¼Œè™½ç„¶æµç¨‹ä¸Šæœ‰ä¸€å®šçš„ä¸åŒï¼Œä½†æ˜¯éƒ½è°ƒç”¨äº† Acquire æ–¹æ³•ï¼Œè€Œ Acquire æ–¹æ³•æ˜¯ FairSync å’Œ UnfairSync çš„çˆ¶ç±» AQS ä¸­çš„æ ¸å¿ƒæ–¹æ³•ã€‚"}]},{"ID":"20240201213380-7nxbqd8","Type":"NodeParagraph","Properties":{"id":"20240201213380-7nxbqd8","updated":"20240201213380"},"Children":[{"Type":"NodeText","Data":"å¯¹äºä¸Šè¾¹æåˆ°çš„é—®é¢˜ï¼Œå…¶å®åœ¨ ReentrantLock ç±»æºç ä¸­éƒ½æ— æ³•è§£ç­”ï¼Œè€Œè¿™äº›é—®é¢˜çš„ç­”æ¡ˆï¼Œéƒ½æ˜¯ä½äº Acquire æ–¹æ³•æ‰€åœ¨çš„ç±» AbstractQueuedSynchronizer ä¸­ï¼Œä¹Ÿå°±æ˜¯æœ¬æ–‡çš„æ ¸å¿ƒâ€”â€”AQSã€‚ä¸‹é¢æˆ‘ä»¬ä¼šå¯¹ AQS ä»¥åŠ ReentrantLock å’Œ AQS çš„å…³è”åšè¯¦ç»†ä»‹ç»ï¼ˆç›¸å…³é—®é¢˜ç­”æ¡ˆä¼šåœ¨ 2.3.5 å°èŠ‚ä¸­è§£ç­”ï¼‰ã€‚"}]},{"ID":"20240201213381-rwtibyt","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213381-rwtibyt","updated":"20240201213381"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"2 AQS"}]},{"ID":"20240201213382-el058c1","Type":"NodeParagraph","Properties":{"id":"20240201213382-el058c1","updated":"20240201213382"},"Children":[{"Type":"NodeText","Data":"é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„æ¶æ„å›¾æ¥æ•´ä½“äº†è§£ä¸€ä¸‹ AQS æ¡†æ¶ï¼š"}]},{"ID":"20240201213383-pk2rjce","Type":"NodeParagraph","Properties":{"id":"20240201213383-pk2rjce","updated":"20240201213383"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p1.meituan.net/travelcube/82077ccf14127a87b77cefd1ccf562d3253591.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213384-fw8iho1","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213384-fw8iho1","updated":"20240201213384"},"Children":[{"ID":"20240201213385-lpbhqcf","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213385-lpbhqcf","updated":"20240201213385"},"Children":[{"ID":"20240201213386-oazxzlz","Type":"NodeParagraph","Properties":{"id":"20240201213386-oazxzlz","updated":"20240201213386"},"Children":[{"Type":"NodeText","Data":"ä¸Šå›¾ä¸­æœ‰é¢œè‰²çš„ä¸º Methodï¼Œæ— é¢œè‰²çš„ä¸º Attributionã€‚"}]}]},{"ID":"20240201213387-g39xbkt","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213387-g39xbkt","updated":"20240201213387"},"Children":[{"ID":"20240201213388-snirrue","Type":"NodeParagraph","Properties":{"id":"20240201213388-snirrue","updated":"20240201213388"},"Children":[{"Type":"NodeText","Data":"æ€»çš„æ¥è¯´ï¼ŒAQS æ¡†æ¶å…±åˆ†ä¸ºäº”å±‚ï¼Œè‡ªä¸Šè€Œä¸‹ç”±æµ…å…¥æ·±ï¼Œä» AQS å¯¹å¤–æš´éœ²çš„ API åˆ°åº•å±‚åŸºç¡€æ•°æ®ã€‚"}]}]},{"ID":"20240201213389-29ggoq7","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213389-29ggoq7","updated":"20240201213389"},"Children":[{"ID":"20240201213390-j42jxk4","Type":"NodeParagraph","Properties":{"id":"20240201213390-j42jxk4","updated":"20240201213390"},"Children":[{"Type":"NodeText","Data":"å½“æœ‰è‡ªå®šä¹‰åŒæ­¥å™¨æ¥å…¥æ—¶ï¼Œåªéœ€é‡å†™ç¬¬ä¸€å±‚æ‰€éœ€è¦çš„éƒ¨åˆ†æ–¹æ³•å³å¯ï¼Œä¸éœ€è¦å…³æ³¨åº•å±‚å…·ä½“çš„å®ç°æµç¨‹ã€‚å½“è‡ªå®šä¹‰åŒæ­¥å™¨è¿›è¡ŒåŠ é”æˆ–è€…è§£é”æ“ä½œæ—¶ï¼Œå…ˆç»è¿‡ç¬¬ä¸€å±‚çš„ API è¿›å…¥ AQS å†…éƒ¨æ–¹æ³•ï¼Œç„¶åç»è¿‡ç¬¬äºŒå±‚è¿›è¡Œé”çš„è·å–ï¼Œæ¥ç€å¯¹äºè·å–é”å¤±è´¥çš„æµç¨‹ï¼Œè¿›å…¥ç¬¬ä¸‰å±‚å’Œç¬¬å››å±‚çš„ç­‰å¾…é˜Ÿåˆ—å¤„ç†ï¼Œè€Œè¿™äº›å¤„ç†æ–¹å¼å‡ä¾èµ–äºç¬¬äº”å±‚çš„åŸºç¡€æ•°æ®æä¾›å±‚ã€‚"}]}]}]},{"ID":"20240201213391-spmm2jt","Type":"NodeParagraph","Properties":{"id":"20240201213391-spmm2jt","updated":"20240201213391"},"Children":[{"Type":"NodeText","Data":"ä¸‹é¢æˆ‘ä»¬ä¼šä»æ•´ä½“åˆ°ç»†èŠ‚ï¼Œä»æµç¨‹åˆ°æ–¹æ³•é€ä¸€å‰–æ AQS æ¡†æ¶ï¼Œä¸»è¦åˆ†æè¿‡ç¨‹å¦‚ä¸‹ï¼š"}]},{"ID":"20240201213392-i42tvnp","Type":"NodeParagraph","Properties":{"id":"20240201213392-i42tvnp","updated":"20240201213392"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p1.meituan.net/travelcube/d2f7f7fffdc30d85d17b44266c3ab05323338.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213393-fjkfh3c","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213393-fjkfh3c","updated":"20240201213393"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2.1 åŸç†æ¦‚è§ˆ"}]},{"ID":"20240201213394-y1jr3vd","Type":"NodeParagraph","Properties":{"id":"20240201213394-y1jr3vd","updated":"20240201213394"},"Children":[{"Type":"NodeText","Data":"AQS æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œé‚£ä¹ˆå°±å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ï¼›å¦‚æœå…±äº«èµ„æºè¢«å ç”¨ï¼Œå°±éœ€è¦ä¸€å®šçš„é˜»å¡ç­‰å¾…å”¤é†’æœºåˆ¶æ¥ä¿è¯é”åˆ†é…ã€‚è¿™ä¸ªæœºåˆ¶ä¸»è¦ç”¨çš„æ˜¯ CLH é˜Ÿåˆ—çš„å˜ä½“å®ç°çš„ï¼Œå°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚"}]},{"ID":"20240201213395-legf6pb","Type":"NodeParagraph","Properties":{"id":"20240201213395-legf6pb","updated":"20240201213395"},"Children":[{"Type":"NodeText","Data":"CLHï¼šCraigã€Landin and Hagersten é˜Ÿåˆ—ï¼Œæ˜¯å•å‘é“¾è¡¨ï¼ŒAQS ä¸­çš„é˜Ÿåˆ—æ˜¯ CLH å˜ä½“çš„è™šæ‹ŸåŒå‘é˜Ÿåˆ—ï¼ˆFIFOï¼‰ï¼ŒAQS æ˜¯é€šè¿‡å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ªèŠ‚ç‚¹æ¥å®ç°é”çš„åˆ†é…ã€‚"}]},{"ID":"20240201213396-itbcy9j","Type":"NodeParagraph","Properties":{"id":"20240201213396-itbcy9j","updated":"20240201213396"},"Children":[{"Type":"NodeText","Data":"ä¸»è¦åŸç†å›¾å¦‚ä¸‹ï¼š"}]},{"ID":"20240201213397-zy6yk1h","Type":"NodeParagraph","Properties":{"id":"20240201213397-zy6yk1h","updated":"20240201213397"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/7132e4cef44c26f62835b197b239147b18062.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213398-o4w095v","Type":"NodeParagraph","Properties":{"id":"20240201213398-o4w095v","updated":"20240201213398"},"Children":[{"Type":"NodeText","Data":"AQS ä½¿ç”¨ä¸€ä¸ª Volatile çš„ int ç±»å‹çš„æˆå‘˜å˜é‡æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„ FIFO é˜Ÿåˆ—æ¥å®Œæˆèµ„æºè·å–çš„æ’é˜Ÿå·¥ä½œï¼Œé€šè¿‡ CAS å®Œæˆå¯¹ State å€¼çš„ä¿®æ”¹ã€‚"}]},{"ID":"20240201213399-ambt07e","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213399-ambt07e","updated":"20240201213399"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2.1.1 AQS æ•°æ®ç»“æ„"}]},{"ID":"20240201213400-6kmdr13","Type":"NodeParagraph","Properties":{"id":"20240201213400-6kmdr13","updated":"20240201213400"},"Children":[{"Type":"NodeText","Data":"å…ˆæ¥çœ‹ä¸‹ AQS ä¸­æœ€åŸºæœ¬çš„æ•°æ®ç»“æ„â€”â€”Nodeï¼ŒNode å³ä¸ºä¸Šé¢ CLH å˜ä½“é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ã€‚"}]},{"ID":"20240201213401-wf92dro","Type":"NodeParagraph","Properties":{"id":"20240201213401-wf92dro","updated":"20240201213401"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p1.meituan.net/travelcube/960271cf2b5c8a185eed23e98b72c75538637.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213402-lyttmuv","Type":"NodeParagraph","Properties":{"id":"20240201213402-lyttmuv","updated":"20240201213402"},"Children":[{"Type":"NodeText","Data":"è§£é‡Šä¸€ä¸‹å‡ ä¸ªæ–¹æ³•å’Œå±æ€§å€¼çš„å«ä¹‰ï¼š"}]},{"ID":"20240201213403-ugu1jna","Type":"NodeTable","Data":"| æ–¹æ³•å’Œå±æ€§å€¼ | å«ä¹‰                                                                                             |\n| :----------- | :----------------------------------------------------------------------------------------------- |\n| waitStatus   | å½“å‰èŠ‚ç‚¹åœ¨é˜Ÿåˆ—ä¸­çš„çŠ¶æ€                                                                           |\n| thread       | è¡¨ç¤ºå¤„äºè¯¥èŠ‚ç‚¹çš„çº¿ç¨‹                                                                             |\n| prev         | å‰é©±æŒ‡é’ˆ                                                                                         |\n| predecessor  | è¿”å›å‰é©±èŠ‚ç‚¹ï¼Œæ²¡æœ‰çš„è¯æŠ›å‡º npe                                                                   |\n| nextWaiter   | æŒ‡å‘ä¸‹ä¸€ä¸ªå¤„äº CONDITION çŠ¶æ€çš„èŠ‚ç‚¹ï¼ˆç”±äºæœ¬ç¯‡æ–‡ç« ä¸è®²è¿° Condition Queue é˜Ÿåˆ—ï¼Œè¿™ä¸ªæŒ‡é’ˆä¸å¤šä»‹ç»ï¼‰ |\n| next         | åç»§æŒ‡é’ˆ                                                                                         |","TableAligns":[1,1],"Properties":{"id":"20240201213403-ugu1jna","updated":"20240201213403"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"æ–¹æ³•å’Œå±æ€§å€¼"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"å«ä¹‰"}]}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"waitStatus"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"å½“å‰èŠ‚ç‚¹åœ¨é˜Ÿåˆ—ä¸­çš„çŠ¶æ€"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"thread"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"è¡¨ç¤ºå¤„äºè¯¥èŠ‚ç‚¹çš„çº¿ç¨‹"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"prev"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"å‰é©±æŒ‡é’ˆ"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"predecessor"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"è¿”å›å‰é©±èŠ‚ç‚¹ï¼Œæ²¡æœ‰çš„è¯æŠ›å‡º npe"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"nextWaiter"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"æŒ‡å‘ä¸‹ä¸€ä¸ªå¤„äº CONDITION çŠ¶æ€çš„èŠ‚ç‚¹ï¼ˆç”±äºæœ¬ç¯‡æ–‡ç« ä¸è®²è¿° Condition Queue é˜Ÿåˆ—ï¼Œè¿™ä¸ªæŒ‡é’ˆä¸å¤šä»‹ç»ï¼‰"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"next"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"åç»§æŒ‡é’ˆ"}]}]}]},{"ID":"20240201213404-xhk5qoi","Type":"NodeParagraph","Properties":{"id":"20240201213404-xhk5qoi","updated":"20240201213404"},"Children":[{"Type":"NodeText","Data":"çº¿ç¨‹ä¸¤ç§é”çš„æ¨¡å¼ï¼š"}]},{"ID":"20240201213405-4qdw33h","Type":"NodeTable","Data":"| æ¨¡å¼      | å«ä¹‰                           |\n| :-------- | :----------------------------- |\n| SHARED    | è¡¨ç¤ºçº¿ç¨‹ä»¥å…±äº«çš„æ¨¡å¼ç­‰å¾…é”     |\n| EXCLUSIVE | è¡¨ç¤ºçº¿ç¨‹æ­£åœ¨ä»¥ç‹¬å çš„æ–¹å¼ç­‰å¾…é” |","TableAligns":[1,1],"Properties":{"id":"20240201213405-4qdw33h","updated":"20240201213405"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"æ¨¡å¼"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"å«ä¹‰"}]}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"SHARED"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"è¡¨ç¤ºçº¿ç¨‹ä»¥å…±äº«çš„æ¨¡å¼ç­‰å¾…é”"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"EXCLUSIVE"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"è¡¨ç¤ºçº¿ç¨‹æ­£åœ¨ä»¥ç‹¬å çš„æ–¹å¼ç­‰å¾…é”"}]}]}]},{"ID":"20240201213406-zfdmhl6","Type":"NodeParagraph","Properties":{"id":"20240201213406-zfdmhl6","updated":"20240201213406"},"Children":[{"Type":"NodeText","Data":"waitStatus æœ‰ä¸‹é¢å‡ ä¸ªæšä¸¾å€¼ï¼š"}]},{"ID":"20240201213407-qoa0qt2","Type":"NodeTable","Data":"| æšä¸¾      | å«ä¹‰                                             |\n| :-------- | :----------------------------------------------- |\n| 0         | å½“ä¸€ä¸ª Node è¢«åˆå§‹åŒ–çš„æ—¶å€™çš„é»˜è®¤å€¼               |\n| CANCELLED | ä¸º 1ï¼Œè¡¨ç¤ºçº¿ç¨‹è·å–é”çš„è¯·æ±‚å·²ç»å–æ¶ˆäº†             |\n| CONDITION | ä¸º-2ï¼Œè¡¨ç¤ºèŠ‚ç‚¹åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼ŒèŠ‚ç‚¹çº¿ç¨‹ç­‰å¾…å”¤é†’     |\n| PROPAGATE | ä¸º-3ï¼Œå½“å‰çº¿ç¨‹å¤„åœ¨ SHARED æƒ…å†µä¸‹ï¼Œè¯¥å­—æ®µæ‰ä¼šä½¿ç”¨ |\n| SIGNAL    | ä¸º-1ï¼Œè¡¨ç¤ºçº¿ç¨‹å·²ç»å‡†å¤‡å¥½äº†ï¼Œå°±ç­‰èµ„æºé‡Šæ”¾äº†       |","TableAligns":[1,1],"Properties":{"id":"20240201213407-qoa0qt2","updated":"20240201213407"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"æšä¸¾"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"å«ä¹‰"}]}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"0"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"å½“ä¸€ä¸ª Node è¢«åˆå§‹åŒ–çš„æ—¶å€™çš„é»˜è®¤å€¼"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"CANCELLED"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä¸º 1ï¼Œè¡¨ç¤ºçº¿ç¨‹è·å–é”çš„è¯·æ±‚å·²ç»å–æ¶ˆäº†"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"CONDITION"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä¸º-2ï¼Œè¡¨ç¤ºèŠ‚ç‚¹åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼ŒèŠ‚ç‚¹çº¿ç¨‹ç­‰å¾…å”¤é†’"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"PROPAGATE"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä¸º-3ï¼Œå½“å‰çº¿ç¨‹å¤„åœ¨ SHARED æƒ…å†µä¸‹ï¼Œè¯¥å­—æ®µæ‰ä¼šä½¿ç”¨"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"SIGNAL"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä¸º-1ï¼Œè¡¨ç¤ºçº¿ç¨‹å·²ç»å‡†å¤‡å¥½äº†ï¼Œå°±ç­‰èµ„æºé‡Šæ”¾äº†"}]}]}]},{"ID":"20240201213408-pbqnrt7","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213408-pbqnrt7","updated":"20240201213408"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2.1.2 åŒæ­¥çŠ¶æ€ State"}]},{"ID":"20240201213409-cno8x2f","Type":"NodeParagraph","Properties":{"id":"20240201213409-cno8x2f","updated":"20240201213409"},"Children":[{"Type":"NodeText","Data":"åœ¨äº†è§£æ•°æ®ç»“æ„åï¼Œæ¥ä¸‹æ¥äº†è§£ä¸€ä¸‹ AQS çš„åŒæ­¥çŠ¶æ€â€”â€”Stateã€‚AQS ä¸­ç»´æŠ¤äº†ä¸€ä¸ªåä¸º state çš„å­—æ®µï¼Œæ„ä¸ºåŒæ­¥çŠ¶æ€ï¼Œæ˜¯ç”± Volatile ä¿®é¥°çš„ï¼Œç”¨äºå±•ç¤ºå½“å‰ä¸´ç•Œèµ„æºçš„è·é”æƒ…å†µã€‚"}]},{"ID":"20240201213410-z03icia","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213410-z03icia","updated":"20240201213410"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate volatile int state;\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213411-jm69ee4","Type":"NodeParagraph","Properties":{"id":"20240201213411-jm69ee4","updated":"20240201213411"},"Children":[{"Type":"NodeText","Data":"ä¸‹é¢æä¾›äº†å‡ ä¸ªè®¿é—®è¿™ä¸ªå­—æ®µçš„æ–¹æ³•ï¼š"}]},{"ID":"20240201213412-5acidu5","Type":"NodeTable","Data":"| æ–¹æ³•å                                                             | æè¿°                    |\n| :----------------------------------------------------------------- | :---------------------- |\n| protected final int getState()                                     | è·å– State çš„å€¼         |\n| protected final void setState(int newState)                        | è®¾ç½® State çš„å€¼         |\n| protected final boolean compareAndSetState(int expect, int update) | ä½¿ç”¨ CAS æ–¹å¼æ›´æ–° State |","TableAligns":[1,1],"Properties":{"id":"20240201213412-5acidu5","updated":"20240201213412"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"æ–¹æ³•å"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"æè¿°"}]}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"protected final int getState()"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"è·å– State çš„å€¼"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"protected final void setState(int newState)"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"è®¾ç½® State çš„å€¼"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"protected final boolean compareAndSetState(int expect, int update)"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä½¿ç”¨ CAS æ–¹å¼æ›´æ–° State"}]}]}]},{"ID":"20240201213413-rglb6dy","Type":"NodeParagraph","Properties":{"id":"20240201213413-rglb6dy","updated":"20240201213413"},"Children":[{"Type":"NodeText","Data":"è¿™å‡ ä¸ªæ–¹æ³•éƒ½æ˜¯ Final ä¿®é¥°çš„ï¼Œè¯´æ˜å­ç±»ä¸­æ— æ³•é‡å†™å®ƒä»¬ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ State å­—æ®µè¡¨ç¤ºçš„åŒæ­¥çŠ¶æ€æ¥å®ç°å¤šçº¿ç¨‹çš„ç‹¬å æ¨¡å¼å’Œå…±äº«æ¨¡å¼ï¼ˆåŠ é”è¿‡ç¨‹ï¼‰ã€‚"}]},{"ID":"20240201213414-uzu5ppw","Type":"NodeParagraph","Properties":{"id":"20240201213414-uzu5ppw","updated":"20240201213414"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/27605d483e8935da683a93be015713f331378.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213415-0ajk4jz","Type":"NodeParagraph","Properties":{"id":"20240201213415-0ajk4jz","updated":"20240201213415"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/3f1e1a44f5b7d77000ba4f9476189b2e32806.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213416-tt0vv3e","Type":"NodeParagraph","Properties":{"id":"20240201213416-tt0vv3e","updated":"20240201213416"},"Children":[{"Type":"NodeText","Data":"å¯¹äºæˆ‘ä»¬è‡ªå®šä¹‰çš„åŒæ­¥å·¥å…·ï¼Œéœ€è¦è‡ªå®šä¹‰è·å–åŒæ­¥çŠ¶æ€å’Œé‡Šæ”¾çŠ¶æ€çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ AQS æ¶æ„å›¾ä¸­çš„ç¬¬ä¸€å±‚ï¼šAPI å±‚ã€‚"}]},{"ID":"20240201213417-jvmex4w","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213417-jvmex4w","updated":"20240201213417"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2.2 AQS é‡è¦æ–¹æ³•ä¸ ReentrantLock çš„å…³è”"}]},{"ID":"20240201213418-4z51ste","Type":"NodeParagraph","Properties":{"id":"20240201213418-4z51ste","updated":"20240201213418"},"Children":[{"Type":"NodeText","Data":"ä»æ¶æ„å›¾ä¸­å¯ä»¥å¾—çŸ¥ï¼ŒAQS æä¾›äº†å¤§é‡ç”¨äºè‡ªå®šä¹‰åŒæ­¥å™¨å®ç°çš„ Protected æ–¹æ³•ã€‚è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°çš„ç›¸å…³æ–¹æ³•ä¹Ÿåªæ˜¯ä¸ºäº†é€šè¿‡ä¿®æ”¹ State å­—æ®µæ¥å®ç°å¤šçº¿ç¨‹çš„ç‹¬å æ¨¡å¼æˆ–è€…å…±äº«æ¨¡å¼ã€‚è‡ªå®šä¹‰åŒæ­¥å™¨éœ€è¦å®ç°ä»¥ä¸‹æ–¹æ³•ï¼ˆReentrantLock éœ€è¦å®ç°çš„æ–¹æ³•å¦‚ä¸‹ï¼Œå¹¶ä¸æ˜¯å…¨éƒ¨ï¼‰ï¼š"}]},{"ID":"20240201213419-663pad9","Type":"NodeTable","Data":"| æ–¹æ³•å                                      | æè¿°                                                                                                                   |\n| :------------------------------------------ | :--------------------------------------------------------------------------------------------------------------------- |\n| protected boolean isHeldExclusively()       | è¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ° Condition æ‰éœ€è¦å»å®ç°å®ƒã€‚                                                            |\n| protected boolean tryAcquire(int arg)       | ç‹¬å æ–¹å¼ã€‚arg ä¸ºè·å–é”çš„æ¬¡æ•°ï¼Œå°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å› Trueï¼Œå¤±è´¥åˆ™è¿”å› Falseã€‚                                        |\n| protected boolean tryRelease(int arg)       | ç‹¬å æ–¹å¼ã€‚arg ä¸ºé‡Šæ”¾é”çš„æ¬¡æ•°ï¼Œå°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å› Trueï¼Œå¤±è´¥åˆ™è¿”å› Falseã€‚                                        |\n| protected int tryAcquireShared(int arg)     | å…±äº«æ–¹å¼ã€‚arg ä¸ºè·å–é”çš„æ¬¡æ•°ï¼Œå°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0 è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚ |\n| protected boolean tryReleaseShared(int arg) | å…±äº«æ–¹å¼ã€‚arg ä¸ºé‡Šæ”¾é”çš„æ¬¡æ•°ï¼Œå°è¯•é‡Šæ”¾èµ„æºï¼Œå¦‚æœé‡Šæ”¾åå…è®¸å”¤é†’åç»­ç­‰å¾…ç»“ç‚¹è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚                  |","TableAligns":[1,1],"Properties":{"id":"20240201213419-663pad9","updated":"20240201213419"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"æ–¹æ³•å"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"æè¿°"}]}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"protected boolean isHeldExclusively()"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"è¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ° Condition æ‰éœ€è¦å»å®ç°å®ƒã€‚"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"protected boolean tryAcquire(int arg)"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ç‹¬å æ–¹å¼ã€‚arg ä¸ºè·å–é”çš„æ¬¡æ•°ï¼Œå°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å› Trueï¼Œå¤±è´¥åˆ™è¿”å› Falseã€‚"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"protected boolean tryRelease(int arg)"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ç‹¬å æ–¹å¼ã€‚arg ä¸ºé‡Šæ”¾é”çš„æ¬¡æ•°ï¼Œå°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å› Trueï¼Œå¤±è´¥åˆ™è¿”å› Falseã€‚"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"protected int tryAcquireShared(int arg)"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"å…±äº«æ–¹å¼ã€‚arg ä¸ºè·å–é”çš„æ¬¡æ•°ï¼Œå°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0 è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"protected boolean tryReleaseShared(int arg)"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"å…±äº«æ–¹å¼ã€‚arg ä¸ºé‡Šæ”¾é”çš„æ¬¡æ•°ï¼Œå°è¯•é‡Šæ”¾èµ„æºï¼Œå¦‚æœé‡Šæ”¾åå…è®¸å”¤é†’åç»­ç­‰å¾…ç»“ç‚¹è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚"}]}]}]},{"ID":"20240201213420-qenulue","Type":"NodeParagraph","Properties":{"id":"20240201213420-qenulue","updated":"20240201213420"},"Children":[{"Type":"NodeText","Data":"ä¸€èˆ¬æ¥è¯´ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨è¦ä¹ˆæ˜¯ç‹¬å æ–¹å¼ï¼Œè¦ä¹ˆæ˜¯å…±äº«æ–¹å¼ï¼Œå®ƒä»¬ä¹Ÿåªéœ€å®ç° tryAcquire-tryReleaseã€tryAcquireShared-tryReleaseShared ä¸­çš„ä¸€ç§å³å¯ã€‚AQS ä¹Ÿæ”¯æŒè‡ªå®šä¹‰åŒæ­¥å™¨åŒæ—¶å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼ï¼Œå¦‚ ReentrantReadWriteLockã€‚ReentrantLock æ˜¯ç‹¬å é”ï¼Œæ‰€ä»¥å®ç°äº† tryAcquire-tryReleaseã€‚"}]},{"ID":"20240201213421-scsujtv","Type":"NodeParagraph","Properties":{"id":"20240201213421-scsujtv","updated":"20240201213421"},"Children":[{"Type":"NodeText","Data":"ä»¥éå…¬å¹³é”ä¸ºä¾‹ï¼Œè¿™é‡Œä¸»è¦é˜è¿°ä¸€ä¸‹éå…¬å¹³é”ä¸ AQS ä¹‹é—´æ–¹æ³•çš„å…³è”ä¹‹å¤„ï¼Œå…·ä½“æ¯ä¸€å¤„æ ¸å¿ƒæ–¹æ³•çš„ä½œç”¨ä¼šåœ¨æ–‡ç« åé¢è¯¦ç»†è¿›è¡Œé˜è¿°ã€‚"}]},{"ID":"20240201213422-7xyzwe0","Type":"NodeParagraph","Properties":{"id":"20240201213422-7xyzwe0","updated":"20240201213422"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p1.meituan.net/travelcube/b8b53a70984668bc68653efe9531573e78636.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213423-xpyhbj6","Type":"NodeBlockquote","Properties":{"id":"20240201213423-xpyhbj6","updated":"20240201213423"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213424-cc2z8t4","Type":"NodeParagraph","Properties":{"id":"20240201213424-cc2z8t4","updated":"20240201213424"},"Children":[{"Type":"NodeText","Data":"ğŸ› ä¿®æ­£ï¼ˆå‚è§ï¼š"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/Snailclimb/JavaGuide/issues/1761","TextMarkTextContent":"issue#1761"},{"Type":"NodeText","Data":"ï¼‰: å›¾ä¸­çš„ä¸€å¤„å°é”™è¯¯ï¼Œ(AQS)CAS ä¿®æ”¹å…±äº«èµ„æº State æˆåŠŸä¹‹ååº”è¯¥æ˜¯è·å–é”æˆåŠŸ(éå…¬å¹³é”)ã€‚"}]},{"ID":"20240201213425-y5p1k8g","Type":"NodeParagraph","Properties":{"id":"20240201213425-y5p1k8g","updated":"20240201213425"},"Children":[{"Type":"NodeText","Data":"å¯¹åº”çš„æºç å¦‚ä¸‹ï¼š"}]},{"ID":"20240201213426-n7l0d6m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213426-n7l0d6m","updated":"20240201213426"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"final boolean nonfairTryAcquire(int acquires) {\n         final Thread current = Thread.currentThread();//è·å–å½“å‰çº¿ç¨‹\n         int c = getState();\n         if (c == 0) {\n             if (compareAndSetState(0, acquires)) {//CASæŠ¢é”\n                 setExclusiveOwnerThread(current);//è®¾ç½®å½“å‰çº¿ç¨‹ä¸ºç‹¬å çº¿ç¨‹\n                 return true;//æŠ¢é”æˆåŠŸ\n             }\n         }\n         else if (current == getExclusiveOwnerThread()) {\n             int nextc = c + acquires;\n             if (nextc \u003c 0) // overflow\n                 throw new Error(\"Maximum lock count exceeded\");\n             setState(nextc);\n             return true;\n         }\n         return false;\n     }\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]},{"ID":"20240201213427-8e342gh","Type":"NodeParagraph","Properties":{"id":"20240201213427-8e342gh","updated":"20240201213427"},"Children":[{"Type":"NodeText","Data":"ä¸ºäº†å¸®åŠ©å¤§å®¶ç†è§£ ReentrantLock å’Œ AQS ä¹‹é—´æ–¹æ³•çš„äº¤äº’è¿‡ç¨‹ï¼Œä»¥éå…¬å¹³é”ä¸ºä¾‹ï¼Œæˆ‘ä»¬å°†åŠ é”å’Œè§£é”çš„äº¤äº’æµç¨‹å•ç‹¬æ‹å‡ºæ¥å¼ºè°ƒä¸€ä¸‹ï¼Œä»¥ä¾¿äºå¯¹åç»­å†…å®¹çš„ç†è§£ã€‚"}]},{"ID":"20240201213428-pbt3z40","Type":"NodeParagraph","Properties":{"id":"20240201213428-pbt3z40","updated":"20240201213428"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p1.meituan.net/travelcube/7aadb272069d871bdee8bf3a218eed8136919.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213429-uc8yoou","Type":"NodeParagraph","Properties":{"id":"20240201213429-uc8yoou","updated":"20240201213429"},"Children":[{"Type":"NodeText","Data":"åŠ é”ï¼š"}]},{"ID":"20240201213430-2ocp3vs","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213430-2ocp3vs","updated":"20240201213430"},"Children":[{"ID":"20240201213431-5vh2pzq","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213431-5vh2pzq","updated":"20240201213431"},"Children":[{"ID":"20240201213432-bqm43wa","Type":"NodeParagraph","Properties":{"id":"20240201213432-bqm43wa","updated":"20240201213432"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡ ReentrantLock çš„åŠ é”æ–¹æ³• Lock è¿›è¡ŒåŠ é”æ“ä½œã€‚"}]}]},{"ID":"20240201213433-kz6nvyk","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213433-kz6nvyk","updated":"20240201213433"},"Children":[{"ID":"20240201213434-8wgmvoo","Type":"NodeParagraph","Properties":{"id":"20240201213434-8wgmvoo","updated":"20240201213434"},"Children":[{"Type":"NodeText","Data":"ä¼šè°ƒç”¨åˆ°å†…éƒ¨ç±» Sync çš„ Lock æ–¹æ³•ï¼Œç”±äº Sync#lock æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œæ ¹æ® ReentrantLock åˆå§‹åŒ–é€‰æ‹©çš„å…¬å¹³é”å’Œéå…¬å¹³é”ï¼Œæ‰§è¡Œç›¸å…³å†…éƒ¨ç±»çš„ Lock æ–¹æ³•ï¼Œæœ¬è´¨ä¸Šéƒ½ä¼šæ‰§è¡Œ AQS çš„ Acquire æ–¹æ³•ã€‚"}]}]},{"ID":"20240201213435-0kolgpd","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213435-0kolgpd","updated":"20240201213435"},"Children":[{"ID":"20240201213436-kj5gxkc","Type":"NodeParagraph","Properties":{"id":"20240201213436-kj5gxkc","updated":"20240201213436"},"Children":[{"Type":"NodeText","Data":"AQS çš„ Acquire æ–¹æ³•ä¼šæ‰§è¡Œ tryAcquire æ–¹æ³•ï¼Œä½†æ˜¯ç”±äº tryAcquire éœ€è¦è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°ï¼Œå› æ­¤æ‰§è¡Œäº† ReentrantLock ä¸­çš„ tryAcquire æ–¹æ³•ï¼Œç”±äº ReentrantLock æ˜¯é€šè¿‡å…¬å¹³é”å’Œéå…¬å¹³é”å†…éƒ¨ç±»å®ç°çš„ tryAcquire æ–¹æ³•ï¼Œå› æ­¤ä¼šæ ¹æ®é”ç±»å‹ä¸åŒï¼Œæ‰§è¡Œä¸åŒçš„ tryAcquireã€‚"}]}]},{"ID":"20240201213437-elehgd8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213437-elehgd8","updated":"20240201213437"},"Children":[{"ID":"20240201213438-opi97m4","Type":"NodeParagraph","Properties":{"id":"20240201213438-opi97m4","updated":"20240201213438"},"Children":[{"Type":"NodeText","Data":"tryAcquire æ˜¯è·å–é”é€»è¾‘ï¼Œè·å–å¤±è´¥åï¼Œä¼šæ‰§è¡Œæ¡†æ¶ AQS çš„åç»­é€»è¾‘ï¼Œè·Ÿ ReentrantLock è‡ªå®šä¹‰åŒæ­¥å™¨æ— å…³ã€‚"}]}]}]},{"ID":"20240201213439-yb503mi","Type":"NodeParagraph","Properties":{"id":"20240201213439-yb503mi","updated":"20240201213439"},"Children":[{"Type":"NodeText","Data":"è§£é”ï¼š"}]},{"ID":"20240201213440-115gmlv","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213440-115gmlv","updated":"20240201213440"},"Children":[{"ID":"20240201213441-m9jdhpa","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213441-m9jdhpa","updated":"20240201213441"},"Children":[{"ID":"20240201213442-c450jro","Type":"NodeParagraph","Properties":{"id":"20240201213442-c450jro","updated":"20240201213442"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡ ReentrantLock çš„è§£é”æ–¹æ³• Unlock è¿›è¡Œè§£é”ã€‚"}]}]},{"ID":"20240201213443-6irz0i6","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213443-6irz0i6","updated":"20240201213443"},"Children":[{"ID":"20240201213444-yp296fa","Type":"NodeParagraph","Properties":{"id":"20240201213444-yp296fa","updated":"20240201213444"},"Children":[{"Type":"NodeText","Data":"Unlock ä¼šè°ƒç”¨å†…éƒ¨ç±» Sync çš„ Release æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç»§æ‰¿äº AQSã€‚"}]}]},{"ID":"20240201213445-s0d3ap1","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213445-s0d3ap1","updated":"20240201213445"},"Children":[{"ID":"20240201213446-c6wea89","Type":"NodeParagraph","Properties":{"id":"20240201213446-c6wea89","updated":"20240201213446"},"Children":[{"Type":"NodeText","Data":"Release ä¸­ä¼šè°ƒç”¨ tryRelease æ–¹æ³•ï¼ŒtryRelease éœ€è¦è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°ï¼ŒtryRelease åªåœ¨ ReentrantLock ä¸­çš„ Sync å®ç°ï¼Œå› æ­¤å¯ä»¥çœ‹å‡ºï¼Œé‡Šæ”¾é”çš„è¿‡ç¨‹ï¼Œå¹¶ä¸åŒºåˆ†æ˜¯å¦ä¸ºå…¬å¹³é”ã€‚"}]}]},{"ID":"20240201213447-6vqxs0x","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213447-6vqxs0x","updated":"20240201213447"},"Children":[{"ID":"20240201213448-t9ih4yu","Type":"NodeParagraph","Properties":{"id":"20240201213448-t9ih4yu","updated":"20240201213448"},"Children":[{"Type":"NodeText","Data":"é‡Šæ”¾æˆåŠŸåï¼Œæ‰€æœ‰å¤„ç†ç”± AQS æ¡†æ¶å®Œæˆï¼Œä¸è‡ªå®šä¹‰åŒæ­¥å™¨æ— å…³ã€‚"}]}]}]},{"ID":"20240201213449-6gthgnz","Type":"NodeParagraph","Properties":{"id":"20240201213449-6gthgnz","updated":"20240201213449"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡ä¸Šé¢çš„æè¿°ï¼Œå¤§æ¦‚å¯ä»¥æ€»ç»“å‡º ReentrantLock åŠ é”è§£é”æ—¶ API å±‚æ ¸å¿ƒæ–¹æ³•çš„æ˜ å°„å…³ç³»ã€‚"}]},{"ID":"20240201213450-dl1kg51","Type":"NodeParagraph","Properties":{"id":"20240201213450-dl1kg51","updated":"20240201213450"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/f30c631c8ebbf820d3e8fcb6eee3c0ef18748.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213451-t2hatov","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213451-t2hatov","updated":"20240201213451"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"3 é€šè¿‡ ReentrantLock ç†è§£ AQS"}]},{"ID":"20240201213452-flq94bi","Type":"NodeParagraph","Properties":{"id":"20240201213452-flq94bi","updated":"20240201213452"},"Children":[{"Type":"NodeText","Data":"ReentrantLock ä¸­å…¬å¹³é”å’Œéå…¬å¹³é”åœ¨åº•å±‚æ˜¯ç›¸åŒçš„ï¼Œè¿™é‡Œä»¥éå…¬å¹³é”ä¸ºä¾‹è¿›è¡Œåˆ†æã€‚"}]},{"ID":"20240201213453-i2myrzr","Type":"NodeParagraph","Properties":{"id":"20240201213453-i2myrzr","updated":"20240201213453"},"Children":[{"Type":"NodeText","Data":"åœ¨éå…¬å¹³é”ä¸­ï¼Œæœ‰ä¸€æ®µè¿™æ ·çš„ä»£ç ï¼š"}]},{"ID":"20240201213454-yr225c4","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213454-yr225c4","updated":"20240201213454"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.ReentrantLock\n\nstatic final class NonfairSync extends Sync {\n  ...\n  final void lock() {\n    if (compareAndSetState(0, 1))\n      setExclusiveOwnerThread(Thread.currentThread());\n    else\n      acquire(1);\n  }\n  ...\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213455-i5js5co","Type":"NodeParagraph","Properties":{"id":"20240201213455-i5js5co","updated":"20240201213455"},"Children":[{"Type":"NodeText","Data":"çœ‹ä¸€ä¸‹è¿™ä¸ª Acquire æ˜¯æ€ä¹ˆå†™çš„ï¼š"}]},{"ID":"20240201213456-6t9f3x7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213456-6t9f3x7","updated":"20240201213456"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\npublic final void acquire(int arg) {\n  if (!tryAcquire(arg) \u0026\u0026 acquireQueued(addWaiter(Node.EXCLUSIVE), arg))\n    selfInterrupt();\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213457-hzuwsyz","Type":"NodeParagraph","Properties":{"id":"20240201213457-hzuwsyz","updated":"20240201213457"},"Children":[{"Type":"NodeText","Data":"å†çœ‹ä¸€ä¸‹ tryAcquire æ–¹æ³•ï¼š"}]},{"ID":"20240201213458-l3r5dq3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213458-l3r5dq3","updated":"20240201213458"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprotected boolean tryAcquire(int arg) {\n  throw new UnsupportedOperationException();\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213459-nkejy2i","Type":"NodeParagraph","Properties":{"id":"20240201213459-nkejy2i","updated":"20240201213459"},"Children":[{"Type":"NodeText","Data":"å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œåªæ˜¯ AQS çš„ç®€å•å®ç°ï¼Œå…·ä½“è·å–é”çš„å®ç°æ–¹æ³•æ˜¯ç”±å„è‡ªçš„å…¬å¹³é”å’Œéå…¬å¹³é”å•ç‹¬å®ç°çš„ï¼ˆä»¥ ReentrantLock ä¸ºä¾‹ï¼‰ã€‚å¦‚æœè¯¥æ–¹æ³•è¿”å›äº† Trueï¼Œåˆ™è¯´æ˜å½“å‰çº¿ç¨‹è·å–é”æˆåŠŸï¼Œå°±ä¸ç”¨å¾€åæ‰§è¡Œäº†ï¼›å¦‚æœè·å–å¤±è´¥ï¼Œå°±éœ€è¦åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚ä¸‹é¢ä¼šè¯¦ç»†è§£é‡Šçº¿ç¨‹æ˜¯ä½•æ—¶ä»¥åŠæ€æ ·è¢«åŠ å…¥è¿›ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ã€‚"}]},{"ID":"20240201213460-3anwa8f","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213460-3anwa8f","updated":"20240201213460"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3.1 çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—"}]},{"ID":"20240201213461-0ti89ib","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213461-0ti89ib","updated":"20240201213461"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3.1.1 åŠ å…¥é˜Ÿåˆ—çš„æ—¶æœº"}]},{"ID":"20240201213462-xgil2od","Type":"NodeParagraph","Properties":{"id":"20240201213462-xgil2od","updated":"20240201213462"},"Children":[{"Type":"NodeText","Data":"å½“æ‰§è¡Œ Acquire(1)æ—¶ï¼Œä¼šé€šè¿‡ tryAcquire è·å–é”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœè·å–é”å¤±è´¥ï¼Œå°±ä¼šè°ƒç”¨ addWaiter åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­å»ã€‚"}]},{"ID":"20240201213463-nqnuxfb","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213463-nqnuxfb","updated":"20240201213463"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3.1.2 å¦‚ä½•åŠ å…¥é˜Ÿåˆ—"}]},{"ID":"20240201213464-ch9qp7p","Type":"NodeParagraph","Properties":{"id":"20240201213464-ch9qp7p","updated":"20240201213464"},"Children":[{"Type":"NodeText","Data":"è·å–é”å¤±è´¥åï¼Œä¼šæ‰§è¡Œ addWaiter(Node.EXCLUSIVE)åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œå…·ä½“å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š"}]},{"ID":"20240201213465-79tvuj7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213465-79tvuj7","updated":"20240201213465"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate Node addWaiter(Node mode) {\n  Node node = new Node(Thread.currentThread(), mode);\n  // Try the fast path of enq; backup to full enq on failure\n  Node pred = tail;\n  if (pred != null) {\n    node.prev = pred;\n    if (compareAndSetTail(pred, node)) {\n      pred.next = node;\n      return node;\n    }\n  }\n  enq(node);\n  return node;\n}\nprivate final boolean compareAndSetTail(Node expect, Node update) {\n  return unsafe.compareAndSwapObject(this, tailOffset, expect, update);\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213466-l5o54ea","Type":"NodeParagraph","Properties":{"id":"20240201213466-l5o54ea","updated":"20240201213466"},"Children":[{"Type":"NodeText","Data":"ä¸»è¦çš„æµç¨‹å¦‚ä¸‹ï¼š"}]},{"ID":"20240201213467-dtqndl2","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213467-dtqndl2","updated":"20240201213467"},"Children":[{"ID":"20240201213468-dlqmn8l","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213468-dlqmn8l","updated":"20240201213468"},"Children":[{"ID":"20240201213469-tzrsar2","Type":"NodeParagraph","Properties":{"id":"20240201213469-tzrsar2","updated":"20240201213469"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡å½“å‰çš„çº¿ç¨‹å’Œé”æ¨¡å¼æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ã€‚"}]}]},{"ID":"20240201213470-et7lu5d","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213470-et7lu5d","updated":"20240201213470"},"Children":[{"ID":"20240201213471-9yaiaop","Type":"NodeParagraph","Properties":{"id":"20240201213471-9yaiaop","updated":"20240201213471"},"Children":[{"Type":"NodeText","Data":"Pred æŒ‡é’ˆæŒ‡å‘å°¾èŠ‚ç‚¹ Tailã€‚"}]}]},{"ID":"20240201213472-m63q0d0","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213472-m63q0d0","updated":"20240201213472"},"Children":[{"ID":"20240201213473-e0lx1ah","Type":"NodeParagraph","Properties":{"id":"20240201213473-e0lx1ah","updated":"20240201213473"},"Children":[{"Type":"NodeText","Data":"å°† New ä¸­ Node çš„ Prev æŒ‡é’ˆæŒ‡å‘ Predã€‚"}]}]},{"ID":"20240201213474-zoqcz87","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213474-zoqcz87","updated":"20240201213474"},"Children":[{"ID":"20240201213475-91m1itr","Type":"NodeParagraph","Properties":{"id":"20240201213475-91m1itr","updated":"20240201213475"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡ compareAndSetTail æ–¹æ³•ï¼Œå®Œæˆå°¾èŠ‚ç‚¹çš„è®¾ç½®ã€‚è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯å¯¹ tailOffset å’Œ Expect è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœ tailOffset çš„ Node å’Œ Expect çš„ Node åœ°å€æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆè®¾ç½® Tail çš„å€¼ä¸º Update çš„å€¼ã€‚"}]}]}]},{"ID":"20240201213476-08sddm2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213476-08sddm2","updated":"20240201213476"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nstatic {\n  try {\n    stateOffset = unsafe.objectFieldOffset(AbstractQueuedSynchronizer.class.getDeclaredField(\"state\"));\n    headOffset = unsafe.objectFieldOffset(AbstractQueuedSynchronizer.class.getDeclaredField(\"head\"));\n    tailOffset = unsafe.objectFieldOffset(AbstractQueuedSynchronizer.class.getDeclaredField(\"tail\"));\n    waitStatusOffset = unsafe.objectFieldOffset(Node.class.getDeclaredField(\"waitStatus\"));\n    nextOffset = unsafe.objectFieldOffset(Node.class.getDeclaredField(\"next\"));\n  } catch (Exception ex) {\n    throw new Error(ex);\n  }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213477-xzmzilk","Type":"NodeParagraph","Properties":{"id":"20240201213477-xzmzilk","updated":"20240201213477"},"Children":[{"Type":"NodeText","Data":"ä» AQS çš„é™æ€ä»£ç å—å¯ä»¥çœ‹å‡ºï¼Œéƒ½æ˜¯è·å–ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ç›¸å¯¹äºè¯¥å¯¹è±¡åœ¨å†…å­˜å½“ä¸­çš„åç§»é‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªåç§»é‡åœ¨å¯¹è±¡å†…å­˜å½“ä¸­æ‰¾åˆ°è¿™ä¸ªå±æ€§ã€‚tailOffset æŒ‡çš„æ˜¯ tail å¯¹åº”çš„åç§»é‡ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ä¼šå°† new å‡ºæ¥çš„ Node ç½®ä¸ºå½“å‰é˜Ÿåˆ—çš„å°¾èŠ‚ç‚¹ã€‚åŒæ—¶ï¼Œç”±äºæ˜¯åŒå‘é“¾è¡¨ï¼Œä¹Ÿéœ€è¦å°†å‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘å°¾èŠ‚ç‚¹ã€‚"}]},{"ID":"20240201213478-rox92vs","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213478-rox92vs","updated":"20240201213478"},"Children":[{"ID":"20240201213479-t07u275","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213479-t07u275","updated":"20240201213479"},"Children":[{"ID":"20240201213480-cv6m0ui","Type":"NodeParagraph","Properties":{"id":"20240201213480-cv6m0ui","updated":"20240201213480"},"Children":[{"Type":"NodeText","Data":"å¦‚æœ Pred æŒ‡é’ˆæ˜¯ Nullï¼ˆè¯´æ˜ç­‰å¾…é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ ï¼‰ï¼Œæˆ–è€…å½“å‰ Pred æŒ‡é’ˆå’Œ Tail æŒ‡å‘çš„ä½ç½®ä¸åŒï¼ˆè¯´æ˜è¢«åˆ«çš„çº¿ç¨‹å·²ç»ä¿®æ”¹ï¼‰ï¼Œå°±éœ€è¦çœ‹ä¸€ä¸‹ Enq çš„æ–¹æ³•ã€‚"}]}]}]},{"ID":"20240201213481-l1e2339","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213481-l1e2339","updated":"20240201213481"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate Node enq(final Node node) {\n  for (;;) {\n    Node t = tail;\n    if (t == null) { // Must initialize\n      if (compareAndSetHead(new Node()))\n        tail = head;\n    } else {\n      node.prev = t;\n      if (compareAndSetTail(t, node)) {\n        t.next = node;\n        return t;\n      }\n    }\n  }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213482-tonu27p","Type":"NodeParagraph","Properties":{"id":"20240201213482-tonu27p","updated":"20240201213482"},"Children":[{"Type":"NodeText","Data":"å¦‚æœæ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œéœ€è¦è¿›è¡Œåˆå§‹åŒ–ä¸€ä¸ªå¤´ç»“ç‚¹å‡ºæ¥ã€‚ä½†è¯·æ³¨æ„ï¼Œåˆå§‹åŒ–çš„å¤´ç»“ç‚¹å¹¶ä¸æ˜¯å½“å‰çº¿ç¨‹èŠ‚ç‚¹ï¼Œè€Œæ˜¯è°ƒç”¨äº†æ— å‚æ„é€ å‡½æ•°çš„èŠ‚ç‚¹ã€‚å¦‚æœç»å†äº†åˆå§‹åŒ–æˆ–è€…å¹¶å‘å¯¼è‡´é˜Ÿåˆ—ä¸­æœ‰å…ƒç´ ï¼Œåˆ™ä¸ä¹‹å‰çš„æ–¹æ³•ç›¸åŒã€‚å…¶å®ï¼ŒaddWaiter å°±æ˜¯ä¸€ä¸ªåœ¨åŒç«¯é“¾è¡¨æ·»åŠ å°¾èŠ‚ç‚¹çš„æ“ä½œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŒç«¯é“¾è¡¨çš„å¤´ç»“ç‚¹æ˜¯ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°çš„å¤´ç»“ç‚¹ã€‚"}]},{"ID":"20240201213483-g8q8f4z","Type":"NodeParagraph","Properties":{"id":"20240201213483-g8q8f4z","updated":"20240201213483"},"Children":[{"Type":"NodeText","Data":"æ€»ç»“ä¸€ä¸‹ï¼Œçº¿ç¨‹è·å–é”çš„æ—¶å€™ï¼Œè¿‡ç¨‹å¤§ä½“å¦‚ä¸‹ï¼š"}]},{"ID":"20240201213484-p4ovyjw","Type":"NodeParagraph","Properties":{"id":"20240201213484-p4ovyjw","updated":"20240201213484"},"Children":[{"Type":"NodeText","Data":"1ã€å½“æ²¡æœ‰çº¿ç¨‹è·å–åˆ°é”æ—¶ï¼Œçº¿ç¨‹ 1 è·å–é”æˆåŠŸã€‚"}]},{"ID":"20240201213485-fxwqc8m","Type":"NodeParagraph","Properties":{"id":"20240201213485-fxwqc8m","updated":"20240201213485"},"Children":[{"Type":"NodeText","Data":"2ã€çº¿ç¨‹ 2 ç”³è¯·é”ï¼Œä½†æ˜¯é”è¢«çº¿ç¨‹ 1 å æœ‰ã€‚"}]},{"ID":"20240201213486-7vguccn","Type":"NodeParagraph","Properties":{"id":"20240201213486-7vguccn","updated":"20240201213486"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"img","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/e9e385c3c68f62c67c8d62ab0adb613921117.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213487-lc0pxlf","Type":"NodeParagraph","Properties":{"id":"20240201213487-lc0pxlf","updated":"20240201213487"},"Children":[{"Type":"NodeText","Data":"3ã€å¦‚æœå†æœ‰çº¿ç¨‹è¦è·å–é”ï¼Œä¾æ¬¡åœ¨é˜Ÿåˆ—ä¸­å¾€åæ’é˜Ÿå³å¯ã€‚"}]},{"ID":"20240201213488-6odyae4","Type":"NodeParagraph","Properties":{"id":"20240201213488-6odyae4","updated":"20240201213488"},"Children":[{"Type":"NodeText","Data":"å›åˆ°ä¸Šè¾¹çš„ä»£ç ï¼ŒhasQueuedPredecessors æ˜¯å…¬å¹³é”åŠ é”æ—¶åˆ¤æ–­ç­‰å¾…é˜Ÿåˆ—ä¸­æ˜¯å¦å­˜åœ¨æœ‰æ•ˆèŠ‚ç‚¹çš„æ–¹æ³•ã€‚å¦‚æœè¿”å› Falseï¼Œè¯´æ˜å½“å‰çº¿ç¨‹å¯ä»¥äº‰å–å…±äº«èµ„æºï¼›å¦‚æœè¿”å› Trueï¼Œè¯´æ˜é˜Ÿåˆ—ä¸­å­˜åœ¨æœ‰æ•ˆèŠ‚ç‚¹ï¼Œå½“å‰çº¿ç¨‹å¿…é¡»åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚"}]},{"ID":"20240201213489-clu42q8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213489-clu42q8","updated":"20240201213489"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.ReentrantLock\n\npublic final boolean hasQueuedPredecessors() {\n  // The correctness of this depends on head being initialized\n  // before tail and on head.next being accurate if the current\n  // thread is first in queue.\n  Node t = tail; // Read fields in reverse initialization order\n  Node h = head;\n  Node s;\n  return h != t \u0026\u0026 ((s = h.next) == null || s.thread != Thread.currentThread());\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213490-duqnusj","Type":"NodeParagraph","Properties":{"id":"20240201213490-duqnusj","updated":"20240201213490"},"Children":[{"Type":"NodeText","Data":"çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ç†è§£ä¸€ä¸‹ h != t \u0026\u0026 ((s = h.next) == null || s.thread != Thread.currentThread());ä¸ºä»€ä¹ˆè¦åˆ¤æ–­çš„å¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Ÿç¬¬ä¸€ä¸ªèŠ‚ç‚¹å‚¨å­˜çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Ÿ"}]},{"ID":"20240201213491-6w7ntmy","Type":"NodeBlockquote","Properties":{"id":"20240201213491-6w7ntmy","updated":"20240201213491"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213492-m4v7z4c","Type":"NodeParagraph","Properties":{"id":"20240201213492-m4v7z4c","updated":"20240201213492"},"Children":[{"Type":"NodeText","Data":"åŒå‘é“¾è¡¨ä¸­ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸ºè™šèŠ‚ç‚¹ï¼Œå…¶å®å¹¶ä¸å­˜å‚¨ä»»ä½•ä¿¡æ¯ï¼Œåªæ˜¯å ä½ã€‚çœŸæ­£çš„ç¬¬ä¸€ä¸ªæœ‰æ•°æ®çš„èŠ‚ç‚¹ï¼Œæ˜¯åœ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹å¼€å§‹çš„ã€‚å½“ h != t æ—¶ï¼šå¦‚æœ(s = h.next) == nullï¼Œç­‰å¾…é˜Ÿåˆ—æ­£åœ¨æœ‰çº¿ç¨‹è¿›è¡Œåˆå§‹åŒ–ï¼Œä½†åªæ˜¯è¿›è¡Œåˆ°äº† Tail æŒ‡å‘ Headï¼Œæ²¡æœ‰å°† Head æŒ‡å‘ Tailï¼Œæ­¤æ—¶é˜Ÿåˆ—ä¸­æœ‰å…ƒç´ ï¼Œéœ€è¦è¿”å› Trueï¼ˆè¿™å—å…·ä½“è§ä¸‹è¾¹ä»£ç åˆ†æï¼‰ã€‚ å¦‚æœ(s = h.next) != nullï¼Œè¯´æ˜æ­¤æ—¶é˜Ÿåˆ—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæœ‰æ•ˆèŠ‚ç‚¹ã€‚å¦‚æœæ­¤æ—¶ s.thread == Thread.currentThread()ï¼Œè¯´æ˜ç­‰å¾…é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªæœ‰æ•ˆèŠ‚ç‚¹ä¸­çš„çº¿ç¨‹ä¸å½“å‰çº¿ç¨‹ç›¸åŒï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹æ˜¯å¯ä»¥è·å–èµ„æºçš„ï¼›å¦‚æœ s.thread != Thread.currentThread()ï¼Œè¯´æ˜ç­‰å¾…é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªæœ‰æ•ˆèŠ‚ç‚¹çº¿ç¨‹ä¸å½“å‰çº¿ç¨‹ä¸åŒï¼Œå½“å‰çº¿ç¨‹å¿…é¡»åŠ å…¥è¿›ç­‰å¾…é˜Ÿåˆ—ã€‚"}]}]},{"ID":"20240201213493-14pu19y","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213493-14pu19y","updated":"20240201213493"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer#enq\n\nif (t == null) { // Must initialize\n  if (compareAndSetHead(new Node()))\n    tail = head;\n} else {\n  node.prev = t;\n  if (compareAndSetTail(t, node)) {\n    t.next = node;\n    return t;\n  }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213494-iwzsys6","Type":"NodeParagraph","Properties":{"id":"20240201213494-iwzsys6","updated":"20240201213494"},"Children":[{"Type":"NodeText","Data":"èŠ‚ç‚¹å…¥é˜Ÿä¸æ˜¯åŸå­æ“ä½œï¼Œæ‰€ä»¥ä¼šå‡ºç°çŸ­æš‚çš„ head != tailï¼Œæ­¤æ—¶ Tail æŒ‡å‘æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸” Tail æŒ‡å‘ Headã€‚å¦‚æœ Head æ²¡æœ‰æŒ‡å‘ Tailï¼ˆå¯è§ 5ã€6ã€7 è¡Œï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ä¹Ÿéœ€è¦å°†ç›¸å…³çº¿ç¨‹åŠ å…¥é˜Ÿåˆ—ä¸­ã€‚æ‰€ä»¥è¿™å—ä»£ç æ˜¯ä¸ºäº†è§£å†³æç«¯æƒ…å†µä¸‹çš„å¹¶å‘é—®é¢˜ã€‚"}]},{"ID":"20240201213495-m76fhz0","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213495-m76fhz0","updated":"20240201213495"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3.1.3 ç­‰å¾…é˜Ÿåˆ—ä¸­çº¿ç¨‹å‡ºé˜Ÿåˆ—æ—¶æœº"}]},{"ID":"20240201213496-bdxpdop","Type":"NodeParagraph","Properties":{"id":"20240201213496-bdxpdop","updated":"20240201213496"},"Children":[{"Type":"NodeText","Data":"å›åˆ°æœ€åˆçš„æºç ï¼š"}]},{"ID":"20240201213497-vsuedff","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213497-vsuedff","updated":"20240201213497"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\npublic final void acquire(int arg) {\n  if (!tryAcquire(arg) \u0026\u0026 acquireQueued(addWaiter(Node.EXCLUSIVE), arg))\n    selfInterrupt();\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213498-kkio8dj","Type":"NodeParagraph","Properties":{"id":"20240201213498-kkio8dj","updated":"20240201213498"},"Children":[{"Type":"NodeText","Data":"ä¸Šæ–‡è§£é‡Šäº† addWaiter æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å…¶å®å°±æ˜¯æŠŠå¯¹åº”çš„çº¿ç¨‹ä»¥ Node çš„æ•°æ®ç»“æ„å½¢å¼åŠ å…¥åˆ°åŒç«¯é˜Ÿåˆ—é‡Œï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…å«è¯¥çº¿ç¨‹çš„ Nodeã€‚è€Œè¿™ä¸ª Node ä¼šä½œä¸ºå‚æ•°ï¼Œè¿›å…¥åˆ° acquireQueued æ–¹æ³•ä¸­ã€‚acquireQueued æ–¹æ³•å¯ä»¥å¯¹æ’é˜Ÿä¸­çš„çº¿ç¨‹è¿›è¡Œâ€œè·é”â€æ“ä½œã€‚"}]},{"ID":"20240201213499-6j6w5q2","Type":"NodeParagraph","Properties":{"id":"20240201213499-6j6w5q2","updated":"20240201213499"},"Children":[{"Type":"NodeText","Data":"æ€»çš„æ¥è¯´ï¼Œä¸€ä¸ªçº¿ç¨‹è·å–é”å¤±è´¥äº†ï¼Œè¢«æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ï¼ŒacquireQueued ä¼šæŠŠæ”¾å…¥é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ä¸æ–­å»è·å–é”ï¼Œç›´åˆ°è·å–æˆåŠŸæˆ–è€…ä¸å†éœ€è¦è·å–ï¼ˆä¸­æ–­ï¼‰ã€‚"}]},{"ID":"20240201213500-cafbyjh","Type":"NodeParagraph","Properties":{"id":"20240201213500-cafbyjh","updated":"20240201213500"},"Children":[{"Type":"NodeText","Data":"ä¸‹é¢æˆ‘ä»¬ä»â€œä½•æ—¶å‡ºé˜Ÿåˆ—ï¼Ÿâ€å’Œâ€œå¦‚ä½•å‡ºé˜Ÿåˆ—ï¼Ÿâ€ä¸¤ä¸ªæ–¹å‘æ¥åˆ†æä¸€ä¸‹ acquireQueued æºç ï¼š"}]},{"ID":"20240201213501-hcygoed","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213501-hcygoed","updated":"20240201213501"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nfinal boolean acquireQueued(final Node node, int arg) {\n  // æ ‡è®°æ˜¯å¦æˆåŠŸæ‹¿åˆ°èµ„æº\n  boolean failed = true;\n  try {\n    // æ ‡è®°ç­‰å¾…è¿‡ç¨‹ä¸­æ˜¯å¦ä¸­æ–­è¿‡\n    boolean interrupted = false;\n    // å¼€å§‹è‡ªæ—‹ï¼Œè¦ä¹ˆè·å–é”ï¼Œè¦ä¹ˆä¸­æ–­\n    for (;;) {\n      // è·å–å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹\n      final Node p = node.predecessor();\n      // å¦‚æœpæ˜¯å¤´ç»“ç‚¹ï¼Œè¯´æ˜å½“å‰èŠ‚ç‚¹åœ¨çœŸå®æ•°æ®é˜Ÿåˆ—çš„é¦–éƒ¨ï¼Œå°±å°è¯•è·å–é”ï¼ˆåˆ«å¿˜äº†å¤´ç»“ç‚¹æ˜¯è™šèŠ‚ç‚¹ï¼‰\n      if (p == head \u0026\u0026 tryAcquire(arg)) {\n        // è·å–é”æˆåŠŸï¼Œå¤´æŒ‡é’ˆç§»åŠ¨åˆ°å½“å‰node\n        setHead(node);\n        p.next = null; // help GC\n        failed = false;\n        return interrupted;\n      }\n      // è¯´æ˜pä¸ºå¤´èŠ‚ç‚¹ä¸”å½“å‰æ²¡æœ‰è·å–åˆ°é”ï¼ˆå¯èƒ½æ˜¯éå…¬å¹³é”è¢«æŠ¢å äº†ï¼‰æˆ–è€…æ˜¯pä¸ä¸ºå¤´ç»“ç‚¹ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦åˆ¤æ–­å½“å‰nodeæ˜¯å¦è¦è¢«é˜»å¡ï¼ˆè¢«é˜»å¡æ¡ä»¶ï¼šå‰é©±èŠ‚ç‚¹çš„waitStatusä¸º-1ï¼‰ï¼Œé˜²æ­¢æ— é™å¾ªç¯æµªè´¹èµ„æºã€‚å…·ä½“ä¸¤ä¸ªæ–¹æ³•ä¸‹é¢ç»†ç»†åˆ†æ\n      if (shouldParkAfterFailedAcquire(p, node) \u0026\u0026 parkAndCheckInterrupt())\n        interrupted = true;\n    }\n  } finally {\n    if (failed)\n      cancelAcquire(node);\n  }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213502-c1x32yv","Type":"NodeParagraph","Properties":{"id":"20240201213502-c1x32yv","updated":"20240201213502"},"Children":[{"Type":"NodeText","Data":"æ³¨ï¼šsetHead æ–¹æ³•æ˜¯æŠŠå½“å‰èŠ‚ç‚¹ç½®ä¸ºè™šèŠ‚ç‚¹ï¼Œä½†å¹¶æ²¡æœ‰ä¿®æ”¹ waitStatusï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ç›´éœ€è¦ç”¨çš„æ•°æ®ã€‚"}]},{"ID":"20240201213503-ijbjuhb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213503-ijbjuhb","updated":"20240201213503"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate void setHead(Node node) {\n  head = node;\n  node.thread = null;\n  node.prev = null;\n}\n\n// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\n// é å‰é©±èŠ‚ç‚¹åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦åº”è¯¥è¢«é˜»å¡\nprivate static boolean shouldParkAfterFailedAcquire(Node pred, Node node) {\n  // è·å–å¤´ç»“ç‚¹çš„èŠ‚ç‚¹çŠ¶æ€\n  int ws = pred.waitStatus;\n  // è¯´æ˜å¤´ç»“ç‚¹å¤„äºå”¤é†’çŠ¶æ€\n  if (ws == Node.SIGNAL)\n    return true;\n  // é€šè¿‡æšä¸¾å€¼æˆ‘ä»¬çŸ¥é“waitStatus\u003e0æ˜¯å–æ¶ˆçŠ¶æ€\n  if (ws \u003e 0) {\n    do {\n      // å¾ªç¯å‘å‰æŸ¥æ‰¾å–æ¶ˆèŠ‚ç‚¹ï¼ŒæŠŠå–æ¶ˆèŠ‚ç‚¹ä»é˜Ÿåˆ—ä¸­å‰”é™¤\n      node.prev = pred = pred.prev;\n    } while (pred.waitStatus \u003e 0);\n    pred.next = node;\n  } else {\n    // è®¾ç½®å‰ä»»èŠ‚ç‚¹ç­‰å¾…çŠ¶æ€ä¸ºSIGNAL\n    compareAndSetWaitStatus(pred, ws, Node.SIGNAL);\n  }\n  return false;\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213504-0tw6wex","Type":"NodeParagraph","Properties":{"id":"20240201213504-0tw6wex","updated":"20240201213504"},"Children":[{"Type":"NodeText","Data":"parkAndCheckInterrupt ä¸»è¦ç”¨äºæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œé˜»å¡è°ƒç”¨æ ˆï¼Œè¿”å›å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ã€‚"}]},{"ID":"20240201213505-wc748qm","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213505-wc748qm","updated":"20240201213505"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate final boolean parkAndCheckInterrupt() {\n    LockSupport.park(this);\n    return Thread.interrupted();\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213506-m8qqdi7","Type":"NodeParagraph","Properties":{"id":"20240201213506-m8qqdi7","updated":"20240201213506"},"Children":[{"Type":"NodeText","Data":"ä¸Šè¿°æ–¹æ³•çš„æµç¨‹å›¾å¦‚ä¸‹ï¼š"}]},{"ID":"20240201213507-7527rrn","Type":"NodeParagraph","Properties":{"id":"20240201213507-7527rrn","updated":"20240201213507"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/c124b76dcbefb9bdc778458064703d1135485.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213508-rk0cc46","Type":"NodeParagraph","Properties":{"id":"20240201213508-rk0cc46","updated":"20240201213508"},"Children":[{"Type":"NodeText","Data":"ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œè·³å‡ºå½“å‰å¾ªç¯çš„æ¡ä»¶æ˜¯å½“â€œå‰ç½®èŠ‚ç‚¹æ˜¯å¤´ç»“ç‚¹ï¼Œä¸”å½“å‰çº¿ç¨‹è·å–é”æˆåŠŸâ€ã€‚ä¸ºäº†é˜²æ­¢å› æ­»å¾ªç¯å¯¼è‡´ CPU èµ„æºè¢«æµªè´¹ï¼Œæˆ‘ä»¬ä¼šåˆ¤æ–­å‰ç½®èŠ‚ç‚¹çš„çŠ¶æ€æ¥å†³å®šæ˜¯å¦è¦å°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œå…·ä½“æŒ‚èµ·æµç¨‹ç”¨æµç¨‹å›¾è¡¨ç¤ºå¦‚ä¸‹ï¼ˆshouldParkAfterFailedAcquire æµç¨‹ï¼‰ï¼š"}]},{"ID":"20240201213509-2iupl88","Type":"NodeParagraph","Properties":{"id":"20240201213509-2iupl88","updated":"20240201213509"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/9af16e2481ad85f38ca322a225ae737535740.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213510-dlb87q7","Type":"NodeParagraph","Properties":{"id":"20240201213510-dlb87q7","updated":"20240201213510"},"Children":[{"Type":"NodeText","Data":"ä»é˜Ÿåˆ—ä¸­é‡Šæ”¾èŠ‚ç‚¹çš„ç–‘è™‘æ‰“æ¶ˆäº†ï¼Œé‚£ä¹ˆåˆæœ‰æ–°é—®é¢˜äº†ï¼š"}]},{"ID":"20240201213511-eb1qvhw","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213511-eb1qvhw","updated":"20240201213511"},"Children":[{"ID":"20240201213512-tswwo4f","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213512-tswwo4f","updated":"20240201213512"},"Children":[{"ID":"20240201213513-bvt8cnc","Type":"NodeParagraph","Properties":{"id":"20240201213513-bvt8cnc","updated":"20240201213513"},"Children":[{"Type":"NodeText","Data":"shouldParkAfterFailedAcquire ä¸­å–æ¶ˆèŠ‚ç‚¹æ˜¯æ€ä¹ˆç”Ÿæˆçš„å‘¢ï¼Ÿä»€ä¹ˆæ—¶å€™ä¼šæŠŠä¸€ä¸ªèŠ‚ç‚¹çš„ waitStatus è®¾ç½®ä¸º-1ï¼Ÿ"}]}]},{"ID":"20240201213514-3cv858t","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213514-3cv858t","updated":"20240201213514"},"Children":[{"ID":"20240201213515-k1i8k75","Type":"NodeParagraph","Properties":{"id":"20240201213515-k1i8k75","updated":"20240201213515"},"Children":[{"Type":"NodeText","Data":"æ˜¯åœ¨ä»€ä¹ˆæ—¶é—´é‡Šæ”¾èŠ‚ç‚¹é€šçŸ¥åˆ°è¢«æŒ‚èµ·çš„çº¿ç¨‹å‘¢ï¼Ÿ"}]}]}]},{"ID":"20240201213516-c30t2ey","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213516-c30t2ey","updated":"20240201213516"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3.2 CANCELLED çŠ¶æ€èŠ‚ç‚¹ç”Ÿæˆ"}]},{"ID":"20240201213517-9k7ak7e","Type":"NodeParagraph","Properties":{"id":"20240201213517-9k7ak7e","updated":"20240201213517"},"Children":[{"Type":"NodeText","Data":"acquireQueued æ–¹æ³•ä¸­çš„ Finally ä»£ç ï¼š"}]},{"ID":"20240201213518-hsnzz8l","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213518-hsnzz8l","updated":"20240201213518"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nfinal boolean acquireQueued(final Node node, int arg) {\n  boolean failed = true;\n  try {\n    ...\n    for (;;) {\n      final Node p = node.predecessor();\n      if (p == head \u0026\u0026 tryAcquire(arg)) {\n        ...\n        failed = false;\n        ...\n      }\n      ...\n  } finally {\n    if (failed)\n      cancelAcquire(node);\n    }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213519-5p0pg4o","Type":"NodeParagraph","Properties":{"id":"20240201213519-5p0pg4o","updated":"20240201213519"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡ cancelAcquire æ–¹æ³•ï¼Œå°† Node çš„çŠ¶æ€æ ‡è®°ä¸º CANCELLEDã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€è¡Œæ¥åˆ†æè¿™ä¸ªæ–¹æ³•çš„åŸç†ï¼š"}]},{"ID":"20240201213520-yf0rtic","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213520-yf0rtic","updated":"20240201213520"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate void cancelAcquire(Node node) {\n  // å°†æ— æ•ˆèŠ‚ç‚¹è¿‡æ»¤\n  if (node == null)\n    return;\n  // è®¾ç½®è¯¥èŠ‚ç‚¹ä¸å…³è”ä»»ä½•çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è™šèŠ‚ç‚¹\n  node.thread = null;\n  Node pred = node.prev;\n  // é€šè¿‡å‰é©±èŠ‚ç‚¹ï¼Œè·³è¿‡å–æ¶ˆçŠ¶æ€çš„node\n  while (pred.waitStatus \u003e 0)\n    node.prev = pred = pred.prev;\n  // è·å–è¿‡æ»¤åçš„å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹\n  Node predNext = pred.next;\n  // æŠŠå½“å‰nodeçš„çŠ¶æ€è®¾ç½®ä¸ºCANCELLED\n  node.waitStatus = Node.CANCELLED;\n  // å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯å°¾èŠ‚ç‚¹ï¼Œå°†ä»åå¾€å‰çš„ç¬¬ä¸€ä¸ªéå–æ¶ˆçŠ¶æ€çš„èŠ‚ç‚¹è®¾ç½®ä¸ºå°¾èŠ‚ç‚¹\n  // æ›´æ–°å¤±è´¥çš„è¯ï¼Œåˆ™è¿›å…¥elseï¼Œå¦‚æœæ›´æ–°æˆåŠŸï¼Œå°†tailçš„åç»§èŠ‚ç‚¹è®¾ç½®ä¸ºnull\n  if (node == tail \u0026\u0026 compareAndSetTail(node, pred)) {\n    compareAndSetNext(pred, predNext, null);\n  } else {\n    int ws;\n    // å¦‚æœå½“å‰èŠ‚ç‚¹ä¸æ˜¯headçš„åç»§èŠ‚ç‚¹ï¼Œ1:åˆ¤æ–­å½“å‰èŠ‚ç‚¹å‰é©±èŠ‚ç‚¹çš„æ˜¯å¦ä¸ºSIGNALï¼Œ2:å¦‚æœä¸æ˜¯ï¼Œåˆ™æŠŠå‰é©±èŠ‚ç‚¹è®¾ç½®ä¸ºSIGNALçœ‹æ˜¯å¦æˆåŠŸ\n    // å¦‚æœ1å’Œ2ä¸­æœ‰ä¸€ä¸ªä¸ºtrueï¼Œå†åˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„çº¿ç¨‹æ˜¯å¦ä¸ºnull\n    // å¦‚æœä¸Šè¿°æ¡ä»¶éƒ½æ»¡è¶³ï¼ŒæŠŠå½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹çš„åç»§æŒ‡é’ˆæŒ‡å‘å½“å‰èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹\n    if (pred != head \u0026\u0026 ((ws = pred.waitStatus) == Node.SIGNAL || (ws \u003c= 0 \u0026\u0026 compareAndSetWaitStatus(pred, ws, Node.SIGNAL))) \u0026\u0026 pred.thread != null) {\n      Node next = node.next;\n      if (next != null \u0026\u0026 next.waitStatus \u003c= 0)\n        compareAndSetNext(pred, predNext, next);\n    } else {\n      // å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯headçš„åç»§èŠ‚ç‚¹ï¼Œæˆ–è€…ä¸Šè¿°æ¡ä»¶ä¸æ»¡è¶³ï¼Œé‚£å°±å”¤é†’å½“å‰èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹\n      unparkSuccessor(node);\n    }\n    node.next = node; // help GC\n  }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213521-fgp9gxg","Type":"NodeParagraph","Properties":{"id":"20240201213521-fgp9gxg","updated":"20240201213521"},"Children":[{"Type":"NodeText","Data":"å½“å‰çš„æµç¨‹ï¼š"}]},{"ID":"20240201213522-bkw4zv8","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213522-bkw4zv8","updated":"20240201213522"},"Children":[{"ID":"20240201213523-kbs504n","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213523-kbs504n","updated":"20240201213523"},"Children":[{"ID":"20240201213524-jk2tr31","Type":"NodeParagraph","Properties":{"id":"20240201213524-jk2tr31","updated":"20240201213524"},"Children":[{"Type":"NodeText","Data":"è·å–å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼Œå¦‚æœå‰é©±èŠ‚ç‚¹çš„çŠ¶æ€æ˜¯ CANCELLEDï¼Œé‚£å°±ä¸€ç›´å¾€å‰éå†ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª waitStatus \u003c= 0 çš„èŠ‚ç‚¹ï¼Œå°†æ‰¾åˆ°çš„ Pred èŠ‚ç‚¹å’Œå½“å‰ Node å…³è”ï¼Œå°†å½“å‰ Node è®¾ç½®ä¸º CANCELLEDã€‚"}]}]},{"ID":"20240201213525-wuun7hp","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213525-wuun7hp","updated":"20240201213525"},"Children":[{"ID":"20240201213526-hj91lsn","Type":"NodeParagraph","Properties":{"id":"20240201213526-hj91lsn","updated":"20240201213526"},"Children":[{"Type":"NodeText","Data":"æ ¹æ®å½“å‰èŠ‚ç‚¹çš„ä½ç½®ï¼Œè€ƒè™‘ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š"}]}]}]},{"ID":"20240201213527-iv6qw63","Type":"NodeParagraph","Properties":{"id":"20240201213527-iv6qw63","updated":"20240201213527"},"Children":[{"Type":"NodeText","Data":"(1) å½“å‰èŠ‚ç‚¹æ˜¯å°¾èŠ‚ç‚¹ã€‚"}]},{"ID":"20240201213528-l4h0j8i","Type":"NodeParagraph","Properties":{"id":"20240201213528-l4h0j8i","updated":"20240201213528"},"Children":[{"Type":"NodeText","Data":"(2) å½“å‰èŠ‚ç‚¹æ˜¯ Head çš„åç»§èŠ‚ç‚¹ã€‚"}]},{"ID":"20240201213529-p1g5ops","Type":"NodeParagraph","Properties":{"id":"20240201213529-p1g5ops","updated":"20240201213529"},"Children":[{"Type":"NodeText","Data":"(3) å½“å‰èŠ‚ç‚¹ä¸æ˜¯ Head çš„åç»§èŠ‚ç‚¹ï¼Œä¹Ÿä¸æ˜¯å°¾èŠ‚ç‚¹ã€‚"}]},{"ID":"20240201213530-o2ec6re","Type":"NodeParagraph","Properties":{"id":"20240201213530-o2ec6re","updated":"20240201213530"},"Children":[{"Type":"NodeText","Data":"æ ¹æ®ä¸Šè¿°ç¬¬äºŒæ¡ï¼Œæˆ‘ä»¬æ¥åˆ†ææ¯ä¸€ç§æƒ…å†µçš„æµç¨‹ã€‚"}]},{"ID":"20240201213531-u4sdzn2","Type":"NodeParagraph","Properties":{"id":"20240201213531-u4sdzn2","updated":"20240201213531"},"Children":[{"Type":"NodeText","Data":"å½“å‰èŠ‚ç‚¹æ˜¯å°¾èŠ‚ç‚¹ã€‚"}]},{"ID":"20240201213532-kx6a9bb","Type":"NodeParagraph","Properties":{"id":"20240201213532-kx6a9bb","updated":"20240201213532"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p1.meituan.net/travelcube/b845211ced57561c24f79d56194949e822049.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213533-41gqxps","Type":"NodeParagraph","Properties":{"id":"20240201213533-41gqxps","updated":"20240201213533"},"Children":[{"Type":"NodeText","Data":"å½“å‰èŠ‚ç‚¹æ˜¯ Head çš„åç»§èŠ‚ç‚¹ã€‚"}]},{"ID":"20240201213534-ja45ki0","Type":"NodeParagraph","Properties":{"id":"20240201213534-ja45ki0","updated":"20240201213534"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p1.meituan.net/travelcube/ab89bfec875846e5028a4f8fead32b7117975.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213535-kl8ed0b","Type":"NodeParagraph","Properties":{"id":"20240201213535-kl8ed0b","updated":"20240201213535"},"Children":[{"Type":"NodeText","Data":"å½“å‰èŠ‚ç‚¹ä¸æ˜¯ Head çš„åç»§èŠ‚ç‚¹ï¼Œä¹Ÿä¸æ˜¯å°¾èŠ‚ç‚¹ã€‚"}]},{"ID":"20240201213536-ffgrji7","Type":"NodeParagraph","Properties":{"id":"20240201213536-ffgrji7","updated":"20240201213536"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://p0.meituan.net/travelcube/45d0d9e4a6897eddadc4397cf53d6cd522452.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213537-rv5k0xs","Type":"NodeParagraph","Properties":{"id":"20240201213537-rv5k0xs","updated":"20240201213537"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡ä¸Šé¢çš„æµç¨‹ï¼Œæˆ‘ä»¬å¯¹äº CANCELLED èŠ‚ç‚¹çŠ¶æ€çš„äº§ç”Ÿå’Œå˜åŒ–å·²ç»æœ‰äº†å¤§è‡´çš„äº†è§£ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæ‰€æœ‰çš„å˜åŒ–éƒ½æ˜¯å¯¹ Next æŒ‡é’ˆè¿›è¡Œäº†æ“ä½œï¼Œè€Œæ²¡æœ‰å¯¹ Prev æŒ‡é’ˆè¿›è¡Œæ“ä½œå‘¢ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¹ Prev æŒ‡é’ˆè¿›è¡Œæ“ä½œï¼Ÿ"}]},{"ID":"20240201213538-dzqr7bt","Type":"NodeBlockquote","Properties":{"id":"20240201213538-dzqr7bt","updated":"20240201213538"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213539-89qdmrq","Type":"NodeParagraph","Properties":{"id":"20240201213539-89qdmrq","updated":"20240201213539"},"Children":[{"Type":"NodeText","Data":"æ‰§è¡Œ cancelAcquire çš„æ—¶å€™ï¼Œå½“å‰èŠ‚ç‚¹çš„å‰ç½®èŠ‚ç‚¹å¯èƒ½å·²ç»ä»é˜Ÿåˆ—ä¸­å‡ºå»äº†ï¼ˆå·²ç»æ‰§è¡Œè¿‡ Try ä»£ç å—ä¸­çš„ shouldParkAfterFailedAcquire æ–¹æ³•äº†ï¼‰ï¼Œå¦‚æœæ­¤æ—¶ä¿®æ”¹ Prev æŒ‡é’ˆï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´ Prev æŒ‡å‘å¦ä¸€ä¸ªå·²ç»ç§»é™¤é˜Ÿåˆ—çš„ Nodeï¼Œå› æ­¤è¿™å—å˜åŒ– Prev æŒ‡é’ˆä¸å®‰å…¨ã€‚ shouldParkAfterFailedAcquire æ–¹æ³•ä¸­ï¼Œä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå…¶å®å°±æ˜¯åœ¨å¤„ç† Prev æŒ‡é’ˆã€‚shouldParkAfterFailedAcquire æ˜¯è·å–é”å¤±è´¥çš„æƒ…å†µä¸‹æ‰ä¼šæ‰§è¡Œï¼Œè¿›å…¥è¯¥æ–¹æ³•åï¼Œè¯´æ˜å…±äº«èµ„æºå·²è¢«è·å–ï¼Œå½“å‰èŠ‚ç‚¹ä¹‹å‰çš„èŠ‚ç‚¹éƒ½ä¸ä¼šå‡ºç°å˜åŒ–ï¼Œå› æ­¤è¿™ä¸ªæ—¶å€™å˜æ›´ Prev æŒ‡é’ˆæ¯”è¾ƒå®‰å…¨ã€‚"}]},{"ID":"20240201213540-9gw6lib","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213540-9gw6lib","updated":"20240201213540"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"do {\n  node.prev = pred = pred.prev;\n} while (pred.waitStatus \u003e 0);\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]},{"ID":"20240201213541-lt9mxmr","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213541-lt9mxmr","updated":"20240201213541"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3.3 å¦‚ä½•è§£é”"}]},{"ID":"20240201213542-8h72otb","Type":"NodeParagraph","Properties":{"id":"20240201213542-8h72otb","updated":"20240201213542"},"Children":[{"Type":"NodeText","Data":"æˆ‘ä»¬å·²ç»å‰–æäº†åŠ é”è¿‡ç¨‹ä¸­çš„åŸºæœ¬æµç¨‹ï¼Œæ¥ä¸‹æ¥å†å¯¹è§£é”çš„åŸºæœ¬æµç¨‹è¿›è¡Œåˆ†æã€‚ç”±äº ReentrantLock åœ¨è§£é”çš„æ—¶å€™ï¼Œå¹¶ä¸åŒºåˆ†å…¬å¹³é”å’Œéå…¬å¹³é”ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥çœ‹è§£é”çš„æºç ï¼š"}]},{"ID":"20240201213543-zf6tu1m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213543-zf6tu1m","updated":"20240201213543"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.ReentrantLock\n\npublic void unlock() {\n  sync.release(1);\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213544-wz5td2w","Type":"NodeParagraph","Properties":{"id":"20240201213544-wz5td2w","updated":"20240201213544"},"Children":[{"Type":"NodeText","Data":"å¯ä»¥çœ‹åˆ°ï¼Œæœ¬è´¨é‡Šæ”¾é”çš„åœ°æ–¹ï¼Œæ˜¯é€šè¿‡æ¡†æ¶æ¥å®Œæˆçš„ã€‚"}]},{"ID":"20240201213545-44ammvx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213545-44ammvx","updated":"20240201213545"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\npublic final boolean release(int arg) {\n  if (tryRelease(arg)) {\n    Node h = head;\n    if (h != null \u0026\u0026 h.waitStatus != 0)\n      unparkSuccessor(h);\n    return true;\n  }\n  return false;\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213546-bfqfgk4","Type":"NodeParagraph","Properties":{"id":"20240201213546-bfqfgk4","updated":"20240201213546"},"Children":[{"Type":"NodeText","Data":"åœ¨ ReentrantLock é‡Œé¢çš„å…¬å¹³é”å’Œéå…¬å¹³é”çš„çˆ¶ç±» Sync å®šä¹‰äº†å¯é‡å…¥é”çš„é‡Šæ”¾é”æœºåˆ¶ã€‚"}]},{"ID":"20240201213547-460qyv5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213547-460qyv5","updated":"20240201213547"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.ReentrantLock.Sync\n\n// æ–¹æ³•è¿”å›å½“å‰é”æ˜¯ä¸æ˜¯æ²¡æœ‰è¢«çº¿ç¨‹æŒæœ‰\nprotected final boolean tryRelease(int releases) {\n  // å‡å°‘å¯é‡å…¥æ¬¡æ•°\n  int c = getState() - releases;\n  // å½“å‰çº¿ç¨‹ä¸æ˜¯æŒæœ‰é”çš„çº¿ç¨‹ï¼ŒæŠ›å‡ºå¼‚å¸¸\n  if (Thread.currentThread() != getExclusiveOwnerThread())\n    throw new IllegalMonitorStateException();\n  boolean free = false;\n  // å¦‚æœæŒæœ‰çº¿ç¨‹å…¨éƒ¨é‡Šæ”¾ï¼Œå°†å½“å‰ç‹¬å é”æ‰€æœ‰çº¿ç¨‹è®¾ç½®ä¸ºnullï¼Œå¹¶æ›´æ–°state\n  if (c == 0) {\n    free = true;\n    setExclusiveOwnerThread(null);\n  }\n  setState(c);\n  return free;\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213548-ahae2cf","Type":"NodeParagraph","Properties":{"id":"20240201213548-ahae2cf","updated":"20240201213548"},"Children":[{"Type":"NodeText","Data":"æˆ‘ä»¬æ¥è§£é‡Šä¸‹è¿°æºç ï¼š"}]},{"ID":"20240201213549-md32qjo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213549-md32qjo","updated":"20240201213549"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\npublic final boolean release(int arg) {\n  // ä¸Šè¾¹è‡ªå®šä¹‰çš„tryReleaseå¦‚æœè¿”å›trueï¼Œè¯´æ˜è¯¥é”æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰\n  if (tryRelease(arg)) {\n    // è·å–å¤´ç»“ç‚¹\n    Node h = head;\n    // å¤´ç»“ç‚¹ä¸ä¸ºç©ºå¹¶ä¸”å¤´ç»“ç‚¹çš„waitStatusä¸æ˜¯åˆå§‹åŒ–èŠ‚ç‚¹æƒ…å†µï¼Œè§£é™¤çº¿ç¨‹æŒ‚èµ·çŠ¶æ€\n    if (h != null \u0026\u0026 h.waitStatus != 0)\n      unparkSuccessor(h);\n    return true;\n  }\n  return false;\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213550-8v5vxzj","Type":"NodeParagraph","Properties":{"id":"20240201213550-8v5vxzj","updated":"20240201213550"},"Children":[{"Type":"NodeText","Data":"è¿™é‡Œçš„åˆ¤æ–­æ¡ä»¶ä¸ºä»€ä¹ˆæ˜¯ h != null \u0026\u0026 h.waitStatus != 0ï¼Ÿ"}]},{"ID":"20240201213551-t9ca32v","Type":"NodeBlockquote","Properties":{"id":"20240201213551-t9ca32v","updated":"20240201213551"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213552-awtypyn","Type":"NodeParagraph","Properties":{"id":"20240201213552-awtypyn","updated":"20240201213552"},"Children":[{"Type":"NodeText","Data":"h == null Head è¿˜æ²¡åˆå§‹åŒ–ã€‚åˆå§‹æƒ…å†µä¸‹ï¼Œhead == nullï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹å…¥é˜Ÿï¼ŒHead ä¼šè¢«åˆå§‹åŒ–ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ã€‚æ‰€ä»¥è¯´ï¼Œè¿™é‡Œå¦‚æœè¿˜æ²¡æ¥å¾—åŠå…¥é˜Ÿï¼Œå°±ä¼šå‡ºç° head == null çš„æƒ…å†µã€‚"}]},{"ID":"20240201213553-xopsmrs","Type":"NodeParagraph","Properties":{"id":"20240201213553-xopsmrs","updated":"20240201213553"},"Children":[{"Type":"NodeText","Data":"h != null \u0026\u0026 waitStatus == 0 è¡¨æ˜åç»§èŠ‚ç‚¹å¯¹åº”çš„çº¿ç¨‹ä»åœ¨è¿è¡Œä¸­ï¼Œä¸éœ€è¦å”¤é†’ã€‚"}]},{"ID":"20240201213554-0umzcrw","Type":"NodeParagraph","Properties":{"id":"20240201213554-0umzcrw","updated":"20240201213554"},"Children":[{"Type":"NodeText","Data":"h != null \u0026\u0026 waitStatus \u003c 0 è¡¨æ˜åç»§èŠ‚ç‚¹å¯èƒ½è¢«é˜»å¡äº†ï¼Œéœ€è¦å”¤é†’ã€‚"}]}]},{"ID":"20240201213555-sfdrudo","Type":"NodeParagraph","Properties":{"id":"20240201213555-sfdrudo","updated":"20240201213555"},"Children":[{"Type":"NodeText","Data":"å†çœ‹ä¸€ä¸‹ unparkSuccessor æ–¹æ³•ï¼š"}]},{"ID":"20240201213556-7287tby","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213556-7287tby","updated":"20240201213556"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate void unparkSuccessor(Node node) {\n  // è·å–å¤´ç»“ç‚¹waitStatus\n  int ws = node.waitStatus;\n  if (ws \u003c 0)\n    compareAndSetWaitStatus(node, ws, 0);\n  // è·å–å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹\n  Node s = node.next;\n  // å¦‚æœä¸‹ä¸ªèŠ‚ç‚¹æ˜¯nullæˆ–è€…ä¸‹ä¸ªèŠ‚ç‚¹è¢«cancelledï¼Œå°±æ‰¾åˆ°é˜Ÿåˆ—æœ€å¼€å§‹çš„écancelledçš„èŠ‚ç‚¹\n  if (s == null || s.waitStatus \u003e 0) {\n    s = null;\n    // å°±ä»å°¾éƒ¨èŠ‚ç‚¹å¼€å§‹æ‰¾ï¼Œåˆ°é˜Ÿé¦–ï¼Œæ‰¾åˆ°é˜Ÿåˆ—ç¬¬ä¸€ä¸ªwaitStatus\u003c0çš„èŠ‚ç‚¹ã€‚\n    for (Node t = tail; t != null \u0026\u0026 t != node; t = t.prev)\n      if (t.waitStatus \u003c= 0)\n        s = t;\n  }\n  // å¦‚æœå½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸ªèŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œè€Œä¸”çŠ¶æ€\u003c=0ï¼Œå°±æŠŠå½“å‰èŠ‚ç‚¹unpark\n  if (s != null)\n    LockSupport.unpark(s.thread);\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213557-v4nvioq","Type":"NodeParagraph","Properties":{"id":"20240201213557-v4nvioq","updated":"20240201213557"},"Children":[{"Type":"NodeText","Data":"ä¸ºä»€ä¹ˆè¦ä»åå¾€å‰æ‰¾ç¬¬ä¸€ä¸ªé Cancelled çš„èŠ‚ç‚¹å‘¢ï¼ŸåŸå› å¦‚ä¸‹ã€‚"}]},{"ID":"20240201213558-5e13cx0","Type":"NodeParagraph","Properties":{"id":"20240201213558-5e13cx0","updated":"20240201213558"},"Children":[{"Type":"NodeText","Data":"ä¹‹å‰çš„ addWaiter æ–¹æ³•ï¼š"}]},{"ID":"20240201213559-rcqakm3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213559-rcqakm3","updated":"20240201213559"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate Node addWaiter(Node mode) {\n  Node node = new Node(Thread.currentThread(), mode);\n  // Try the fast path of enq; backup to full enq on failure\n  Node pred = tail;\n  if (pred != null) {\n    node.prev = pred;\n    if (compareAndSetTail(pred, node)) {\n      pred.next = node;\n      return node;\n    }\n  }\n  enq(node);\n  return node;\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213560-r3gq4nb","Type":"NodeParagraph","Properties":{"id":"20240201213560-r3gq4nb","updated":"20240201213560"},"Children":[{"Type":"NodeText","Data":"æˆ‘ä»¬ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒèŠ‚ç‚¹å…¥é˜Ÿå¹¶ä¸æ˜¯åŸå­æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œnode.prev = pred; compareAndSetTail(pred, node) è¿™ä¸¤ä¸ªåœ°æ–¹å¯ä»¥çœ‹ä½œ Tail å…¥é˜Ÿçš„åŸå­æ“ä½œï¼Œä½†æ˜¯æ­¤æ—¶ pred.next = node;è¿˜æ²¡æ‰§è¡Œï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æ‰§è¡Œäº† unparkSuccessor æ–¹æ³•ï¼Œå°±æ²¡åŠæ³•ä»å‰å¾€åæ‰¾äº†ï¼Œæ‰€ä»¥éœ€è¦ä»åå¾€å‰æ‰¾ã€‚è¿˜æœ‰ä¸€ç‚¹åŸå› ï¼Œåœ¨äº§ç”Ÿ CANCELLED çŠ¶æ€èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå…ˆæ–­å¼€çš„æ˜¯ Next æŒ‡é’ˆï¼ŒPrev æŒ‡é’ˆå¹¶æœªæ–­å¼€ï¼Œå› æ­¤ä¹Ÿæ˜¯å¿…é¡»è¦ä»åå¾€å‰éå†æ‰èƒ½å¤Ÿéå†å®Œå…¨éƒ¨çš„ Nodeã€‚"}]},{"ID":"20240201213561-rm1jcug","Type":"NodeParagraph","Properties":{"id":"20240201213561-rm1jcug","updated":"20240201213561"},"Children":[{"Type":"NodeText","Data":"ç»¼ä¸Šæ‰€è¿°ï¼Œå¦‚æœæ˜¯ä»å‰å¾€åæ‰¾ï¼Œç”±äºæç«¯æƒ…å†µä¸‹å…¥é˜Ÿçš„éåŸå­æ“ä½œå’Œ CANCELLED èŠ‚ç‚¹äº§ç”Ÿè¿‡ç¨‹ä¸­æ–­å¼€ Next æŒ‡é’ˆçš„æ“ä½œï¼Œå¯èƒ½ä¼šå¯¼è‡´æ— æ³•éå†æ‰€æœ‰çš„èŠ‚ç‚¹ã€‚æ‰€ä»¥ï¼Œå”¤é†’å¯¹åº”çš„çº¿ç¨‹åï¼Œå¯¹åº”çš„çº¿ç¨‹å°±ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ç»§ç»­æ‰§è¡Œ acquireQueued æ–¹æ³•ä»¥åï¼Œä¸­æ–­å¦‚ä½•å¤„ç†ï¼Ÿ"}]},{"ID":"20240201213562-dj04hvl","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213562-dj04hvl","updated":"20240201213562"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3.4 ä¸­æ–­æ¢å¤åçš„æ‰§è¡Œæµç¨‹"}]},{"ID":"20240201213563-2om6j66","Type":"NodeParagraph","Properties":{"id":"20240201213563-2om6j66","updated":"20240201213563"},"Children":[{"Type":"NodeText","Data":"å”¤é†’åï¼Œä¼šæ‰§è¡Œ return Thread.interrupted();ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯å½“å‰æ‰§è¡Œçº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œå¹¶æ¸…é™¤ã€‚"}]},{"ID":"20240201213564-ok3zhej","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213564-ok3zhej","updated":"20240201213564"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate final boolean parkAndCheckInterrupt() {\n  LockSupport.park(this);\n  return Thread.interrupted();\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213565-li22kcd","Type":"NodeParagraph","Properties":{"id":"20240201213565-li22kcd","updated":"20240201213565"},"Children":[{"Type":"NodeText","Data":"å†å›åˆ° acquireQueued ä»£ç ï¼Œå½“ parkAndCheckInterrupt è¿”å› True æˆ–è€… False çš„æ—¶å€™ï¼Œinterrupted çš„å€¼ä¸åŒï¼Œä½†éƒ½ä¼šæ‰§è¡Œä¸‹æ¬¡å¾ªç¯ã€‚å¦‚æœè¿™ä¸ªæ—¶å€™è·å–é”æˆåŠŸï¼Œå°±ä¼šæŠŠå½“å‰ interrupted è¿”å›ã€‚"}]},{"ID":"20240201213566-vfe3s94","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213566-vfe3s94","updated":"20240201213566"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nfinal boolean acquireQueued(final Node node, int arg) {\n  boolean failed = true;\n  try {\n    boolean interrupted = false;\n    for (;;) {\n      final Node p = node.predecessor();\n      if (p == head \u0026\u0026 tryAcquire(arg)) {\n        setHead(node);\n        p.next = null; // help GC\n        failed = false;\n        return interrupted;\n      }\n      if (shouldParkAfterFailedAcquire(p, node) \u0026\u0026 parkAndCheckInterrupt())\n        interrupted = true;\n      }\n  } finally {\n    if (failed)\n      cancelAcquire(node);\n  }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213567-ihokr0a","Type":"NodeParagraph","Properties":{"id":"20240201213567-ihokr0a","updated":"20240201213567"},"Children":[{"Type":"NodeText","Data":"å¦‚æœ acquireQueued ä¸º Trueï¼Œå°±ä¼šæ‰§è¡Œ selfInterrupt æ–¹æ³•ã€‚"}]},{"ID":"20240201213568-utaeo8m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213568-utaeo8m","updated":"20240201213568"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nstatic void selfInterrupt() {\n  Thread.currentThread().interrupt();\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213569-im69mxd","Type":"NodeParagraph","Properties":{"id":"20240201213569-im69mxd","updated":"20240201213569"},"Children":[{"Type":"NodeText","Data":"è¯¥æ–¹æ³•å…¶å®æ˜¯ä¸ºäº†ä¸­æ–­çº¿ç¨‹ã€‚ä½†ä¸ºä»€ä¹ˆè·å–äº†é”ä»¥åè¿˜è¦ä¸­æ–­çº¿ç¨‹å‘¢ï¼Ÿè¿™éƒ¨åˆ†å±äº Java æä¾›çš„åä½œå¼ä¸­æ–­çŸ¥è¯†å†…å®¹ï¼Œæ„Ÿå…´è¶£åŒå­¦å¯ä»¥æŸ¥é˜…ä¸€ä¸‹ã€‚è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ï¼š"}]},{"ID":"20240201213570-aidn4jd","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213570-aidn4jd","updated":"20240201213570"},"Children":[{"ID":"20240201213571-fyu0bxe","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213571-fyu0bxe","updated":"20240201213571"},"Children":[{"ID":"20240201213572-6hz5p3d","Type":"NodeParagraph","Properties":{"id":"20240201213572-6hz5p3d","updated":"20240201213572"},"Children":[{"Type":"NodeText","Data":"å½“ä¸­æ–­çº¿ç¨‹è¢«å”¤é†’æ—¶ï¼Œå¹¶ä¸çŸ¥é“è¢«å”¤é†’çš„åŸå› ï¼Œå¯èƒ½æ˜¯å½“å‰çº¿ç¨‹åœ¨ç­‰å¾…ä¸­è¢«ä¸­æ–­ï¼Œä¹Ÿå¯èƒ½æ˜¯é‡Šæ”¾äº†é”ä»¥åè¢«å”¤é†’ã€‚å› æ­¤æˆ‘ä»¬é€šè¿‡ Thread.interrupted()æ–¹æ³•æ£€æŸ¥ä¸­æ–­æ ‡è®°ï¼ˆè¯¥æ–¹æ³•è¿”å›äº†å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œå¹¶å°†å½“å‰çº¿ç¨‹çš„ä¸­æ–­æ ‡è¯†è®¾ç½®ä¸º Falseï¼‰ï¼Œå¹¶è®°å½•ä¸‹æ¥ï¼Œå¦‚æœå‘ç°è¯¥çº¿ç¨‹è¢«ä¸­æ–­è¿‡ï¼Œå°±å†ä¸­æ–­ä¸€æ¬¡ã€‚"}]}]},{"ID":"20240201213573-6v7nxaj","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20240201213573-6v7nxaj","updated":"20240201213573"},"Children":[{"ID":"20240201213574-qgvpjdq","Type":"NodeParagraph","Properties":{"id":"20240201213574-qgvpjdq","updated":"20240201213574"},"Children":[{"Type":"NodeText","Data":"çº¿ç¨‹åœ¨ç­‰å¾…èµ„æºçš„è¿‡ç¨‹ä¸­è¢«å”¤é†’ï¼Œå”¤é†’åè¿˜æ˜¯ä¼šä¸æ–­åœ°å»å°è¯•è·å–é”ï¼Œç›´åˆ°æŠ¢åˆ°é”ä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ•´ä¸ªæµç¨‹ä¸­ï¼Œå¹¶ä¸å“åº”ä¸­æ–­ï¼Œåªæ˜¯è®°å½•ä¸­æ–­è®°å½•ã€‚æœ€åæŠ¢åˆ°é”è¿”å›äº†ï¼Œé‚£ä¹ˆå¦‚æœè¢«ä¸­æ–­è¿‡çš„è¯ï¼Œå°±éœ€è¦è¡¥å……ä¸€æ¬¡ä¸­æ–­ã€‚"}]}]}]},{"ID":"20240201213575-y3gwdli","Type":"NodeParagraph","Properties":{"id":"20240201213575-y3gwdli","updated":"20240201213575"},"Children":[{"Type":"NodeText","Data":"è¿™é‡Œçš„å¤„ç†æ–¹å¼ä¸»è¦æ˜¯è¿ç”¨çº¿ç¨‹æ± ä¸­åŸºæœ¬è¿ä½œå•å…ƒ Worder ä¸­çš„ runWorkerï¼Œé€šè¿‡ Thread.interrupted()è¿›è¡Œé¢å¤–çš„åˆ¤æ–­å¤„ç†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çœ‹ä¸‹ ThreadPoolExecutor æºç ã€‚"}]},{"ID":"20240201213576-r6xge1s","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213576-r6xge1s","updated":"20240201213576"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3.5 å°ç»“"}]},{"ID":"20240201213577-adqag8g","Type":"NodeParagraph","Properties":{"id":"20240201213577-adqag8g","updated":"20240201213577"},"Children":[{"Type":"NodeText","Data":"æˆ‘ä»¬åœ¨ 1.3 å°èŠ‚ä¸­æå‡ºäº†ä¸€äº›é—®é¢˜ï¼Œç°åœ¨æ¥å›ç­”ä¸€ä¸‹ã€‚"}]},{"ID":"20240201213578-l395bkl","Type":"NodeBlockquote","Properties":{"id":"20240201213578-l395bkl","updated":"20240201213578"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213579-vul0opl","Type":"NodeParagraph","Properties":{"id":"20240201213579-vul0opl","updated":"20240201213579"},"Children":[{"Type":"NodeText","Data":"Qï¼šæŸä¸ªçº¿ç¨‹è·å–é”å¤±è´¥çš„åç»­æµç¨‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"}]},{"ID":"20240201213580-hehl1bd","Type":"NodeParagraph","Properties":{"id":"20240201213580-hehl1bd","updated":"20240201213580"},"Children":[{"Type":"NodeText","Data":"Aï¼šå­˜åœ¨æŸç§æ’é˜Ÿç­‰å€™æœºåˆ¶ï¼Œçº¿ç¨‹ç»§ç»­ç­‰å¾…ï¼Œä»ç„¶ä¿ç•™è·å–é”çš„å¯èƒ½ï¼Œè·å–é”æµç¨‹ä»åœ¨ç»§ç»­ã€‚"}]},{"ID":"20240201213581-x0bllm8","Type":"NodeParagraph","Properties":{"id":"20240201213581-x0bllm8","updated":"20240201213581"},"Children":[{"Type":"NodeText","Data":"Qï¼šæ—¢ç„¶è¯´åˆ°äº†æ’é˜Ÿç­‰å€™æœºåˆ¶ï¼Œé‚£ä¹ˆå°±ä¸€å®šä¼šæœ‰æŸç§é˜Ÿåˆ—å½¢æˆï¼Œè¿™æ ·çš„é˜Ÿåˆ—æ˜¯ä»€ä¹ˆæ•°æ®ç»“æ„å‘¢ï¼Ÿ"}]},{"ID":"20240201213582-bkdjkjq","Type":"NodeParagraph","Properties":{"id":"20240201213582-bkdjkjq","updated":"20240201213582"},"Children":[{"Type":"NodeText","Data":"Aï¼šæ˜¯ CLH å˜ä½“çš„ FIFO åŒç«¯é˜Ÿåˆ—ã€‚"}]},{"ID":"20240201213583-kuo7tou","Type":"NodeParagraph","Properties":{"id":"20240201213583-kuo7tou","updated":"20240201213583"},"Children":[{"Type":"NodeText","Data":"Qï¼šå¤„äºæ’é˜Ÿç­‰å€™æœºåˆ¶ä¸­çš„çº¿ç¨‹ï¼Œä»€ä¹ˆæ—¶å€™å¯ä»¥æœ‰æœºä¼šè·å–é”å‘¢ï¼Ÿ"}]},{"ID":"20240201213584-48es8l8","Type":"NodeParagraph","Properties":{"id":"20240201213584-48es8l8","updated":"20240201213584"},"Children":[{"Type":"NodeText","Data":"Aï¼šå¯ä»¥è¯¦ç»†çœ‹ä¸‹ 2.3.1.3 å°èŠ‚ã€‚"}]},{"ID":"20240201213585-0uoj5xt","Type":"NodeParagraph","Properties":{"id":"20240201213585-0uoj5xt","updated":"20240201213585"},"Children":[{"Type":"NodeText","Data":"Qï¼šå¦‚æœå¤„äºæ’é˜Ÿç­‰å€™æœºåˆ¶ä¸­çš„çº¿ç¨‹ä¸€ç›´æ— æ³•è·å–é”ï¼Œéœ€è¦ä¸€ç›´ç­‰å¾…ä¹ˆï¼Ÿè¿˜æ˜¯æœ‰åˆ«çš„ç­–ç•¥æ¥è§£å†³è¿™ä¸€é—®é¢˜ï¼Ÿ"}]},{"ID":"20240201213586-h9c6rdm","Type":"NodeParagraph","Properties":{"id":"20240201213586-h9c6rdm","updated":"20240201213586"},"Children":[{"Type":"NodeText","Data":"Aï¼šçº¿ç¨‹æ‰€åœ¨èŠ‚ç‚¹çš„çŠ¶æ€ä¼šå˜æˆå–æ¶ˆçŠ¶æ€ï¼Œå–æ¶ˆçŠ¶æ€çš„èŠ‚ç‚¹ä¼šä»é˜Ÿåˆ—ä¸­é‡Šæ”¾ï¼Œå…·ä½“å¯è§ 2.3.2 å°èŠ‚ã€‚"}]},{"ID":"20240201213587-wiy4qzx","Type":"NodeParagraph","Properties":{"id":"20240201213587-wiy4qzx","updated":"20240201213587"},"Children":[{"Type":"NodeText","Data":"Qï¼šLock å‡½æ•°é€šè¿‡ Acquire æ–¹æ³•è¿›è¡ŒåŠ é”ï¼Œä½†æ˜¯å…·ä½“æ˜¯å¦‚ä½•åŠ é”çš„å‘¢ï¼Ÿ"}]},{"ID":"20240201213588-qki7umv","Type":"NodeParagraph","Properties":{"id":"20240201213588-qki7umv","updated":"20240201213588"},"Children":[{"Type":"NodeText","Data":"Aï¼šAQS çš„ Acquire ä¼šè°ƒç”¨ tryAcquire æ–¹æ³•ï¼ŒtryAcquire ç”±å„ä¸ªè‡ªå®šä¹‰åŒæ­¥å™¨å®ç°ï¼Œé€šè¿‡ tryAcquire å®ŒæˆåŠ é”è¿‡ç¨‹ã€‚"}]}]},{"ID":"20240201213589-v5y0y8s","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213589-v5y0y8s","updated":"20240201213589"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"4 AQS åº”ç”¨"}]},{"ID":"20240201213590-azcxl8e","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213590-azcxl8e","updated":"20240201213590"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"4.1 ReentrantLock çš„å¯é‡å…¥åº”ç”¨"}]},{"ID":"20240201213591-xsgic16","Type":"NodeParagraph","Properties":{"id":"20240201213591-xsgic16","updated":"20240201213591"},"Children":[{"Type":"NodeText","Data":"ReentrantLock çš„å¯é‡å…¥æ€§æ˜¯ AQS å¾ˆå¥½çš„åº”ç”¨ä¹‹ä¸€ï¼Œåœ¨äº†è§£å®Œä¸Šè¿°çŸ¥è¯†ç‚¹ä»¥åï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—çŸ¥ ReentrantLock å®ç°å¯é‡å…¥çš„æ–¹æ³•ã€‚åœ¨ ReentrantLock é‡Œé¢ï¼Œä¸ç®¡æ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ï¼Œéƒ½æœ‰ä¸€æ®µé€»è¾‘ã€‚"}]},{"ID":"20240201213592-ui49z4q","Type":"NodeParagraph","Properties":{"id":"20240201213592-ui49z4q","updated":"20240201213592"},"Children":[{"Type":"NodeText","Data":"å…¬å¹³é”ï¼š"}]},{"ID":"20240201213593-xa57q4s","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213593-xa57q4s","updated":"20240201213593"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.ReentrantLock.FairSync#tryAcquire\n\nif (c == 0) {\n  if (!hasQueuedPredecessors() \u0026\u0026 compareAndSetState(0, acquires)) {\n    setExclusiveOwnerThread(current);\n    return true;\n  }\n}\nelse if (current == getExclusiveOwnerThread()) {\n  int nextc = c + acquires;\n  if (nextc \u003c 0)\n    throw new Error(\"Maximum lock count exceeded\");\n  setState(nextc);\n  return true;\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213594-ktb9nvy","Type":"NodeParagraph","Properties":{"id":"20240201213594-ktb9nvy","updated":"20240201213594"},"Children":[{"Type":"NodeText","Data":"éå…¬å¹³é”ï¼š"}]},{"ID":"20240201213595-xlbi53m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213595-xlbi53m","updated":"20240201213595"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.ReentrantLock.Sync#nonfairTryAcquire\n\nif (c == 0) {\n  if (compareAndSetState(0, acquires)){\n    setExclusiveOwnerThread(current);\n    return true;\n  }\n}\nelse if (current == getExclusiveOwnerThread()) {\n  int nextc = c + acquires;\n  if (nextc \u003c 0) // overflow\n    throw new Error(\"Maximum lock count exceeded\");\n  setState(nextc);\n  return true;\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213596-v0yawsi","Type":"NodeParagraph","Properties":{"id":"20240201213596-v0yawsi","updated":"20240201213596"},"Children":[{"Type":"NodeText","Data":"ä»ä¸Šé¢è¿™ä¸¤æ®µéƒ½å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ªåŒæ­¥çŠ¶æ€ State æ¥æ§åˆ¶æ•´ä½“å¯é‡å…¥çš„æƒ…å†µã€‚State æ˜¯ Volatile ä¿®é¥°çš„ï¼Œç”¨äºä¿è¯ä¸€å®šçš„å¯è§æ€§å’Œæœ‰åºæ€§ã€‚"}]},{"ID":"20240201213597-6sezai2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213597-6sezai2","updated":"20240201213597"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"// java.util.concurrent.locks.AbstractQueuedSynchronizer\n\nprivate volatile int state;\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213598-ztri6m1","Type":"NodeParagraph","Properties":{"id":"20240201213598-ztri6m1","updated":"20240201213598"},"Children":[{"Type":"NodeText","Data":"æ¥ä¸‹æ¥çœ‹ State è¿™ä¸ªå­—æ®µä¸»è¦çš„è¿‡ç¨‹ï¼š"}]},{"ID":"20240201213599-u5vkaow","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213599-u5vkaow","updated":"20240201213599"},"Children":[{"ID":"20240201213600-q1jwf3y","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213600-q1jwf3y","updated":"20240201213600"},"Children":[{"ID":"20240201213601-zhc3gms","Type":"NodeParagraph","Properties":{"id":"20240201213601-zhc3gms","updated":"20240201213601"},"Children":[{"Type":"NodeText","Data":"State åˆå§‹åŒ–çš„æ—¶å€™ä¸º 0ï¼Œè¡¨ç¤ºæ²¡æœ‰ä»»ä½•çº¿ç¨‹æŒæœ‰é”ã€‚"}]}]},{"ID":"20240201213602-qmwjv9g","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20240201213602-qmwjv9g","updated":"20240201213602"},"Children":[{"ID":"20240201213603-f4bjmu9","Type":"NodeParagraph","Properties":{"id":"20240201213603-f4bjmu9","updated":"20240201213603"},"Children":[{"Type":"NodeText","Data":"å½“æœ‰çº¿ç¨‹æŒæœ‰è¯¥é”æ—¶ï¼Œå€¼å°±ä¼šåœ¨åŸæ¥çš„åŸºç¡€ä¸Š+1ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å¾—é”æ˜¯ï¼Œå°±ä¼šå¤šæ¬¡+1ï¼Œè¿™é‡Œå°±æ˜¯å¯é‡å…¥çš„æ¦‚å¿µã€‚"}]}]},{"ID":"20240201213604-jzsgpzw","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20240201213604-jzsgpzw","updated":"20240201213604"},"Children":[{"ID":"20240201213605-o5j1kk0","Type":"NodeParagraph","Properties":{"id":"20240201213605-o5j1kk0","updated":"20240201213605"},"Children":[{"Type":"NodeText","Data":"è§£é”ä¹Ÿæ˜¯å¯¹è¿™ä¸ªå­—æ®µ-1ï¼Œä¸€ç›´åˆ° 0ï¼Œæ­¤çº¿ç¨‹å¯¹é”é‡Šæ”¾ã€‚"}]}]}]},{"ID":"20240201213606-8wuv65w","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213606-8wuv65w","updated":"20240201213606"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"4.2 JUC ä¸­çš„åº”ç”¨åœºæ™¯"}]},{"ID":"20240201213607-kqum7us","Type":"NodeParagraph","Properties":{"id":"20240201213607-kqum7us","updated":"20240201213607"},"Children":[{"Type":"NodeText","Data":"é™¤äº†ä¸Šè¾¹ ReentrantLock çš„å¯é‡å…¥æ€§çš„åº”ç”¨ï¼ŒAQS ä½œä¸ºå¹¶å‘ç¼–ç¨‹çš„æ¡†æ¶ï¼Œä¸ºå¾ˆå¤šå…¶ä»–åŒæ­¥å·¥å…·æä¾›äº†è‰¯å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ä¸‹é¢åˆ—å‡ºäº† JUC ä¸­çš„å‡ ç§åŒæ­¥å·¥å…·ï¼Œå¤§ä½“ä»‹ç»ä¸€ä¸‹ AQS çš„åº”ç”¨åœºæ™¯ï¼š"}]},{"ID":"20240201213608-x2tx9z3","Type":"NodeTable","Data":"| åŒæ­¥å·¥å…·               | åŒæ­¥å·¥å…·ä¸ AQS çš„å…³è”                                                                                                                                       |\n| :--------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| ReentrantLock          | ä½¿ç”¨ AQS ä¿å­˜é”é‡å¤æŒæœ‰çš„æ¬¡æ•°ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è·å–é”æ—¶ï¼ŒReentrantLock è®°å½•å½“å‰è·å¾—é”çš„çº¿ç¨‹æ ‡è¯†ï¼Œç”¨äºæ£€æµ‹æ˜¯å¦é‡å¤è·å–ï¼Œä»¥åŠé”™è¯¯çº¿ç¨‹è¯•å›¾è§£é”æ“ä½œæ—¶å¼‚å¸¸æƒ…å†µçš„å¤„ç†ã€‚ |\n| Semaphore              | ä½¿ç”¨ AQS åŒæ­¥çŠ¶æ€æ¥ä¿å­˜ä¿¡å·é‡çš„å½“å‰è®¡æ•°ã€‚tryRelease ä¼šå¢åŠ è®¡æ•°ï¼ŒacquireShared ä¼šå‡å°‘è®¡æ•°ã€‚                                                                  |\n| CountDownLatch         | ä½¿ç”¨ AQS åŒæ­¥çŠ¶æ€æ¥è¡¨ç¤ºè®¡æ•°ã€‚è®¡æ•°ä¸º 0 æ—¶ï¼Œæ‰€æœ‰çš„ Acquire æ“ä½œï¼ˆCountDownLatch çš„ await æ–¹æ³•ï¼‰æ‰å¯ä»¥é€šè¿‡ã€‚                                                   |\n| ReentrantReadWriteLock | ä½¿ç”¨ AQS åŒæ­¥çŠ¶æ€ä¸­çš„ 16 ä½ä¿å­˜å†™é”æŒæœ‰çš„æ¬¡æ•°ï¼Œå‰©ä¸‹çš„ 16 ä½ç”¨äºä¿å­˜è¯»é”çš„æŒæœ‰æ¬¡æ•°ã€‚                                                                         |\n| ThreadPoolExecutor     | Worker åˆ©ç”¨ AQS åŒæ­¥çŠ¶æ€å®ç°å¯¹ç‹¬å çº¿ç¨‹å˜é‡çš„è®¾ç½®ï¼ˆtryAcquire å’Œ tryReleaseï¼‰ã€‚                                                                              |","TableAligns":[1,1],"Properties":{"id":"20240201213608-x2tx9z3","updated":"20240201213608"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"åŒæ­¥å·¥å…·"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"åŒæ­¥å·¥å…·ä¸ AQS çš„å…³è”"}]}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ReentrantLock"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä½¿ç”¨ AQS ä¿å­˜é”é‡å¤æŒæœ‰çš„æ¬¡æ•°ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è·å–é”æ—¶ï¼ŒReentrantLock è®°å½•å½“å‰è·å¾—é”çš„çº¿ç¨‹æ ‡è¯†ï¼Œç”¨äºæ£€æµ‹æ˜¯å¦é‡å¤è·å–ï¼Œä»¥åŠé”™è¯¯çº¿ç¨‹è¯•å›¾è§£é”æ“ä½œæ—¶å¼‚å¸¸æƒ…å†µçš„å¤„ç†ã€‚"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"Semaphore"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä½¿ç”¨ AQS åŒæ­¥çŠ¶æ€æ¥ä¿å­˜ä¿¡å·é‡çš„å½“å‰è®¡æ•°ã€‚tryRelease ä¼šå¢åŠ è®¡æ•°ï¼ŒacquireShared ä¼šå‡å°‘è®¡æ•°ã€‚"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"CountDownLatch"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä½¿ç”¨ AQS åŒæ­¥çŠ¶æ€æ¥è¡¨ç¤ºè®¡æ•°ã€‚è®¡æ•°ä¸º 0 æ—¶ï¼Œæ‰€æœ‰çš„ Acquire æ“ä½œï¼ˆCountDownLatch çš„ await æ–¹æ³•ï¼‰æ‰å¯ä»¥é€šè¿‡ã€‚"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ReentrantReadWriteLock"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ä½¿ç”¨ AQS åŒæ­¥çŠ¶æ€ä¸­çš„ 16 ä½ä¿å­˜å†™é”æŒæœ‰çš„æ¬¡æ•°ï¼Œå‰©ä¸‹çš„ 16 ä½ç”¨äºä¿å­˜è¯»é”çš„æŒæœ‰æ¬¡æ•°ã€‚"}]}]},{"Type":"NodeTableRow","TableAligns":[1,1],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"ThreadPoolExecutor"}]},{"Type":"NodeTableCell","TableCellAlign":1,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"Worker åˆ©ç”¨ AQS åŒæ­¥çŠ¶æ€å®ç°å¯¹ç‹¬å çº¿ç¨‹å˜é‡çš„è®¾ç½®ï¼ˆtryAcquire å’Œ tryReleaseï¼‰ã€‚"}]}]}]},{"ID":"20240201213609-cdj8jaf","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213609-cdj8jaf","updated":"20240201213609"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"4.3 è‡ªå®šä¹‰åŒæ­¥å·¥å…·"}]},{"ID":"20240201213610-xa0upmp","Type":"NodeParagraph","Properties":{"id":"20240201213610-xa0upmp","updated":"20240201213610"},"Children":[{"Type":"NodeText","Data":"äº†è§£ AQS åŸºæœ¬åŸç†ä»¥åï¼ŒæŒ‰ç…§ä¸Šé¢æ‰€è¯´çš„ AQS çŸ¥è¯†ç‚¹ï¼Œè‡ªå·±å®ç°ä¸€ä¸ªåŒæ­¥å·¥å…·ã€‚"}]},{"ID":"20240201213611-f0gzx5e","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213611-f0gzx5e","updated":"20240201213611"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"public class LeeLock  {\n\n    private static class Sync extends AbstractQueuedSynchronizer {\n        @Override\n        protected boolean tryAcquire (int arg) {\n            return compareAndSetState(0, 1);\n        }\n\n        @Override\n        protected boolean tryRelease (int arg) {\n            setState(0);\n            return true;\n        }\n\n        @Override\n        protected boolean isHeldExclusively () {\n            return getState() == 1;\n        }\n    }\n\n    private Sync sync = new Sync();\n\n    public void lock () {\n        sync.acquire(1);\n    }\n\n    public void unlock () {\n        sync.release(1);\n    }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213612-6p4vtis","Type":"NodeParagraph","Properties":{"id":"20240201213612-6p4vtis","updated":"20240201213612"},"Children":[{"Type":"NodeText","Data":"é€šè¿‡æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ Lock å®Œæˆä¸€å®šçš„åŒæ­¥åŠŸèƒ½ã€‚"}]},{"ID":"20240201213613-pnnow1b","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213613-pnnow1b","updated":"20240201213613"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"public class LeeMain {\n\n    static int count = 0;\n    static LeeLock leeLock = new LeeLock();\n\n    public static void main (String[] args) throws InterruptedException {\n\n        Runnable runnable = new Runnable() {\n            @Override\n            public void run () {\n                try {\n                    leeLock.lock();\n                    for (int i = 0; i \u003c 10000; i++) {\n                        count++;\n                    }\n                } catch (Exception e) {\n                    e.printStackTrace();\n                } finally {\n                    leeLock.unlock();\n                }\n\n            }\n        };\n        Thread thread1 = new Thread(runnable);\n        Thread thread2 = new Thread(runnable);\n        thread1.start();\n        thread2.start();\n        thread1.join();\n        thread2.join();\n        System.out.println(count);\n    }\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213614-az3sncd","Type":"NodeParagraph","Properties":{"id":"20240201213614-az3sncd","updated":"20240201213614"},"Children":[{"Type":"NodeText","Data":"ä¸Šè¿°ä»£ç æ¯æ¬¡è¿è¡Œç»“æœéƒ½ä¼šæ˜¯ 20000ã€‚é€šè¿‡ç®€å•çš„å‡ è¡Œä»£ç å°±èƒ½å®ç°åŒæ­¥åŠŸèƒ½ï¼Œè¿™å°±æ˜¯ AQS çš„å¼ºå¤§ä¹‹å¤„ã€‚"}]},{"ID":"20240201213615-zw6vngj","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213615-zw6vngj","updated":"20240201213615"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"5 æ€»ç»“"}]},{"ID":"20240201213616-ho55e3p","Type":"NodeParagraph","Properties":{"id":"20240201213616-ho55e3p","updated":"20240201213616"},"Children":[{"Type":"NodeText","Data":"æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨å¹¶å‘çš„åœºæ™¯å¤ªå¤šï¼Œä½†æ˜¯å¯¹å¹¶å‘å†…éƒ¨çš„åŸºæœ¬æ¡†æ¶åŸç†äº†è§£çš„äººå´ä¸å¤šã€‚ç”±äºç¯‡å¹…åŸå› ï¼Œæœ¬æ–‡ä»…ä»‹ç»äº†å¯é‡å…¥é” ReentrantLock çš„åŸç†å’Œ AQS åŸç†ï¼Œå¸Œæœ›èƒ½å¤Ÿæˆä¸ºå¤§å®¶äº†è§£ AQS å’Œ ReentrantLock ç­‰åŒæ­¥å™¨çš„â€œæ•²é—¨ç –â€ã€‚"}]},{"ID":"20240201213617-p66mw4v","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213617-p66mw4v","updated":"20240201213617"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"å‚è€ƒèµ„æ–™"}]},{"ID":"20240201213618-ddrtx0o","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213618-ddrtx0o","updated":"20240201213618"},"Children":[{"ID":"20240201213619-dug336k","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213619-dug336k","updated":"20240201213619"},"Children":[{"ID":"20240201213620-kgfhjb8","Type":"NodeParagraph","Properties":{"id":"20240201213620-kgfhjb8","updated":"20240201213620"},"Children":[{"Type":"NodeText","Data":"Lea D. The java. util. concurrent synchronizer framework"},{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"[","Properties":{"id":""}}]},{"Type":"NodeText","Data":"J]. Science of Computer Programming, 2005, 58(3): 293-309."}]}]},{"ID":"20240201213621-6v38r9h","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213621-6v38r9h","updated":"20240201213621"},"Children":[{"ID":"20240201213622-izseb90","Type":"NodeParagraph","Properties":{"id":"20240201213622-izseb90","updated":"20240201213622"},"Children":[{"Type":"NodeText","Data":"ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹"}]}]},{"ID":"20240201213623-a6nh639","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213623-a6nh639","updated":"20240201213623"},"Children":[{"ID":"20240201213624-vku6ngj","Type":"NodeParagraph","Properties":{"id":"20240201213624-vku6ngj","updated":"20240201213624"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://tech.meituan.com/2018/11/15/java-lock.html","TextMarkTextContent":"ä¸å¯ä¸è¯´çš„ Javaâ€œé”â€äº‹"}]}]}]},{"ID":"20240201213625-yr9oacm","Type":"NodeHTMLBlock","Data":"\u003cdiv\u003e\n\u003c!-- @include: @article-footer.snippet.md --\u003e\n\u003c/div\u003e","HtmlBlockType":2,"Properties":{"id":"20240201213625-yr9oacm","updated":"20240201213625"}}]}