{"ID":"20240201213715-t9sqc0p","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240201213715-t9sqc0p","title":"data-cold-hot-separation","updated":"20240201213715"},"Children":[{"ID":"20240201213716-d4p1p10","Type":"NodeThematicBreak","Properties":{"id":"20240201213716-d4p1p10","updated":"20240201213716"}},{"ID":"20240201213717-8y8iw40","Type":"NodeParagraph","Properties":{"id":"20240201213717-8y8iw40","updated":"20240201213717"},"Children":[{"Type":"NodeText","Data":"title: 数据冷热分离详解"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"category: 高性能"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"head:"}]},{"ID":"20240201213718-o2k9aky","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213718-o2k9aky","updated":"20240201213718"},"Children":[{"ID":"20240201213719-m5e9uc1","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213719-m5e9uc1","updated":"20240201213719"},"Children":[{"ID":"20240201213720-poy4hfa","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213720-poy4hfa","updated":"20240201213720"},"Children":[{"ID":"20240201213721-uzeupky","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213721-uzeupky","updated":"20240201213721"},"Children":[{"ID":"20240201213722-1x3um0e","Type":"NodeParagraph","Properties":{"id":"20240201213722-1x3um0e","updated":"20240201213722"},"Children":[{"Type":"NodeText","Data":"meta"}]}]},{"ID":"20240201213723-82zy41c","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213723-82zy41c","updated":"20240201213723"},"Children":[{"ID":"20240201213724-wape0hp","Type":"NodeParagraph","Properties":{"id":"20240201213724-wape0hp","updated":"20240201213724"},"Children":[{"Type":"NodeText","Data":"name: keywords"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"content: 数据冷热分离,冷数据迁移,冷数据存储"}]}]}]}]},{"ID":"20240201213725-2dd81az","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213725-2dd81az","updated":"20240201213725"},"Children":[{"ID":"20240201213726-uhk9h48","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213726-uhk9h48","updated":"20240201213726"},"Children":[{"ID":"20240201213727-wn4cbbl","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213727-wn4cbbl","updated":"20240201213727"},"Children":[{"ID":"20240201213728-hei3opi","Type":"NodeParagraph","Properties":{"id":"20240201213728-hei3opi","updated":"20240201213728"},"Children":[{"Type":"NodeText","Data":"meta"}]}]},{"ID":"20240201213729-opkyeg2","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213729-opkyeg2","updated":"20240201213729"},"Children":[{"ID":"20240201213730-0wjha26","Type":"NodeParagraph","Properties":{"id":"20240201213730-0wjha26","updated":"20240201213730"},"Children":[{"Type":"NodeText","Data":"name: description"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"content: 数据冷热分离是指根据数据的访问频率和业务重要性，将数据分为冷数据和热数据，冷数据一般存储在存储在低成本、低性能的介质中，热数据高性能存储介质中。"}]}]}]}]}]},{"ID":"20240201213731-6dde6y0","Type":"NodeThematicBreak","Properties":{"id":"20240201213731-6dde6y0","updated":"20240201213731"}},{"ID":"20240201213732-c246hau","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213732-c246hau","updated":"20240201213732"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"什么是数据冷热分离？"}]},{"ID":"20240201213733-e615su3","Type":"NodeParagraph","Properties":{"id":"20240201213733-e615su3","updated":"20240201213733"},"Children":[{"Type":"NodeText","Data":"数据冷热分离是指根据数据的访问频率和业务重要性，将数据分为冷数据和热数据，冷数据一般存储在存储在低成本、低性能的介质中，热数据高性能存储介质中。"}]},{"ID":"20240201213734-at2ofqp","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213734-at2ofqp","updated":"20240201213734"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"冷数据和热数据"}]},{"ID":"20240201213735-ma3jpuw","Type":"NodeParagraph","Properties":{"id":"20240201213735-ma3jpuw","updated":"20240201213735"},"Children":[{"Type":"NodeText","Data":"热数据是指经常被访问和修改且需要快速访问的数据，冷数据是指不经常访问，对当前项目价值较低，但需要长期保存的数据。"}]},{"ID":"20240201213736-52mrpxj","Type":"NodeParagraph","Properties":{"id":"20240201213736-52mrpxj","updated":"20240201213736"},"Children":[{"Type":"NodeText","Data":"冷热数据到底如何区分呢？有两个常见的区分方法："}]},{"ID":"20240201213737-k62ttq0","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213737-k62ttq0","updated":"20240201213737"},"Children":[{"ID":"20240201213738-zuzapy0","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213738-zuzapy0","updated":"20240201213738"},"Children":[{"ID":"20240201213739-kap4d8n","Type":"NodeParagraph","Properties":{"id":"20240201213739-kap4d8n","updated":"20240201213739"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"时间维度区分"},{"Type":"NodeText","Data":"：按照数据的创建时间、更新时间、过期时间等，将一定时间段内的数据视为热数据，超过该时间段的数据视为冷数据。例如，订单系统可以将 1 年后的订单数据作为冷数据，1 年内的订单数据作为热数据。这种方法适用于数据的访问频率和时间有较强的相关性的场景。"}]}]},{"ID":"20240201213740-jit3xew","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20240201213740-jit3xew","updated":"20240201213740"},"Children":[{"ID":"20240201213741-re4vdun","Type":"NodeParagraph","Properties":{"id":"20240201213741-re4vdun","updated":"20240201213741"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"访问评率区分"},{"Type":"NodeText","Data":"：将高频访问的数据视为热数据，低频访问的数据视为冷数据。例如，内容系统可以将浏览量非常低的文章作为冷数据，浏览量较高的文章作为热数据。这种方法需要记录数据的访问频率，成本较高，适合访问频率和数据本身有较强的相关性的场景。"}]}]}]},{"ID":"20240201213742-w54lnlw","Type":"NodeParagraph","Properties":{"id":"20240201213742-w54lnlw","updated":"20240201213742"},"Children":[{"Type":"NodeText","Data":"几年前的数据并不一定都是热数据，例如一些优质文章发表几年后依然有很多人访问，大部分普通用户新发表的文章却基本没什么人访问。"}]},{"ID":"20240201213743-yufzz8u","Type":"NodeParagraph","Properties":{"id":"20240201213743-yufzz8u","updated":"20240201213743"},"Children":[{"Type":"NodeText","Data":"这两种区分冷热数据的方法各有优劣，实际项目中，可以将两者结合使用。"}]},{"ID":"20240201213744-9zru6g4","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213744-9zru6g4","updated":"20240201213744"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"冷热分离的思想"}]},{"ID":"20240201213745-ras9h9y","Type":"NodeParagraph","Properties":{"id":"20240201213745-ras9h9y","updated":"20240201213745"},"Children":[{"Type":"NodeText","Data":"冷热分离的思想非常简单，就是对数据进行分类，然后分开存储。冷热分离的思想可以应用到很多领域和场景中，而不仅仅是数据存储，例如："}]},{"ID":"20240201213746-scjxi9z","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213746-scjxi9z","updated":"20240201213746"},"Children":[{"ID":"20240201213747-5m59g8j","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213747-5m59g8j","updated":"20240201213747"},"Children":[{"ID":"20240201213748-87f5b0z","Type":"NodeParagraph","Properties":{"id":"20240201213748-87f5b0z","updated":"20240201213748"},"Children":[{"Type":"NodeText","Data":"邮件系统中，可以将近期的比较重要的邮件放在收件箱，将比较久远的不太重要的邮件存入归档。"}]}]},{"ID":"20240201213749-t9etpkg","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213749-t9etpkg","updated":"20240201213749"},"Children":[{"ID":"20240201213750-h25zjoh","Type":"NodeParagraph","Properties":{"id":"20240201213750-h25zjoh","updated":"20240201213750"},"Children":[{"Type":"NodeText","Data":"日常生活中，可以将常用的物品放在显眼的位置，不常用的物品放入储藏室或者阁楼。"}]}]},{"ID":"20240201213751-qfq4ivb","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213751-qfq4ivb","updated":"20240201213751"},"Children":[{"ID":"20240201213752-ek2elbw","Type":"NodeParagraph","Properties":{"id":"20240201213752-ek2elbw","updated":"20240201213752"},"Children":[{"Type":"NodeText","Data":"图书馆中，可以将最受欢迎和最常借阅的图书单独放在一个显眼的区域，将较少借阅的书籍放在不起眼的位置。"}]}]},{"ID":"20240201213753-uanu4po","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213753-uanu4po","updated":"20240201213753"},"Children":[{"ID":"20240201213754-4fh5ii8","Type":"NodeParagraph","Properties":{"id":"20240201213754-4fh5ii8","updated":"20240201213754"},"Children":[{"Type":"NodeText","Data":"……"}]}]}]},{"ID":"20240201213755-kkhqeel","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213755-kkhqeel","updated":"20240201213755"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"数据冷热分离的优缺点"}]},{"ID":"20240201213756-7fnevn9","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213756-7fnevn9","updated":"20240201213756"},"Children":[{"ID":"20240201213757-18sf48d","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213757-18sf48d","updated":"20240201213757"},"Children":[{"ID":"20240201213758-ob7mgvm","Type":"NodeParagraph","Properties":{"id":"20240201213758-ob7mgvm","updated":"20240201213758"},"Children":[{"Type":"NodeText","Data":"优点：热数据的查询性能得到优化（用户的绝大部分操作体验会更好）、节约成本（可以冷热数据的不同存储需求，选择对应的数据库类型和硬件配置，比如将热数据放在 SSD 上，将冷数据放在 HDD 上）"}]}]},{"ID":"20240201213759-zcm3w48","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213759-zcm3w48","updated":"20240201213759"},"Children":[{"ID":"20240201213760-n3847vv","Type":"NodeParagraph","Properties":{"id":"20240201213760-n3847vv","updated":"20240201213760"},"Children":[{"Type":"NodeText","Data":"缺点：系统复杂性和风险增加（需要分离冷热数据，数据错误的风险增加）、统计效率低（统计的时候可能需要用到冷库的数据）。"}]}]}]},{"ID":"20240201213761-cl2rrl4","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213761-cl2rrl4","updated":"20240201213761"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"冷数据如何迁移？"}]},{"ID":"20240201213762-72e4f6j","Type":"NodeParagraph","Properties":{"id":"20240201213762-72e4f6j","updated":"20240201213762"},"Children":[{"Type":"NodeText","Data":"冷数据迁移方案："}]},{"ID":"20240201213763-ly5t8et","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213763-ly5t8et","updated":"20240201213763"},"Children":[{"ID":"20240201213764-yadilf7","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213764-yadilf7","updated":"20240201213764"},"Children":[{"ID":"20240201213765-ouayatj","Type":"NodeParagraph","Properties":{"id":"20240201213765-ouayatj","updated":"20240201213765"},"Children":[{"Type":"NodeText","Data":"业务层代码实现：当有对数据进行写操作时，触发冷热分离的逻辑，判断数据是冷数据还是热数据，冷数据就入冷库，热数据就入热库。这种方案会影响性能且冷热数据的判断逻辑不太好确定，还需要修改业务层代码，因此一般不会使用。"}]}]},{"ID":"20240201213766-v4bck73","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20240201213766-v4bck73","updated":"20240201213766"},"Children":[{"ID":"20240201213767-t1fzi40","Type":"NodeParagraph","Properties":{"id":"20240201213767-t1fzi40","updated":"20240201213767"},"Children":[{"Type":"NodeText","Data":"任务调度：可以利用 xxl-job 或者其他分布式任务调度平台定时去扫描数据库，找出满足冷数据条件的数据，然后批量地将其复制到冷库中，并从热库中删除。这种方法修改的代码非常少，非常适合按照时间区分冷热数据的场景。"}]}]},{"ID":"20240201213768-pstt5y8","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20240201213768-pstt5y8","updated":"20240201213768"},"Children":[{"ID":"20240201213769-n7y081l","Type":"NodeParagraph","Properties":{"id":"20240201213769-n7y081l","updated":"20240201213769"},"Children":[{"Type":"NodeText","Data":"监听数据库的变更日志 binlog ：将满足冷数据条件的数据从 binlog 中提取出来，然后复制到冷库中，并从热库中删除。这种方法可以不用修改代码，但不适合按照时间维度区分冷热数据的场景。"}]}]}]},{"ID":"20240201213770-7jrsu39","Type":"NodeParagraph","Properties":{"id":"20240201213770-7jrsu39","updated":"20240201213770"},"Children":[{"Type":"NodeText","Data":"如果你的公司有 DBA 的话，也可以让 DBA 进行冷数据的人工迁移，一次迁移完成冷数据到冷库。然后，再搭配上面介绍的方案实现后续冷数据的迁移工作。"}]},{"ID":"20240201213771-02e1idb","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213771-02e1idb","updated":"20240201213771"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"冷数据如何存储？"}]},{"ID":"20240201213772-a828qvu","Type":"NodeParagraph","Properties":{"id":"20240201213772-a828qvu","updated":"20240201213772"},"Children":[{"Type":"NodeText","Data":"冷数据的存储要求主要是容量大，成本低，可靠性高，访问速度可以适当牺牲。"}]},{"ID":"20240201213773-etui1vd","Type":"NodeParagraph","Properties":{"id":"20240201213773-etui1vd","updated":"20240201213773"},"Children":[{"Type":"NodeText","Data":"冷数据存储方案："}]},{"ID":"20240201213774-x96cesi","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213774-x96cesi","updated":"20240201213774"},"Children":[{"ID":"20240201213775-ada30ds","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213775-ada30ds","updated":"20240201213775"},"Children":[{"ID":"20240201213776-a0fi4w8","Type":"NodeParagraph","Properties":{"id":"20240201213776-a0fi4w8","updated":"20240201213776"},"Children":[{"Type":"NodeText","Data":"中小厂：直接使用 MySQL/PostgreSQL 即可（不改变数据库选型和项目当前使用的数据库保持一致），比如新增一张表来存储某个业务的冷数据或者使用单独的冷库来存放冷数据（涉及跨库查询，增加了系统复杂性和维护难度）"}]}]},{"ID":"20240201213777-k4bejqm","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213777-k4bejqm","updated":"20240201213777"},"Children":[{"ID":"20240201213778-b2kbp1w","Type":"NodeParagraph","Properties":{"id":"20240201213778-b2kbp1w","updated":"20240201213778"},"Children":[{"Type":"NodeText","Data":"大厂：Hbase（常用）、RocksDB、Doris、Cassandra"}]}]}]},{"ID":"20240201213779-em25ocl","Type":"NodeParagraph","Properties":{"id":"20240201213779-em25ocl","updated":"20240201213779"},"Children":[{"Type":"NodeText","Data":"如果公司成本预算足的话，也可以直接上 TiDB 这种分布式关系型数据库，直接一步到位。TiDB 6.0 正式支持数据冷热存储分离，可以降低 SSD 使用成本。使用 TiDB 6.0 的数据放置功能，可以在同一个集群实现海量数据的冷热存储，将新的热数据存入 SSD，历史冷数据存入 HDD。"}]},{"ID":"20240201213780-bj7cano","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213780-bj7cano","updated":"20240201213780"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"案例分享"}]},{"ID":"20240201213781-r2btvuo","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213781-r2btvuo","updated":"20240201213781"},"Children":[{"ID":"20240201213782-10i39sa","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213782-10i39sa","updated":"20240201213782"},"Children":[{"ID":"20240201213783-nqd9e9k","Type":"NodeParagraph","Properties":{"id":"20240201213783-nqd9e9k","updated":"20240201213783"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.cnblogs.com/fulongyuanjushi/p/17910420.html","TextMarkTextContent":"如何快速优化几千万数据量的订单表 - 程序员济癫 - 2023"}]}]},{"ID":"20240201213784-isx325w","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213784-isx325w","updated":"20240201213784"},"Children":[{"ID":"20240201213785-ffy49e6","Type":"NodeParagraph","Properties":{"id":"20240201213785-ffy49e6","updated":"20240201213785"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://mp.weixin.qq.com/s/ZKRkZP6rLHuTE1wvnqmAPQ","TextMarkTextContent":"海量数据冷热分离方案与实践 - 字节跳动技术团队 - 2022"}]}]}]}]}