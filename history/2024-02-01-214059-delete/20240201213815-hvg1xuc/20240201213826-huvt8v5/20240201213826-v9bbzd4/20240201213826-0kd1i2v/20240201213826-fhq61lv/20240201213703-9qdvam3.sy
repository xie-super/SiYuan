{"ID":"20240201213703-9qdvam3","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240201213703-9qdvam3","title":"transaction-isolation-level","updated":"20240201213703"},"Children":[{"ID":"20240201213704-y0c5aug","Type":"NodeThematicBreak","Properties":{"id":"20240201213704-y0c5aug","updated":"20240201213704"}},{"ID":"20240201213705-6xn18ew","Type":"NodeParagraph","Properties":{"id":"20240201213705-6xn18ew","updated":"20240201213705"},"Children":[{"Type":"NodeText","Data":"title: MySQL事务隔离级别详解"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"category: 数据库"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"tag:"}]},{"ID":"20240201213706-58pkwjb","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213706-58pkwjb","updated":"20240201213706"},"Children":[{"ID":"20240201213707-v41tytr","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213707-v41tytr","updated":"20240201213707"},"Children":[{"ID":"20240201213708-mfqv9ho","Type":"NodeParagraph","Properties":{"id":"20240201213708-mfqv9ho","updated":"20240201213708"},"Children":[{"Type":"NodeText","Data":"MySQL"}]}]}]},{"ID":"20240201213709-f2u0sxm","Type":"NodeThematicBreak","Properties":{"id":"20240201213709-f2u0sxm","updated":"20240201213709"}},{"ID":"20240201213710-fyrrmvw","Type":"NodeBlockquote","Properties":{"id":"20240201213710-fyrrmvw","updated":"20240201213710"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213711-6cj4nm6","Type":"NodeParagraph","Properties":{"id":"20240201213711-6cj4nm6","updated":"20240201213711"},"Children":[{"Type":"NodeText","Data":"本文由 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/Snailclimb","TextMarkTextContent":"SnailClimb"},{"Type":"NodeText","Data":" 和 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/guang19","TextMarkTextContent":"guang19"},{"Type":"NodeText","Data":" 共同完成。"}]}]},{"ID":"20240201213712-p6cg99q","Type":"NodeParagraph","Properties":{"id":"20240201213712-p6cg99q","updated":"20240201213712"},"Children":[{"Type":"NodeText","Data":"关于事务基本概览的介绍，请看这篇文章的介绍："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"./mysql-questions-01.md#MySQL-事务","TextMarkTextContent":"MySQL 常见知识点\u0026amp;面试题总结"}]},{"ID":"20240201213713-u78t4ie","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213713-u78t4ie","updated":"20240201213713"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"事务隔离级别总结"}]},{"ID":"20240201213714-68or75q","Type":"NodeParagraph","Properties":{"id":"20240201213714-68or75q","updated":"20240201213714"},"Children":[{"Type":"NodeText","Data":"SQL 标准定义了四个隔离级别："}]},{"ID":"20240201213715-qsxlo65","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213715-qsxlo65","updated":"20240201213715"},"Children":[{"ID":"20240201213716-5c901rj","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213716-5c901rj","updated":"20240201213716"},"Children":[{"ID":"20240201213717-wmjpfig","Type":"NodeParagraph","Properties":{"id":"20240201213717-wmjpfig","updated":"20240201213717"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"READ-UNCOMMITTED(读取未提交)"},{"Type":"NodeText","Data":" ：最低的隔离级别，允许读取尚未提交的数据变更，可能会导致脏读、幻读或不可重复读。"}]}]},{"ID":"20240201213718-lcgggcu","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213718-lcgggcu","updated":"20240201213718"},"Children":[{"ID":"20240201213719-el9g1dt","Type":"NodeParagraph","Properties":{"id":"20240201213719-el9g1dt","updated":"20240201213719"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"READ-COMMITTED(读取已提交)"},{"Type":"NodeText","Data":" ：允许读取并发事务已经提交的数据，可以阻止脏读，但是幻读或不可重复读仍有可能发生。"}]}]},{"ID":"20240201213720-49cdy5m","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213720-49cdy5m","updated":"20240201213720"},"Children":[{"ID":"20240201213721-5ndjpa1","Type":"NodeParagraph","Properties":{"id":"20240201213721-5ndjpa1","updated":"20240201213721"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"REPEATABLE-READ(可重复读)"},{"Type":"NodeText","Data":" ：对同一字段的多次读取结果都是一致的，除非数据是被本身事务自己所修改，可以阻止脏读和不可重复读，但幻读仍有可能发生。"}]}]},{"ID":"20240201213722-2fe442z","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213722-2fe442z","updated":"20240201213722"},"Children":[{"ID":"20240201213723-reuvdip","Type":"NodeParagraph","Properties":{"id":"20240201213723-reuvdip","updated":"20240201213723"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"SERIALIZABLE(可串行化)"},{"Type":"NodeText","Data":" ：最高的隔离级别，完全服从 ACID 的隔离级别。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。"}]}]}]},{"ID":"20240201213724-pxpj0cy","Type":"NodeThematicBreak","Properties":{"id":"20240201213724-pxpj0cy","updated":"20240201213724"}},{"ID":"20240201213725-bot8zgw","Type":"NodeTable","Data":"|     隔离级别     | 脏读 | 不可重复读 | 幻读 |\n| :--------------: | :--: | :--------: | :--: |\n| READ-UNCOMMITTED |  √   |     √      |  √   |\n|  READ-COMMITTED  |  ×   |     √      |  √   |\n| REPEATABLE-READ  |  ×   |     ×      |  √   |\n|   SERIALIZABLE   |  ×   |     ×      |  ×   |","TableAligns":[2,2,2,2],"Properties":{"id":"20240201213725-bot8zgw","updated":"20240201213725"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"隔离级别"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"脏读"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"不可重复读"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"幻读"}]}]}]},{"Type":"NodeTableRow","TableAligns":[2,2,2,2],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"READ-UNCOMMITTED"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"√"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"√"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"√"}]}]},{"Type":"NodeTableRow","TableAligns":[2,2,2,2],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"READ-COMMITTED"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"×"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"√"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"√"}]}]},{"Type":"NodeTableRow","TableAligns":[2,2,2,2],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"REPEATABLE-READ"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"×"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"×"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"√"}]}]},{"Type":"NodeTableRow","TableAligns":[2,2,2,2],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"SERIALIZABLE"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"×"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"×"}]},{"Type":"NodeTableCell","TableCellAlign":2,"Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"×"}]}]}]},{"ID":"20240201213726-gv4b9io","Type":"NodeParagraph","Properties":{"id":"20240201213726-gv4b9io","updated":"20240201213726"},"Children":[{"Type":"NodeText","Data":"MySQL InnoDB 存储引擎的默认支持的隔离级别是 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"REPEATABLE-READ（可重读）"},{"Type":"NodeText","Data":"。我们可以通过"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SELECT @@tx_isolation;"},{"Type":"NodeText","Data":"命令来查看，MySQL 8.0 该命令改为"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SELECT @@transaction_isolation;"}]},{"ID":"20240201213727-6lguwct","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213727-6lguwct","updated":"20240201213727"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"MySQL\u003e SELECT @@tx_isolation;\n+-----------------+\n| @@tx_isolation  |\n+-----------------+\n| REPEATABLE-READ |\n+-----------------+\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213728-twf54x3","Type":"NodeParagraph","Properties":{"id":"20240201213728-twf54x3","updated":"20240201213728"},"Children":[{"Type":"NodeText","Data":"从上面对 SQL 标准定义了四个隔离级别的介绍可以看出，标准的 SQL 隔离级别定义里，REPEATABLE-READ(可重复读)是不可以防止幻读的。"}]},{"ID":"20240201213729-10tc0lv","Type":"NodeParagraph","Properties":{"id":"20240201213729-10tc0lv","updated":"20240201213729"},"Children":[{"Type":"NodeText","Data":"但是！InnoDB 实现的 REPEATABLE-READ 隔离级别其实是可以解决幻读问题发生的，主要有下面两种情况："}]},{"ID":"20240201213730-u3ivy6v","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213730-u3ivy6v","updated":"20240201213730"},"Children":[{"ID":"20240201213731-ggtbki9","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213731-ggtbki9","updated":"20240201213731"},"Children":[{"ID":"20240201213732-j4s1fei","Type":"NodeParagraph","Properties":{"id":"20240201213732-j4s1fei","updated":"20240201213732"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"快照读"},{"Type":"NodeText","Data":"：由 MVCC 机制来保证不出现幻读。"}]}]},{"ID":"20240201213733-36fdxah","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213733-36fdxah","updated":"20240201213733"},"Children":[{"ID":"20240201213734-dhebd7b","Type":"NodeParagraph","Properties":{"id":"20240201213734-dhebd7b","updated":"20240201213734"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"当前读"},{"Type":"NodeText","Data":"：使用 Next-Key Lock 进行加锁来保证不出现幻读，Next-Key Lock 是行锁（Record Lock）和间隙锁（Gap Lock）的结合，行锁只能锁住已经存在的行，为了避免插入新行，需要依赖间隙锁。"}]}]}]},{"ID":"20240201213735-lwzwb6f","Type":"NodeParagraph","Properties":{"id":"20240201213735-lwzwb6f","updated":"20240201213735"},"Children":[{"Type":"NodeText","Data":"因为隔离级别越低，事务请求的锁越少，所以大部分数据库系统的隔离级别都是 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"READ-COMMITTED"},{"Type":"NodeText","Data":" ，但是你要知道的是 InnoDB 存储引擎默认使用 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"REPEATABLE-READ"},{"Type":"NodeText","Data":" 并不会有任何性能损失。"}]},{"ID":"20240201213736-05ngpqz","Type":"NodeParagraph","Properties":{"id":"20240201213736-05ngpqz","updated":"20240201213736"},"Children":[{"Type":"NodeText","Data":"InnoDB 存储引擎在分布式事务的情况下一般会用到 SERIALIZABLE 隔离级别。"}]},{"ID":"20240201213737-8guhp06","Type":"NodeParagraph","Properties":{"id":"20240201213737-8guhp06","updated":"20240201213737"},"Children":[{"Type":"NodeText","Data":"《MySQL 技术内幕：InnoDB 存储引擎(第 2 版)》7.7 章这样写到："}]},{"ID":"20240201213738-4gld2e6","Type":"NodeBlockquote","Properties":{"id":"20240201213738-4gld2e6","updated":"20240201213738"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213739-w8yia90","Type":"NodeParagraph","Properties":{"id":"20240201213739-w8yia90","updated":"20240201213739"},"Children":[{"Type":"NodeText","Data":"InnoDB 存储引擎提供了对 XA 事务的支持，并通过 XA 事务来支持分布式事务的实现。分布式事务指的是允许多个独立的事务资源（transactional resources）参与到一个全局的事务中。事务资源通常是关系型数据库系统，但也可以是其他类型的资源。全局事务要求在其中的所有参与的事务要么都提交，要么都回滚，这对于事务原有的 ACID 要求又有了提高。另外，在使用分布式事务时，InnoDB 存储引擎的事务隔离级别必须设置为 SERIALIZABLE。"}]}]},{"ID":"20240201213740-uut2xer","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213740-uut2xer","updated":"20240201213740"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"实际情况演示"}]},{"ID":"20240201213741-ql10o7c","Type":"NodeParagraph","Properties":{"id":"20240201213741-ql10o7c","updated":"20240201213741"},"Children":[{"Type":"NodeText","Data":"在下面我会使用 2 个命令行 MySQL ，模拟多线程（多事务）对同一份数据的脏读问题。"}]},{"ID":"20240201213742-z88eus2","Type":"NodeParagraph","Properties":{"id":"20240201213742-z88eus2","updated":"20240201213742"},"Children":[{"Type":"NodeText","Data":"MySQL 命令行的默认配置中事务都是自动提交的，即执行 SQL 语句后就会马上执行 COMMIT 操作。如果要显式地开启一个事务需要使用命令："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"START TRANSACTION"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240201213743-nc04j2d","Type":"NodeParagraph","Properties":{"id":"20240201213743-nc04j2d","updated":"20240201213743"},"Children":[{"Type":"NodeText","Data":"我们可以通过下面的命令来设置隔离级别。"}]},{"ID":"20240201213744-0u39tst","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213744-0u39tst","updated":"20240201213744"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SET [SESSION|GLOBAL] TRANSACTION ISOLATION LEVEL [READ UNCOMMITTED|READ COMMITTED|REPEATABLE READ|SERIALIZABLE]\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213745-choydlu","Type":"NodeParagraph","Properties":{"id":"20240201213745-choydlu","updated":"20240201213745"},"Children":[{"Type":"NodeText","Data":"我们再来看一下我们在下面实际操作中使用到的一些并发控制语句:"}]},{"ID":"20240201213746-ge51zcy","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213746-ge51zcy","updated":"20240201213746"},"Children":[{"ID":"20240201213747-aaz60m2","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213747-aaz60m2","updated":"20240201213747"},"Children":[{"ID":"20240201213748-pppvyo0","Type":"NodeParagraph","Properties":{"id":"20240201213748-pppvyo0","updated":"20240201213748"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"START TRANSACTION"},{"Type":"NodeText","Data":" |"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"BEGIN"},{"Type":"NodeText","Data":"：显式地开启一个事务。"}]}]},{"ID":"20240201213749-p8w846l","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213749-p8w846l","updated":"20240201213749"},"Children":[{"ID":"20240201213750-68u1iqq","Type":"NodeParagraph","Properties":{"id":"20240201213750-68u1iqq","updated":"20240201213750"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"COMMIT"},{"Type":"NodeText","Data":"：提交事务，使得对数据库做的所有修改成为永久性。"}]}]},{"ID":"20240201213751-5kknk02","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213751-5kknk02","updated":"20240201213751"},"Children":[{"ID":"20240201213752-flwb97x","Type":"NodeParagraph","Properties":{"id":"20240201213752-flwb97x","updated":"20240201213752"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"ROLLBACK"},{"Type":"NodeText","Data":"：回滚会结束用户的事务，并撤销正在进行的所有未提交的修改。"}]}]}]},{"ID":"20240201213753-qlu0n9s","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213753-qlu0n9s","updated":"20240201213753"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"脏读(读未提交)"}]},{"ID":"20240201213754-q6z64gh","Type":"NodeParagraph","Properties":{"id":"20240201213754-q6z64gh","updated":"20240201213754"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/2019-31-1%E8%84%8F%E8%AF%BB(%E8%AF%BB%E6%9C%AA%E6%8F%90%E4%BA%A4)%E5%AE%9E%E4%BE%8B.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213755-i30c8vw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213755-i30c8vw","updated":"20240201213755"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"避免脏读(读已提交)"}]},{"ID":"20240201213756-5m10jve","Type":"NodeParagraph","Properties":{"id":"20240201213756-5m10jve","updated":"20240201213756"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/2019-31-2%E8%AF%BB%E5%B7%B2%E6%8F%90%E4%BA%A4%E5%AE%9E%E4%BE%8B.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213757-tr3egyc","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213757-tr3egyc","updated":"20240201213757"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"不可重复读"}]},{"ID":"20240201213758-m80qeoe","Type":"NodeParagraph","Properties":{"id":"20240201213758-m80qeoe","updated":"20240201213758"},"Children":[{"Type":"NodeText","Data":"还是刚才上面的读已提交的图，虽然避免了读未提交，但是却出现了，一个事务还没有结束，就发生了 不可重复读问题。"}]},{"ID":"20240201213759-bvpphu6","Type":"NodeParagraph","Properties":{"id":"20240201213759-bvpphu6","updated":"20240201213759"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/2019-32-1%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E5%AE%9E%E4%BE%8B.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213760-g1epjsm","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213760-g1epjsm","updated":"20240201213760"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"可重复读"}]},{"ID":"20240201213761-cwbq4g1","Type":"NodeParagraph","Properties":{"id":"20240201213761-cwbq4g1","updated":"20240201213761"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/2019-33-2%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213762-7yw34dq","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213762-7yw34dq","updated":"20240201213762"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"幻读"}]},{"ID":"20240201213763-vcx55in","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213763-vcx55in","updated":"20240201213763"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"演示幻读出现的情况"}]},{"ID":"20240201213764-tp65rde","Type":"NodeParagraph","Properties":{"id":"20240201213764-tp65rde","updated":"20240201213764"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/phantom_read.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213765-kzrtsp4","Type":"NodeParagraph","Properties":{"id":"20240201213765-kzrtsp4","updated":"20240201213765"},"Children":[{"Type":"NodeText","Data":"SQL 脚本 1 在第一次查询工资为 500 的记录时只有一条，SQL 脚本 2 插入了一条工资为 500 的记录，提交之后；SQL 脚本 1 在同一个事务中再次使用当前读查询发现出现了两条工资为 500 的记录这种就是幻读。"}]},{"ID":"20240201213766-rr2zlmj","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213766-rr2zlmj","updated":"20240201213766"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"解决幻读的方法"}]},{"ID":"20240201213767-340l169","Type":"NodeParagraph","Properties":{"id":"20240201213767-340l169","updated":"20240201213767"},"Children":[{"Type":"NodeText","Data":"解决幻读的方式有很多，但是它们的核心思想就是一个事务在操作某张表数据的时候，另外一个事务不允许新增或者删除这张表中的数据了。解决幻读的方式主要有以下几种："}]},{"ID":"20240201213768-6l8jbxo","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213768-6l8jbxo","updated":"20240201213768"},"Children":[{"ID":"20240201213769-r30pdl3","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213769-r30pdl3","updated":"20240201213769"},"Children":[{"ID":"20240201213770-hwizrok","Type":"NodeParagraph","Properties":{"id":"20240201213770-hwizrok","updated":"20240201213770"},"Children":[{"Type":"NodeText","Data":"将事务隔离级别调整为 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SERIALIZABLE"},{"Type":"NodeText","Data":" 。"}]}]},{"ID":"20240201213771-5fdzjpp","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20240201213771-5fdzjpp","updated":"20240201213771"},"Children":[{"ID":"20240201213772-eca3jtr","Type":"NodeParagraph","Properties":{"id":"20240201213772-eca3jtr","updated":"20240201213772"},"Children":[{"Type":"NodeText","Data":"在可重复读的事务级别下，给事务操作的这张表添加表锁。"}]}]},{"ID":"20240201213773-3ll6cob","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20240201213773-3ll6cob","updated":"20240201213773"},"Children":[{"ID":"20240201213774-opuqllc","Type":"NodeParagraph","Properties":{"id":"20240201213774-opuqllc","updated":"20240201213774"},"Children":[{"Type":"NodeText","Data":"在可重复读的事务级别下，给事务操作的这张表添加 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Next-key Lock（Record Lock+Gap Lock）"},{"Type":"NodeText","Data":"。"}]}]}]},{"ID":"20240201213775-106jkdp","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213775-106jkdp","updated":"20240201213775"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"参考"}]},{"ID":"20240201213776-x1p4oir","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213776-x1p4oir","updated":"20240201213776"},"Children":[{"ID":"20240201213777-mwd1v1j","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213777-mwd1v1j","updated":"20240201213777"},"Children":[{"ID":"20240201213778-jn3c32r","Type":"NodeParagraph","Properties":{"id":"20240201213778-jn3c32r","updated":"20240201213778"},"Children":[{"Type":"NodeText","Data":"《MySQL 技术内幕：InnoDB 存储引擎》"}]}]},{"ID":"20240201213779-bq0fbww","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213779-bq0fbww","updated":"20240201213779"},"Children":[{"ID":"20240201213780-qqqkq9e","Type":"NodeParagraph","Properties":{"id":"20240201213780-qqqkq9e","updated":"20240201213780"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://dev.MySQL.com/doc/refman/5.7/en/","TextMarkTextContent":"https://dev.MySQL.com/doc/refman/5.7/en/"}]}]},{"ID":"20240201213781-95htpiw","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213781-95htpiw","updated":"20240201213781"},"Children":[{"ID":"20240201213782-ufncy56","Type":"NodeParagraph","Properties":{"id":"20240201213782-ufncy56","updated":"20240201213782"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://tech.youzan.com/seven-questions-about-the-lock-of-MySQL/","TextMarkTextContent":"Mysql 锁：灵魂七拷问"}]}]},{"ID":"20240201213783-oyp99b1","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213783-oyp99b1","updated":"20240201213783"},"Children":[{"ID":"20240201213784-qsic1pv","Type":"NodeParagraph","Properties":{"id":"20240201213784-qsic1pv","updated":"20240201213784"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://tech.meituan.com/2014/08/20/innodb-lock.html","TextMarkTextContent":"Innodb 中的事务隔离级别和锁的关系"}]}]}]},{"ID":"20240201213785-322wiow","Type":"NodeHTMLBlock","Data":"\u003cdiv\u003e\n\u003c!-- @include: @article-footer.snippet.md --\u003e\n\u003c/div\u003e","HtmlBlockType":2,"Properties":{"id":"20240201213785-322wiow","updated":"20240201213785"}}]}