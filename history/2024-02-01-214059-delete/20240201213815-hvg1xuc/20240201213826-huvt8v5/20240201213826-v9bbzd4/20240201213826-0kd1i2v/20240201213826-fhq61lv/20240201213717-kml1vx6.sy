{"ID":"20240201213717-kml1vx6","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240201213717-kml1vx6","title":"some-thoughts-on-database-storage-time","updated":"20240201213717"},"Children":[{"ID":"20240201213718-hc4tjj6","Type":"NodeThematicBreak","Properties":{"id":"20240201213718-hc4tjj6","updated":"20240201213718"}},{"ID":"20240201213719-zztlmh7","Type":"NodeParagraph","Properties":{"id":"20240201213719-zztlmh7","updated":"20240201213719"},"Children":[{"Type":"NodeText","Data":"title: MySQL日期类型选择建议"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"category: 数据库"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"tag:"}]},{"ID":"20240201213720-cd343xc","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213720-cd343xc","updated":"20240201213720"},"Children":[{"ID":"20240201213721-9cj5ir8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213721-9cj5ir8","updated":"20240201213721"},"Children":[{"ID":"20240201213722-3qzvkjm","Type":"NodeParagraph","Properties":{"id":"20240201213722-3qzvkjm","updated":"20240201213722"},"Children":[{"Type":"NodeText","Data":"MySQL"}]}]}]},{"ID":"20240201213723-toddy5w","Type":"NodeThematicBreak","Properties":{"id":"20240201213723-toddy5w","updated":"20240201213723"}},{"ID":"20240201213724-0i9rbx5","Type":"NodeParagraph","Properties":{"id":"20240201213724-0i9rbx5","updated":"20240201213724"},"Children":[{"Type":"NodeText","Data":"我们平时开发中不可避免的就是要存储时间，比如我们要记录操作表中这条记录的时间、记录转账的交易时间、记录出发时间、用户下单时间等等。你会发现时间这个东西与我们开发的联系还是非常紧密的，用的好与不好会给我们的业务甚至功能带来很大的影响。所以，我们有必要重新出发，好好认识一下这个东西。"}]},{"ID":"20240201213725-67tt657","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213725-67tt657","updated":"20240201213725"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"不要用字符串存储日期"}]},{"ID":"20240201213726-jbycoen","Type":"NodeParagraph","Properties":{"id":"20240201213726-jbycoen","updated":"20240201213726"},"Children":[{"Type":"NodeText","Data":"和绝大部分对数据库不太了解的新手一样，我在大学的时候就这样干过，甚至认为这样是一个不错的表示日期的方法。毕竟简单直白，容易上手。"}]},{"ID":"20240201213727-19466qd","Type":"NodeParagraph","Properties":{"id":"20240201213727-19466qd","updated":"20240201213727"},"Children":[{"Type":"NodeText","Data":"但是，这是不正确的做法，主要会有下面两个问题："}]},{"ID":"20240201213728-kldlcnx","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213728-kldlcnx","updated":"20240201213728"},"Children":[{"ID":"20240201213729-80dy1im","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213729-80dy1im","updated":"20240201213729"},"Children":[{"ID":"20240201213730-9hh30sa","Type":"NodeParagraph","Properties":{"id":"20240201213730-9hh30sa","updated":"20240201213730"},"Children":[{"Type":"NodeText","Data":"字符串占用的空间更大！"}]}]},{"ID":"20240201213731-7emk3me","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20240201213731-7emk3me","updated":"20240201213731"},"Children":[{"ID":"20240201213732-wzucki8","Type":"NodeParagraph","Properties":{"id":"20240201213732-wzucki8","updated":"20240201213732"},"Children":[{"Type":"NodeText","Data":"字符串存储的日期效率比较低（逐个字符进行比对），无法用日期相关的 API 进行计算和比较。"}]}]}]},{"ID":"20240201213733-czwmid8","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213733-czwmid8","updated":"20240201213733"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"Datetime 和 Timestamp 之间的抉择"}]},{"ID":"20240201213734-h72c9y1","Type":"NodeParagraph","Properties":{"id":"20240201213734-h72c9y1","updated":"20240201213734"},"Children":[{"Type":"NodeText","Data":"Datetime 和 Timestamp 是 MySQL 提供的两种比较相似的保存时间的数据类型，可以精确到秒。他们两者究竟该如何选择呢？"}]},{"ID":"20240201213735-qlfb0c0","Type":"NodeParagraph","Properties":{"id":"20240201213735-qlfb0c0","updated":"20240201213735"},"Children":[{"Type":"NodeText","Data":"下面我们来简单对比一下二者。"}]},{"ID":"20240201213736-b6epc2x","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213736-b6epc2x","updated":"20240201213736"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"时区信息"}]},{"ID":"20240201213737-o2cl8re","Type":"NodeParagraph","Properties":{"id":"20240201213737-o2cl8re","updated":"20240201213737"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"DateTime 类型是没有时区信息的（时区无关）"},{"Type":"NodeText","Data":" ，DateTime 类型保存的时间都是当前会话所设置的时区对应的时间。这样就会有什么问题呢？当你的时区更换之后，比如你的服务器更换地址或者更换客户端连接时区设置的话，就会导致你从数据库中读出的时间错误。"}]},{"ID":"20240201213738-s67bj0l","Type":"NodeParagraph","Properties":{"id":"20240201213738-s67bj0l","updated":"20240201213738"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"Timestamp 和时区有关"},{"Type":"NodeText","Data":"。Timestamp 类型字段的值会随着服务器时区的变化而变化，自动换算成相应的时间，说简单点就是在不同时区，查询到同一个条记录此字段的值会不一样。"}]},{"ID":"20240201213739-9doqqwf","Type":"NodeParagraph","Properties":{"id":"20240201213739-9doqqwf","updated":"20240201213739"},"Children":[{"Type":"NodeText","Data":"下面实际演示一下！"}]},{"ID":"20240201213740-jk3dv7v","Type":"NodeParagraph","Properties":{"id":"20240201213740-jk3dv7v","updated":"20240201213740"},"Children":[{"Type":"NodeText","Data":"建表 SQL 语句："}]},{"ID":"20240201213741-t4vulh9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213741-t4vulh9","updated":"20240201213741"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"CREATE TABLE `time_zone_test` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `date_time` datetime DEFAULT NULL,\n  `time_stamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213742-07dsssi","Type":"NodeParagraph","Properties":{"id":"20240201213742-07dsssi","updated":"20240201213742"},"Children":[{"Type":"NodeText","Data":"插入数据："}]},{"ID":"20240201213743-ypxkfwb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213743-ypxkfwb","updated":"20240201213743"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"INSERT INTO time_zone_test(date_time,time_stamp) VALUES(NOW(),NOW());\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213744-8m7jsg9","Type":"NodeParagraph","Properties":{"id":"20240201213744-8m7jsg9","updated":"20240201213744"},"Children":[{"Type":"NodeText","Data":"查看数据："}]},{"ID":"20240201213745-q1bpwbl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213745-q1bpwbl","updated":"20240201213745"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"select date_time,time_stamp from time_zone_test;\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213746-4et79qe","Type":"NodeParagraph","Properties":{"id":"20240201213746-4et79qe","updated":"20240201213746"},"Children":[{"Type":"NodeText","Data":"结果："}]},{"ID":"20240201213747-2n9f163","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cGxhaW4=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213747-2n9f163","updated":"20240201213747"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGxhaW4=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"+---------------------+---------------------+\n| date_time           | time_stamp          |\n+---------------------+---------------------+\n| 2020-01-11 09:53:32 | 2020-01-11 09:53:32 |\n+---------------------+---------------------+\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213748-06tqh06","Type":"NodeParagraph","Properties":{"id":"20240201213748-06tqh06","updated":"20240201213748"},"Children":[{"Type":"NodeText","Data":"现在我们运行"}]},{"ID":"20240201213749-ugg4wnv","Type":"NodeParagraph","Properties":{"id":"20240201213749-ugg4wnv","updated":"20240201213749"},"Children":[{"Type":"NodeText","Data":"修改当前会话的时区:"}]},{"ID":"20240201213750-cojfrub","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213750-cojfrub","updated":"20240201213750"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"set time_zone='+8:00';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213751-oj1tfna","Type":"NodeParagraph","Properties":{"id":"20240201213751-oj1tfna","updated":"20240201213751"},"Children":[{"Type":"NodeText","Data":"再次查看数据："}]},{"ID":"20240201213752-3n8ulmm","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cGxhaW4=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213752-3n8ulmm","updated":"20240201213752"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGxhaW4=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"+---------------------+---------------------+\n| date_time           | time_stamp          |\n+---------------------+---------------------+\n| 2020-01-11 09:53:32 | 2020-01-11 17:53:32 |\n+---------------------+---------------------+\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213753-p662ru6","Type":"NodeParagraph","Properties":{"id":"20240201213753-p662ru6","updated":"20240201213753"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"扩展：一些关于 MySQL 时区设置的一个常用 sql 命令"}]},{"ID":"20240201213754-mp5yhkx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213754-mp5yhkx","updated":"20240201213754"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"# 查看当前会话时区\nSELECT @@session.time_zone;\n# 设置当前会话时区\nSET time_zone = 'Europe/Helsinki';\nSET time_zone = \"+00:00\";\n# 数据库全局时区设置\nSELECT @@global.time_zone;\n# 设置全局时区\nSET GLOBAL time_zone = '+8:00';\nSET GLOBAL time_zone = 'Europe/Helsinki';\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213755-720yvtx","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213755-720yvtx","updated":"20240201213755"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"占用空间"}]},{"ID":"20240201213756-tnogdqx","Type":"NodeParagraph","Properties":{"id":"20240201213756-tnogdqx","updated":"20240201213756"},"Children":[{"Type":"NodeText","Data":"下图是 MySQL 日期类型所占的存储空间（官方文档传送门："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://dev.mysql.com/doc/refman/8.0/en/storage-requirements.html","TextMarkTextContent":"https://dev.mysql.com/doc/refman/8.0/en/storage-requirements.html"},{"Type":"NodeText","Data":"）："}]},{"ID":"20240201213757-coz9bbq","Type":"NodeParagraph","Properties":{"id":"20240201213757-coz9bbq","updated":"20240201213757"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/FhRGUVHFK0ujRPNA75f6CuOXQHTE.jpeg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213758-mpm5e5p","Type":"NodeParagraph","Properties":{"id":"20240201213758-mpm5e5p","updated":"20240201213758"},"Children":[{"Type":"NodeText","Data":"在 MySQL 5.6.4 之前，DateTime 和 Timestamp 的存储空间是固定的，分别为 8 字节和 4 字节。但是从 MySQL 5.6.4 开始，它们的存储空间会根据毫秒精度的不同而变化，DateTime 的范围是 5"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"s","TextMarkTextContent":"8 字节，Timestamp 的范围是 4"},{"Type":"NodeText","Data":"7 字节。"}]},{"ID":"20240201213759-pv4wqoh","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213759-pv4wqoh","updated":"20240201213759"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"表示范围"}]},{"ID":"20240201213760-vrlpppr","Type":"NodeParagraph","Properties":{"id":"20240201213760-vrlpppr","updated":"20240201213760"},"Children":[{"Type":"NodeText","Data":"Timestamp 表示的时间范围更小，只能到 2038 年："}]},{"ID":"20240201213761-frdusdq","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213761-frdusdq","updated":"20240201213761"},"Children":[{"ID":"20240201213762-h55bhf0","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213762-h55bhf0","updated":"20240201213762"},"Children":[{"ID":"20240201213763-sy3k9wg","Type":"NodeParagraph","Properties":{"id":"20240201213763-sy3k9wg","updated":"20240201213763"},"Children":[{"Type":"NodeText","Data":"DateTime：1000-01-01 00:00:00.000000 ~ 9999-12-31 23:59:59.499999"}]}]},{"ID":"20240201213764-6wkvtmt","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213764-6wkvtmt","updated":"20240201213764"},"Children":[{"ID":"20240201213765-ul7r60p","Type":"NodeParagraph","Properties":{"id":"20240201213765-ul7r60p","updated":"20240201213765"},"Children":[{"Type":"NodeText","Data":"Timestamp：1970-01-01 00:00:01.000000 ~ 2038-01-19 03:14:07.499999"}]}]}]},{"ID":"20240201213766-rdq64t8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213766-rdq64t8","updated":"20240201213766"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"性能"}]},{"ID":"20240201213767-pmd02hd","Type":"NodeParagraph","Properties":{"id":"20240201213767-pmd02hd","updated":"20240201213767"},"Children":[{"Type":"NodeText","Data":"由于 TIMESTAMP 需要根据时区进行转换，所以从毫秒数转换到 TIMESTAMP 时，不仅要调用一个简单的函数，还要调用操作系统底层的系统函数。这个系统函数为了保证操作系统时区的一致性，需要进行加锁操作，这就降低了效率。"}]},{"ID":"20240201213768-g3d3opq","Type":"NodeParagraph","Properties":{"id":"20240201213768-g3d3opq","updated":"20240201213768"},"Children":[{"Type":"NodeText","Data":"DATETIME 不涉及时区转换，所以不会有这个问题。"}]},{"ID":"20240201213769-1twid2r","Type":"NodeParagraph","Properties":{"id":"20240201213769-1twid2r","updated":"20240201213769"},"Children":[{"Type":"NodeText","Data":"为了避免 TIMESTAMP 的时区转换问题，建议使用指定的时区，而不是依赖于操作系统时区。"}]},{"ID":"20240201213770-c0x02hy","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213770-c0x02hy","updated":"20240201213770"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"数值时间戳是更好的选择吗？"}]},{"ID":"20240201213771-tijsp9o","Type":"NodeParagraph","Properties":{"id":"20240201213771-tijsp9o","updated":"20240201213771"},"Children":[{"Type":"NodeText","Data":"很多时候，我们也会使用 int 或者 bigint 类型的数值也就是数值时间戳来表示时间。"}]},{"ID":"20240201213772-6czwwjd","Type":"NodeParagraph","Properties":{"id":"20240201213772-6czwwjd","updated":"20240201213772"},"Children":[{"Type":"NodeText","Data":"这种存储方式的具有 Timestamp 类型的所具有一些优点，并且使用它的进行日期排序以及对比等操作的效率会更高，跨系统也很方便，毕竟只是存放的数值。缺点也很明显，就是数据的可读性太差了，你无法直观的看到具体时间。"}]},{"ID":"20240201213773-uwo8sqn","Type":"NodeParagraph","Properties":{"id":"20240201213773-uwo8sqn","updated":"20240201213773"},"Children":[{"Type":"NodeText","Data":"时间戳的定义如下："}]},{"ID":"20240201213774-6k93d09","Type":"NodeBlockquote","Properties":{"id":"20240201213774-6k93d09","updated":"20240201213774"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213775-4z567iz","Type":"NodeParagraph","Properties":{"id":"20240201213775-4z567iz","updated":"20240201213775"},"Children":[{"Type":"NodeText","Data":"时间戳的定义是从一个基准时间开始算起，这个基准时间是「1970-1-1 00:00:00 +0:00」，从这个时间开始，用整数表示，以秒计时，随着时间的流逝这个时间整数不断增加。这样一来，我只需要一个数值，就可以完美地表示时间了，而且这个数值是一个绝对数值，即无论的身处地球的任何角落，这个表示时间的时间戳，都是一样的，生成的数值都是一样的，并且没有时区的概念，所以在系统的中时间的传输中，都不需要进行额外的转换了，只有在显示给用户的时候，才转换为字符串格式的本地时间。"}]}]},{"ID":"20240201213776-2oz4lro","Type":"NodeParagraph","Properties":{"id":"20240201213776-2oz4lro","updated":"20240201213776"},"Children":[{"Type":"NodeText","Data":"数据库中实际操作："}]},{"ID":"20240201213777-tmcrvtl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213777-tmcrvtl","updated":"20240201213777"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"mysql\u003e select UNIX_TIMESTAMP('2020-01-11 09:53:32');\n+---------------------------------------+\n| UNIX_TIMESTAMP('2020-01-11 09:53:32') |\n+---------------------------------------+\n|                            1578707612 |\n+---------------------------------------+\n1 row in set (0.00 sec)\n\nmysql\u003e select FROM_UNIXTIME(1578707612);\n+---------------------------+\n| FROM_UNIXTIME(1578707612) |\n+---------------------------+\n| 2020-01-11 09:53:32       |\n+---------------------------+\n1 row in set (0.01 sec)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213778-hd20nxr","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213778-hd20nxr","updated":"20240201213778"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"总结"}]},{"ID":"20240201213779-0ruo619","Type":"NodeParagraph","Properties":{"id":"20240201213779-0ruo619","updated":"20240201213779"},"Children":[{"Type":"NodeText","Data":"MySQL 中时间到底怎么存储才好？Datetime?Timestamp?还是数值时间戳？"}]},{"ID":"20240201213780-ull17sg","Type":"NodeParagraph","Properties":{"id":"20240201213780-ull17sg","updated":"20240201213780"},"Children":[{"Type":"NodeText","Data":"并没有一个银弹，很多程序员会觉得数值型时间戳是真的好，效率又高还各种兼容，但是很多人又觉得它表现的不够直观。"}]},{"ID":"20240201213781-klilg5c","Type":"NodeParagraph","Properties":{"id":"20240201213781-klilg5c","updated":"20240201213781"},"Children":[{"Type":"NodeText","Data":"《高性能 MySQL 》这本神书的作者就是推荐 Timestamp，原因是数值表示时间不够直观。下面是原文："}]},{"ID":"20240201213782-oulmhw2","Type":"NodeHTMLBlock","Data":"\u003cdiv\u003e\n\u003cimg src=\"https://oss.javaguide.cn/github/javaguide/%E9%AB%98%E6%80%A7%E8%83%BDmysql-%E4%B8%8D%E6%8E%A8%E8%8D%90%E7%94%A8%E6%95%B0%E5%80%BC%E6%97%B6%E9%97%B4%E6%88%B3.jpg\" style=\"zoom:50%;\" /\u003e\n\u003c/div\u003e","HtmlBlockType":7,"Properties":{"id":"20240201213782-oulmhw2","updated":"20240201213782"}},{"ID":"20240201213783-us73rrm","Type":"NodeParagraph","Properties":{"id":"20240201213783-us73rrm","updated":"20240201213783"},"Children":[{"Type":"NodeText","Data":"每种方式都有各自的优势，根据实际场景选择最合适的才是王道。下面再对这三种方式做一个简单的对比，以供大家实际开发中选择正确的存放时间的数据类型："}]},{"ID":"20240201213784-cb2ynn2","Type":"NodeTable","Data":"| 类型         | 存储空间 | 日期格式                       | 日期范围                                                     | 是否带时区信息 |\n| ------------ | -------- | ------------------------------ | ------------------------------------------------------------ | -------------- |\n| DATETIME     | 5~8 字节 | YYYY-MM-DD hh:mm:ss[.fraction] | 1000-01-01 00:00:00[.000000] ～ 9999-12-31 23:59:59[.999999] | 否             |\n| TIMESTAMP    | 4~7 字节 | YYYY-MM-DD hh:mm:ss[.fraction] | 1970-01-01 00:00:01[.000000] ～ 2038-01-19 03:14:07[.999999] | 是             |\n| 数值型时间戳 | 4 字节   | 全数字如 1578707612            | 1970-01-01 00:00:01 之后的时间                               | 否             |","TableAligns":[0,0,0,0,0],"Properties":{"id":"20240201213784-cb2ynn2","updated":"20240201213784"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"类型"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"存储空间"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"日期格式"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"日期范围"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"是否带时区信息"}]}]}]},{"Type":"NodeTableRow","TableAligns":[0,0,0,0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"DATETIME"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"5~8 字节"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"YYYY-MM-DD hh:mm:ss[.fraction]"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"1000-01-01 00:00:00[.000000] ～ 9999-12-31 23:59:59[.999999]"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"否"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0,0,0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"TIMESTAMP"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"4~7 字节"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"YYYY-MM-DD hh:mm:ss[.fraction]"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"1970-01-01 00:00:01[.000000] ～ 2038-01-19 03:14:07[.999999]"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"是"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0,0,0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"数值型时间戳"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"4 字节"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"全数字如 1578707612"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"1970-01-01 00:00:01 之后的时间"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"否"}]}]}]},{"ID":"20240201213785-5ghlp6u","Type":"NodeHTMLBlock","Data":"\u003cdiv\u003e\n\u003c!-- @include: @article-footer.snippet.md --\u003e\n\u003c/div\u003e","HtmlBlockType":2,"Properties":{"id":"20240201213785-5ghlp6u","updated":"20240201213785"}}]}