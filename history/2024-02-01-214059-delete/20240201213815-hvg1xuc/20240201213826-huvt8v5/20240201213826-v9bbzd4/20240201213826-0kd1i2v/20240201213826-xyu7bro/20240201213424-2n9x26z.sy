{"ID":"20240201213424-2n9x26z","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240201213424-2n9x26z","title":"mongodb-questions-01","updated":"20240201213424"},"Children":[{"ID":"20240201213425-rz2ayvx","Type":"NodeThematicBreak","Properties":{"id":"20240201213425-rz2ayvx","updated":"20240201213425"}},{"ID":"20240201213426-o09fgb4","Type":"NodeParagraph","Properties":{"id":"20240201213426-o09fgb4","updated":"20240201213426"},"Children":[{"Type":"NodeText","Data":"title: MongoDB常见面试题总结（上）"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"category: 数据库"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"tag:"}]},{"ID":"20240201213427-0rz93dx","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213427-0rz93dx","updated":"20240201213427"},"Children":[{"ID":"20240201213428-s5wt1fw","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213428-s5wt1fw","updated":"20240201213428"},"Children":[{"ID":"20240201213429-nnaki2t","Type":"NodeParagraph","Properties":{"id":"20240201213429-nnaki2t","updated":"20240201213429"},"Children":[{"Type":"NodeText","Data":"NoSQL"}]}]},{"ID":"20240201213430-bkbhp9l","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"MarkerOffset":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213430-bkbhp9l","updated":"20240201213430"},"Children":[{"ID":"20240201213431-1wcjvru","Type":"NodeParagraph","Properties":{"id":"20240201213431-1wcjvru","updated":"20240201213431"},"Children":[{"Type":"NodeText","Data":"MongoDB"}]}]}]},{"ID":"20240201213432-0dfkres","Type":"NodeThematicBreak","Properties":{"id":"20240201213432-0dfkres","updated":"20240201213432"}},{"ID":"20240201213433-8799myo","Type":"NodeBlockquote","Properties":{"id":"20240201213433-8799myo","updated":"20240201213433"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213434-naa925d","Type":"NodeParagraph","Properties":{"id":"20240201213434-naa925d","updated":"20240201213434"},"Children":[{"Type":"NodeText","Data":"少部分内容参考了 MongoDB 官方文档的描述，在此说明一下。"}]}]},{"ID":"20240201213435-fn7ts95","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213435-fn7ts95","updated":"20240201213435"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 基础"}]},{"ID":"20240201213436-of4gazm","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213436-of4gazm","updated":"20240201213436"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 是什么？"}]},{"ID":"20240201213437-1ctx6vx","Type":"NodeParagraph","Properties":{"id":"20240201213437-1ctx6vx","updated":"20240201213437"},"Children":[{"Type":"NodeText","Data":"MongoDB 是一个基于 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"分布式文件存储"},{"Type":"NodeText","Data":" 的开源 NoSQL 数据库系统，由 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"C++"},{"Type":"NodeText","Data":" 编写的。MongoDB 提供了 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"面向文档"},{"Type":"NodeText","Data":" 的存储方式，操作起来比较简单和容易，支持“"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"无模式"},{"Type":"NodeText","Data":"”的数据建模，可以存储比较复杂的数据类型，是一款非常流行的 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"文档类型数据库"},{"Type":"NodeText","Data":" 。"}]},{"ID":"20240201213438-oyw72op","Type":"NodeParagraph","Properties":{"id":"20240201213438-oyw72op","updated":"20240201213438"},"Children":[{"Type":"NodeText","Data":"在高负载的情况下，MongoDB 天然支持水平扩展和高可用，可以很方便地添加更多的节点/实例，以保证服务性能和可用性。在许多场景下，MongoDB 可以用于代替传统的关系型数据库或键/值存储方式，皆在为 Web 应用提供可扩展的高可用高性能数据存储解决方案。"}]},{"ID":"20240201213439-t6m0by4","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213439-t6m0by4","updated":"20240201213439"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 的存储结构是什么？"}]},{"ID":"20240201213440-w16ywal","Type":"NodeParagraph","Properties":{"id":"20240201213440-w16ywal","updated":"20240201213440"},"Children":[{"Type":"NodeText","Data":"MongoDB 的存储结构区别于传统的关系型数据库，主要由如下三个单元组成："}]},{"ID":"20240201213441-c6c0i8w","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213441-c6c0i8w","updated":"20240201213441"},"Children":[{"ID":"20240201213442-1bl2jxk","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213442-1bl2jxk","updated":"20240201213442"},"Children":[{"ID":"20240201213443-hck22ya","Type":"NodeParagraph","Properties":{"id":"20240201213443-hck22ya","updated":"20240201213443"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"文档（Document）"},{"Type":"NodeText","Data":"：MongoDB 中最基本的单元，由 BSON 键值对（key-value）组成，类似于关系型数据库中的行（Row）。"}]}]},{"ID":"20240201213444-fm4m4f1","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213444-fm4m4f1","updated":"20240201213444"},"Children":[{"ID":"20240201213445-wsftrrn","Type":"NodeParagraph","Properties":{"id":"20240201213445-wsftrrn","updated":"20240201213445"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"集合（Collection）"},{"Type":"NodeText","Data":"：一个集合可以包含多个文档，类似于关系型数据库中的表（Table）。"}]}]},{"ID":"20240201213446-eotvt6s","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213446-eotvt6s","updated":"20240201213446"},"Children":[{"ID":"20240201213447-uargj8a","Type":"NodeParagraph","Properties":{"id":"20240201213447-uargj8a","updated":"20240201213447"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"数据库（Database）"},{"Type":"NodeText","Data":"：一个数据库中可以包含多个集合，可以在 MongoDB 中创建多个数据库，类似于关系型数据库中的数据库（Database）。"}]}]}]},{"ID":"20240201213448-igkxhdv","Type":"NodeParagraph","Properties":{"id":"20240201213448-igkxhdv","updated":"20240201213448"},"Children":[{"Type":"NodeText","Data":"也就是说，MongoDB 将数据记录存储为文档 （更具体来说是"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/core/document/#std-label-bson-document-format","TextMarkTextContent":"BSON 文档"},{"Type":"NodeText","Data":"），这些文档在集合中聚集在一起，数据库中存储一个或多个文档集合。"}]},{"ID":"20240201213449-ag0f3u0","Type":"NodeParagraph","Properties":{"id":"20240201213449-ag0f3u0","updated":"20240201213449"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"SQL 与 MongoDB 常见术语对比"},{"Type":"NodeText","Data":"："}]},{"ID":"20240201213450-8hjb0kw","Type":"NodeTable","Data":"| SQL                      | MongoDB                         |\n| ------------------------ | ------------------------------- |\n| 表（Table）              | 集合（Collection）              |\n| 行（Row）                | 文档（Document）                |\n| 列（Col）                | 字段（Field）                   |\n| 主键（Primary Key）      | 对象 ID（Objectid）             |\n| 索引（Index）            | 索引（Index）                   |\n| 嵌套表（Embedded Table） | 嵌入式文档（Embedded Document） |\n| 数组（Array）            | 数组（Array）                   |","TableAligns":[0,0],"Properties":{"id":"20240201213450-8hjb0kw","updated":"20240201213450"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"SQL"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"MongoDB"}]}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"表（Table）"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"集合（Collection）"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"行（Row）"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"文档（Document）"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"列（Col）"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"字段（Field）"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"主键（Primary Key）"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"对象 ID（Objectid）"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"索引（Index）"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"索引（Index）"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"嵌套表（Embedded Table）"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"嵌入式文档（Embedded Document）"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"数组（Array）"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"数组（Array）"}]}]}]},{"ID":"20240201213451-vvheeb3","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213451-vvheeb3","updated":"20240201213451"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"文档"}]},{"ID":"20240201213452-eo31bjk","Type":"NodeParagraph","Properties":{"id":"20240201213452-eo31bjk","updated":"20240201213452"},"Children":[{"Type":"NodeText","Data":"MongoDB 中的记录就是一个 BSON 文档，它是由键值对组成的数据结构，类似于 JSON 对象，是 MongoDB 中的基本数据单元。字段的值可能包括其他文档、数组和文档数组。"}]},{"ID":"20240201213453-pntfmrm","Type":"NodeParagraph","Properties":{"id":"20240201213453-pntfmrm","updated":"20240201213453"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"MongoDB 文档","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/database/mongodb/crud-annotated-document..png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213454-ygn3d7i","Type":"NodeParagraph","Properties":{"id":"20240201213454-ygn3d7i","updated":"20240201213454"},"Children":[{"Type":"NodeText","Data":"文档的键是字符串。除了少数例外情况，键可以使用任意 UTF-8 字符。"}]},{"ID":"20240201213455-15lw631","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213455-15lw631","updated":"20240201213455"},"Children":[{"ID":"20240201213456-qunu0e8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213456-qunu0e8","updated":"20240201213456"},"Children":[{"ID":"20240201213457-nm0bvuj","Type":"NodeParagraph","Properties":{"id":"20240201213457-nm0bvuj","updated":"20240201213457"},"Children":[{"Type":"NodeText","Data":"键不能含有 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"\\0"},{"Type":"NodeText","Data":"(空字符）。这个字符用来表示键的结尾。"}]}]},{"ID":"20240201213458-e99xeht","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213458-e99xeht","updated":"20240201213458"},"Children":[{"ID":"20240201213459-ervmi6q","Type":"NodeParagraph","Properties":{"id":"20240201213459-ervmi6q","updated":"20240201213459"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"."},{"Type":"NodeText","Data":" 和 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"$"},{"Type":"NodeText","Data":" 有特别的意义，只有在特定环境下才能使用。"}]}]},{"ID":"20240201213460-x3e872u","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213460-x3e872u","updated":"20240201213460"},"Children":[{"ID":"20240201213461-nrusn86","Type":"NodeParagraph","Properties":{"id":"20240201213461-nrusn86","updated":"20240201213461"},"Children":[{"Type":"NodeText","Data":"以下划线"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"_"},{"Type":"NodeText","Data":"开头的键是保留的(不是严格要求的)。"}]}]}]},{"ID":"20240201213462-ydkjie3","Type":"NodeParagraph","Properties":{"id":"20240201213462-ydkjie3","updated":"20240201213462"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"BSON [bee·sahn]"},{"Type":"NodeText","Data":" 是 Binary "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"http://json.org/","TextMarkTextContent":"JSON"},{"Type":"NodeText","Data":"的简称，是 JSON 文档的二进制表示，支持将文档和数组嵌入到其他文档和数组中，还包含允许表示不属于 JSON 规范的数据类型的扩展。有关 BSON 规范的内容，可以参考 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"http://bsonspec.org/","TextMarkTextContent":"bsonspec.org"},{"Type":"NodeText","Data":"，另见"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/reference/bson-types/","TextMarkTextContent":"BSON 类型"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240201213463-spgikjs","Type":"NodeParagraph","Properties":{"id":"20240201213463-spgikjs","updated":"20240201213463"},"Children":[{"Type":"NodeText","Data":"根据维基百科对 BJSON 的介绍，BJSON 的遍历速度优于 JSON，这也是 MongoDB 选择 BSON 的主要原因，但 BJSON 需要更多的存储空间。"}]},{"ID":"20240201213464-ggfgb67","Type":"NodeBlockquote","Properties":{"id":"20240201213464-ggfgb67","updated":"20240201213464"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213465-i0fhfrf","Type":"NodeParagraph","Properties":{"id":"20240201213465-i0fhfrf","updated":"20240201213465"},"Children":[{"Type":"NodeText","Data":"与 JSON 相比，BSON 着眼于提高存储和扫描效率。BSON 文档中的大型元素以长度字段为前缀以便于扫描。在某些情况下，由于长度前缀和显式数组索引的存在，BSON 使用的空间会多于 JSON。"}]}]},{"ID":"20240201213466-lne97iy","Type":"NodeParagraph","Properties":{"id":"20240201213466-lne97iy","updated":"20240201213466"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"BSON 官网首页","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/database/mongodb/bsonspec.org.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213467-xc3kn6m","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213467-xc3kn6m","updated":"20240201213467"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"集合"}]},{"ID":"20240201213468-3h44mfi","Type":"NodeParagraph","Properties":{"id":"20240201213468-3h44mfi","updated":"20240201213468"},"Children":[{"Type":"NodeText","Data":"MongoDB 集合存在于数据库中，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"没有固定的结构"},{"Type":"NodeText","Data":"，也就是 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"无模式"},{"Type":"NodeText","Data":" 的，这意味着可以往集合插入不同格式和类型的数据。不过，通常情况下，插入集合中的数据都会有一定的关联性。"}]},{"ID":"20240201213469-9xry1q9","Type":"NodeParagraph","Properties":{"id":"20240201213469-9xry1q9","updated":"20240201213469"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"MongoDB 集合","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/database/mongodb/crud-annotated-collection.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213470-dvaoovu","Type":"NodeParagraph","Properties":{"id":"20240201213470-dvaoovu","updated":"20240201213470"},"Children":[{"Type":"NodeText","Data":"集合不需要事先创建，当第一个文档插入或者第一个索引创建时，如果该集合不存在，则会创建一个新的集合。"}]},{"ID":"20240201213471-pndguwy","Type":"NodeParagraph","Properties":{"id":"20240201213471-pndguwy","updated":"20240201213471"},"Children":[{"Type":"NodeText","Data":"集合名可以是满足下列条件的任意 UTF-8 字符串："}]},{"ID":"20240201213472-mudb5ty","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213472-mudb5ty","updated":"20240201213472"},"Children":[{"ID":"20240201213473-rt33r3i","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213473-rt33r3i","updated":"20240201213473"},"Children":[{"ID":"20240201213474-ffvi50p","Type":"NodeParagraph","Properties":{"id":"20240201213474-ffvi50p","updated":"20240201213474"},"Children":[{"Type":"NodeText","Data":"集合名不能是空字符串"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"\u0026quot;\u0026quot;"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20240201213475-ur2z09d","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213475-ur2z09d","updated":"20240201213475"},"Children":[{"ID":"20240201213476-mn88o2w","Type":"NodeParagraph","Properties":{"id":"20240201213476-mn88o2w","updated":"20240201213476"},"Children":[{"Type":"NodeText","Data":"集合名不能含有 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"\\0"},{"Type":"NodeText","Data":" （空字符)，这个字符表示集合名的结尾。"}]}]},{"ID":"20240201213477-8ribt2m","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213477-8ribt2m","updated":"20240201213477"},"Children":[{"ID":"20240201213478-5rdv7av","Type":"NodeParagraph","Properties":{"id":"20240201213478-5rdv7av","updated":"20240201213478"},"Children":[{"Type":"NodeText","Data":"集合名不能以\"system.\"开头，这是为系统集合保留的前缀。例如 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"system.users"},{"Type":"NodeText","Data":" 这个集合保存着数据库的用户信息，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"system.namespaces"},{"Type":"NodeText","Data":" 集合保存着所有数据库集合的信息。"}]}]},{"ID":"20240201213479-f4g88ky","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213479-f4g88ky","updated":"20240201213479"},"Children":[{"ID":"20240201213480-2ylqftw","Type":"NodeParagraph","Properties":{"id":"20240201213480-2ylqftw","updated":"20240201213480"},"Children":[{"Type":"NodeText","Data":"集合名必须以下划线或者字母符号开始，并且不能包含 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"$"},{"Type":"NodeText","Data":"。"}]}]}]},{"ID":"20240201213481-hka5ulz","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240201213481-hka5ulz","updated":"20240201213481"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"数据库"}]},{"ID":"20240201213482-yzdji1d","Type":"NodeParagraph","Properties":{"id":"20240201213482-yzdji1d","updated":"20240201213482"},"Children":[{"Type":"NodeText","Data":"数据库用于存储所有集合，而集合又用于存储所有文档。一个 MongoDB 中可以创建多个数据库，每一个数据库都有自己的集合和权限。"}]},{"ID":"20240201213483-0zajmgl","Type":"NodeParagraph","Properties":{"id":"20240201213483-0zajmgl","updated":"20240201213483"},"Children":[{"Type":"NodeText","Data":"MongoDB 预留了几个特殊的数据库。"}]},{"ID":"20240201213484-78mwvyj","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213484-78mwvyj","updated":"20240201213484"},"Children":[{"ID":"20240201213485-he7fg93","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213485-he7fg93","updated":"20240201213485"},"Children":[{"ID":"20240201213486-kyzv8vo","Type":"NodeParagraph","Properties":{"id":"20240201213486-kyzv8vo","updated":"20240201213486"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"admin"},{"Type":"NodeText","Data":" : admin 数据库主要是保存 root 用户和角色。例如，system.users 表存储用户，system.roles 表存储角色。一般不建议用户直接操作这个数据库。将一个用户添加到这个数据库，且使它拥有 admin 库上的名为 dbAdminAnyDatabase 的角色权限，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如关闭服务器。"}]}]},{"ID":"20240201213487-m6g8uyz","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213487-m6g8uyz","updated":"20240201213487"},"Children":[{"ID":"20240201213488-cp7jxiy","Type":"NodeParagraph","Properties":{"id":"20240201213488-cp7jxiy","updated":"20240201213488"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"local"},{"Type":"NodeText","Data":" : local 数据库是不会被复制到其他分片的，因此可以用来存储本地单台服务器的任意 collection。一般不建议用户直接使用 local 库存储任何数据，也不建议进行 CRUD 操作，因为数据无法被正常备份与恢复。"}]}]},{"ID":"20240201213489-ooskwpt","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213489-ooskwpt","updated":"20240201213489"},"Children":[{"ID":"20240201213490-tffgdm6","Type":"NodeParagraph","Properties":{"id":"20240201213490-tffgdm6","updated":"20240201213490"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"config"},{"Type":"NodeText","Data":" : 当 MongoDB 使用分片设置时，config 数据库可用来保存分片的相关信息。"}]}]},{"ID":"20240201213491-pvoi51d","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213491-pvoi51d","updated":"20240201213491"},"Children":[{"ID":"20240201213492-16boz7k","Type":"NodeParagraph","Properties":{"id":"20240201213492-16boz7k","updated":"20240201213492"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"test"},{"Type":"NodeText","Data":" : 默认创建的测试库，连接 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://mongoing.com/docs/reference/program/mongod.html","TextMarkTextContent":"mongod"},{"Type":"NodeText","Data":" 服务时，如果不指定连接的具体数据库，默认就会连接到 test 数据库。"}]}]}]},{"ID":"20240201213493-d0giczt","Type":"NodeParagraph","Properties":{"id":"20240201213493-d0giczt","updated":"20240201213493"},"Children":[{"Type":"NodeText","Data":"数据库名可以是满足以下条件的任意 UTF-8 字符串："}]},{"ID":"20240201213494-87eqtfy","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213494-87eqtfy","updated":"20240201213494"},"Children":[{"ID":"20240201213495-bh20mam","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213495-bh20mam","updated":"20240201213495"},"Children":[{"ID":"20240201213496-rbxwa9c","Type":"NodeParagraph","Properties":{"id":"20240201213496-rbxwa9c","updated":"20240201213496"},"Children":[{"Type":"NodeText","Data":"不能是空字符串"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"\u0026quot;\u0026quot;"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20240201213497-esundgr","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213497-esundgr","updated":"20240201213497"},"Children":[{"ID":"20240201213498-2138kex","Type":"NodeParagraph","Properties":{"id":"20240201213498-2138kex","updated":"20240201213498"},"Children":[{"Type":"NodeText","Data":"不得含有"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"' '"},{"Type":"NodeText","Data":"（空格)、"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"."},{"Type":"NodeText","Data":"、"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"$"},{"Type":"NodeText","Data":"、"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"/"},{"Type":"NodeText","Data":"、"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"\\"},{"Type":"NodeText","Data":"和 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"\\0"},{"Type":"NodeText","Data":" (空字符)。"}]}]},{"ID":"20240201213499-2h19jjr","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213499-2h19jjr","updated":"20240201213499"},"Children":[{"ID":"20240201213500-itpsjoj","Type":"NodeParagraph","Properties":{"id":"20240201213500-itpsjoj","updated":"20240201213500"},"Children":[{"Type":"NodeText","Data":"应全部小写。"}]}]},{"ID":"20240201213501-lm3o5ca","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213501-lm3o5ca","updated":"20240201213501"},"Children":[{"ID":"20240201213502-hs8ztst","Type":"NodeParagraph","Properties":{"id":"20240201213502-hs8ztst","updated":"20240201213502"},"Children":[{"Type":"NodeText","Data":"最多 64 字节。"}]}]}]},{"ID":"20240201213503-krlltt5","Type":"NodeParagraph","Properties":{"id":"20240201213503-krlltt5","updated":"20240201213503"},"Children":[{"Type":"NodeText","Data":"数据库名最终会变成文件系统里的文件，这也就是有如此多限制的原因。"}]},{"ID":"20240201213504-hq2f5xy","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213504-hq2f5xy","updated":"20240201213504"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 有什么特点？"}]},{"ID":"20240201213505-3s0759p","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213505-3s0759p","updated":"20240201213505"},"Children":[{"ID":"20240201213506-siphch3","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213506-siphch3","updated":"20240201213506"},"Children":[{"ID":"20240201213507-wgdo2a0","Type":"NodeParagraph","Properties":{"id":"20240201213507-wgdo2a0","updated":"20240201213507"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"数据记录被存储为文档"},{"Type":"NodeText","Data":"：MongoDB 中的记录就是一个 BSON 文档，它是由键值对组成的数据结构，类似于 JSON 对象，是 MongoDB 中的基本数据单元。"}]}]},{"ID":"20240201213508-56983rs","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213508-56983rs","updated":"20240201213508"},"Children":[{"ID":"20240201213509-7xxww74","Type":"NodeParagraph","Properties":{"id":"20240201213509-7xxww74","updated":"20240201213509"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"模式自由"},{"Type":"NodeText","Data":"：集合的概念类似 MySQL 里的表，但它不需要定义任何模式，能够用更少的数据对象表现复杂的领域模型对象。"}]}]},{"ID":"20240201213510-rvz864r","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213510-rvz864r","updated":"20240201213510"},"Children":[{"ID":"20240201213511-1y67vq4","Type":"NodeParagraph","Properties":{"id":"20240201213511-1y67vq4","updated":"20240201213511"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"支持多种查询方式"},{"Type":"NodeText","Data":"：MongoDB 查询 API 支持读写操作 (CRUD)以及数据聚合、文本搜索和地理空间查询。"}]}]},{"ID":"20240201213512-zu7pei8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213512-zu7pei8","updated":"20240201213512"},"Children":[{"ID":"20240201213513-fl1z0qm","Type":"NodeParagraph","Properties":{"id":"20240201213513-fl1z0qm","updated":"20240201213513"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"支持 ACID 事务"},{"Type":"NodeText","Data":"：NoSQL 数据库通常不支持事务，为了可扩展和高性能进行了权衡。不过，也有例外，MongoDB 就支持事务。与关系型数据库一样，MongoDB 事务同样具有 ACID 特性。MongoDB 单文档原生支持原子性，也具备事务的特性。MongoDB 4.0 加入了对多文档事务的支持，但只支持复制集部署模式下的事务，也就是说事务的作用域限制为一个副本集内。MongoDB 4.2 引入了分布式事务，增加了对分片集群上多文档事务的支持，并合并了对副本集上多文档事务的现有支持。"}]}]},{"ID":"20240201213514-07cio79","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213514-07cio79","updated":"20240201213514"},"Children":[{"ID":"20240201213515-o7fdqv9","Type":"NodeParagraph","Properties":{"id":"20240201213515-o7fdqv9","updated":"20240201213515"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"高效的二进制存储"},{"Type":"NodeText","Data":"：存储在集合中的文档，是以键值对的形式存在的。键用于唯一标识一个文档，一般是 ObjectId 类型，值是以 BSON 形式存在的。BSON = Binary JSON， 是在 JSON 基础上加了一些类型及元数据描述的格式。"}]}]},{"ID":"20240201213516-8h74d4w","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213516-8h74d4w","updated":"20240201213516"},"Children":[{"ID":"20240201213517-7fsvz1x","Type":"NodeParagraph","Properties":{"id":"20240201213517-7fsvz1x","updated":"20240201213517"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"自带数据压缩功能"},{"Type":"NodeText","Data":"：存储同样的数据所需的资源更少。"}]}]},{"ID":"20240201213518-id1q9r2","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213518-id1q9r2","updated":"20240201213518"},"Children":[{"ID":"20240201213519-8oibdsu","Type":"NodeParagraph","Properties":{"id":"20240201213519-8oibdsu","updated":"20240201213519"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"支持 mapreduce"},{"Type":"NodeText","Data":"：通过分治的方式完成复杂的聚合任务。不过，从 MongoDB 5.0 开始，map-reduce 已经不被官方推荐使用了，替代方案是 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/core/aggregation-pipeline/","TextMarkTextContent":"聚合管道"},{"Type":"NodeText","Data":"。聚合管道提供比 map-reduce 更好的性能和可用性。"}]}]},{"ID":"20240201213520-hj2tpeg","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213520-hj2tpeg","updated":"20240201213520"},"Children":[{"ID":"20240201213521-zf5fmm7","Type":"NodeParagraph","Properties":{"id":"20240201213521-zf5fmm7","updated":"20240201213521"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"支持多种类型的索引"},{"Type":"NodeText","Data":"：MongoDB 支持多种类型的索引，包括单字段索引、复合索引、多键索引、哈希索引、文本索引、 地理位置索引等，每种类型的索引有不同的使用场合。"}]}]},{"ID":"20240201213522-yi9jiur","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213522-yi9jiur","updated":"20240201213522"},"Children":[{"ID":"20240201213523-he32n61","Type":"NodeParagraph","Properties":{"id":"20240201213523-he32n61","updated":"20240201213523"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"支持 failover"},{"Type":"NodeText","Data":"：提供自动故障恢复的功能，主节点发生故障时，自动从从节点中选举出一个新的主节点，确保集群的正常使用，这对于客户端来说是无感知的。"}]}]},{"ID":"20240201213524-1h31kn8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213524-1h31kn8","updated":"20240201213524"},"Children":[{"ID":"20240201213525-7c89oul","Type":"NodeParagraph","Properties":{"id":"20240201213525-7c89oul","updated":"20240201213525"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"支持分片集群"},{"Type":"NodeText","Data":"：MongoDB 支持集群自动切分数据，让集群存储更多的数据，具备更强的性能。在数据插入和更新时，能够自动路由和存储。"}]}]},{"ID":"20240201213526-zcyc507","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213526-zcyc507","updated":"20240201213526"},"Children":[{"ID":"20240201213527-9takolu","Type":"NodeParagraph","Properties":{"id":"20240201213527-9takolu","updated":"20240201213527"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"支持存储大文件"},{"Type":"NodeText","Data":"：MongoDB 的单文档存储空间要求不超过 16MB。对于超过 16MB 的大文件，MongoDB 提供了 GridFS 来进行存储，通过 GridFS，可以将大型数据进行分块处理，然后将这些切分后的小文档保存在数据库中。"}]}]}]},{"ID":"20240201213528-7f0yjgb","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213528-7f0yjgb","updated":"20240201213528"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 适合什么应用场景？"}]},{"ID":"20240201213529-4853o9o","Type":"NodeParagraph","Properties":{"id":"20240201213529-4853o9o","updated":"20240201213529"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"MongoDB 的优势在于其数据模型和存储引擎的灵活性、架构的可扩展性以及对强大的索引支持。"}]},{"ID":"20240201213530-z3wn5m5","Type":"NodeParagraph","Properties":{"id":"20240201213530-z3wn5m5","updated":"20240201213530"},"Children":[{"Type":"NodeText","Data":"选用 MongoDB 应该充分考虑 MongoDB 的优势，结合实际项目的需求来决定："}]},{"ID":"20240201213531-czl97t3","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213531-czl97t3","updated":"20240201213531"},"Children":[{"ID":"20240201213532-izxf5jn","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213532-izxf5jn","updated":"20240201213532"},"Children":[{"ID":"20240201213533-s9yncfy","Type":"NodeParagraph","Properties":{"id":"20240201213533-s9yncfy","updated":"20240201213533"},"Children":[{"Type":"NodeText","Data":"随着项目的发展，使用类 JSON 格式（BSON）保存数据是否满足项目需求？MongoDB 中的记录就是一个 BSON 文档，它是由键值对组成的数据结构，类似于 JSON 对象，是 MongoDB 中的基本数据单元。"}]}]},{"ID":"20240201213534-sorznjs","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213534-sorznjs","updated":"20240201213534"},"Children":[{"ID":"20240201213535-ie4fb9i","Type":"NodeParagraph","Properties":{"id":"20240201213535-ie4fb9i","updated":"20240201213535"},"Children":[{"Type":"NodeText","Data":"是否需要大数据量的存储？是否需要快速水平扩展？MongoDB 支持分片集群，可以很方便地添加更多的节点（实例），让集群存储更多的数据，具备更强的性能。"}]}]},{"ID":"20240201213536-4yon3ef","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213536-4yon3ef","updated":"20240201213536"},"Children":[{"ID":"20240201213537-bi9i6zj","Type":"NodeParagraph","Properties":{"id":"20240201213537-bi9i6zj","updated":"20240201213537"},"Children":[{"Type":"NodeText","Data":"是否需要更多类型索引来满足更多应用场景？MongoDB 支持多种类型的索引，包括单字段索引、复合索引、多键索引、哈希索引、文本索引、 地理位置索引等，每种类型的索引有不同的使用场合。"}]}]},{"ID":"20240201213538-q2mrs3l","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213538-q2mrs3l","updated":"20240201213538"},"Children":[{"ID":"20240201213539-r0q19jx","Type":"NodeParagraph","Properties":{"id":"20240201213539-r0q19jx","updated":"20240201213539"},"Children":[{"Type":"NodeText","Data":"……"}]}]}]},{"ID":"20240201213540-58wlyhx","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213540-58wlyhx","updated":"20240201213540"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 存储引擎"}]},{"ID":"20240201213541-vmsciko","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213541-vmsciko","updated":"20240201213541"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 支持哪些存储引擎？"}]},{"ID":"20240201213542-cuivka6","Type":"NodeParagraph","Properties":{"id":"20240201213542-cuivka6","updated":"20240201213542"},"Children":[{"Type":"NodeText","Data":"存储引擎（Storage Engine）是数据库的核心组件，负责管理数据在内存和磁盘中的存储方式。"}]},{"ID":"20240201213543-bbsk3aq","Type":"NodeParagraph","Properties":{"id":"20240201213543-bbsk3aq","updated":"20240201213543"},"Children":[{"Type":"NodeText","Data":"与 MySQL 一样，MongoDB 采用的也是 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"插件式的存储引擎架构"},{"Type":"NodeText","Data":" ，支持不同类型的存储引擎，不同的存储引擎解决不同场景的问题。在创建数据库或集合时，可以指定存储引擎。"}]},{"ID":"20240201213544-9tlrftp","Type":"NodeBlockquote","Properties":{"id":"20240201213544-9tlrftp","updated":"20240201213544"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213545-s594w11","Type":"NodeParagraph","Properties":{"id":"20240201213545-s594w11","updated":"20240201213545"},"Children":[{"Type":"NodeText","Data":"插件式的存储引擎架构可以实现 Server 层和存储引擎层的解耦，可以支持多种存储引擎，如 MySQL 既可以支持 B-Tree 结构的 InnoDB 存储引擎，还可以支持 LSM 结构的 RocksDB 存储引擎。"}]}]},{"ID":"20240201213546-x9m0ixt","Type":"NodeParagraph","Properties":{"id":"20240201213546-x9m0ixt","updated":"20240201213546"},"Children":[{"Type":"NodeText","Data":"在存储引擎刚出来的时候，默认是使用 MMAPV1 存储引擎，MongoDB4.x 版本不再支持 MMAPv1 存储引擎。"}]},{"ID":"20240201213547-9k7h349","Type":"NodeParagraph","Properties":{"id":"20240201213547-9k7h349","updated":"20240201213547"},"Children":[{"Type":"NodeText","Data":"现在主要有下面这两种存储引擎："}]},{"ID":"20240201213548-sfbatv7","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213548-sfbatv7","updated":"20240201213548"},"Children":[{"ID":"20240201213549-ilnszn7","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213549-ilnszn7","updated":"20240201213549"},"Children":[{"ID":"20240201213550-8nwhuwa","Type":"NodeParagraph","Properties":{"id":"20240201213550-8nwhuwa","updated":"20240201213550"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"WiredTiger 存储引擎"},{"Type":"NodeText","Data":"：自 MongoDB 3.2 以后，默认的存储引擎为 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/core/wiredtiger/","TextMarkTextContent":"WiredTiger 存储引擎"},{"Type":"NodeText","Data":" 。非常适合大多数工作负载，建议用于新部署。WiredTiger 提供文档级并发模型、检查点和数据压缩（后文会介绍到）等功能。"}]}]},{"ID":"20240201213551-4h81c7f","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213551-4h81c7f","updated":"20240201213551"},"Children":[{"ID":"20240201213552-09mhmig","Type":"NodeParagraph","Properties":{"id":"20240201213552-09mhmig","updated":"20240201213552"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"In-Memory 存储引擎"},{"Type":"NodeText","Data":"："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/core/inmemory/","TextMarkTextContent":"In-Memory 存储引擎"},{"Type":"NodeText","Data":"在 MongoDB Enterprise 中可用。它不是将文档存储在磁盘上，而是将它们保留在内存中以获得更可预测的数据延迟。"}]}]}]},{"ID":"20240201213553-k7prcvb","Type":"NodeParagraph","Properties":{"id":"20240201213553-k7prcvb","updated":"20240201213553"},"Children":[{"Type":"NodeText","Data":"此外，MongoDB 3.0 提供了 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"可插拔的存储引擎 API"},{"Type":"NodeText","Data":" ，允许第三方为 MongoDB 开发存储引擎，这点和 MySQL 也比较类似。"}]},{"ID":"20240201213554-ixt9j5x","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213554-ixt9j5x","updated":"20240201213554"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"WiredTiger 基于 LSM Tree 还是 B+ Tree？"}]},{"ID":"20240201213555-jskq14j","Type":"NodeParagraph","Properties":{"id":"20240201213555-jskq14j","updated":"20240201213555"},"Children":[{"Type":"NodeText","Data":"目前绝大部分流行的数据库存储引擎都是基于 B/B+ Tree 或者 LSM(Log Structured Merge) Tree 来实现的。对于 NoSQL 数据库来说，绝大部分（比如 HBase、Cassandra、RocksDB）都是基于 LSM 树，MongoDB 不太一样。"}]},{"ID":"20240201213556-4jzry4i","Type":"NodeParagraph","Properties":{"id":"20240201213556-4jzry4i","updated":"20240201213556"},"Children":[{"Type":"NodeText","Data":"上面也说了，自 MongoDB 3.2 以后，默认的存储引擎为 WiredTiger 存储引擎。在 WiredTiger 引擎官网上，我们发现 WiredTiger 使用的是 B+ 树作为其存储结构："}]},{"ID":"20240201213557-jrwbt7v","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"cGxhaW4=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213557-jrwbt7v","updated":"20240201213557"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGxhaW4=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"WiredTiger maintains a table's data in memory using a data structure called a B-Tree ( B+ Tree to be specific), referring to the nodes of a B-Tree as pages. Internal pages carry only keys. The leaf pages store both keys and values.\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213558-su2xhku","Type":"NodeParagraph","Properties":{"id":"20240201213558-su2xhku","updated":"20240201213558"},"Children":[{"Type":"NodeText","Data":"此外，WiredTiger 还支持 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://source.wiredtiger.com/3.1.0/lsm.html","TextMarkTextContent":"LSM(Log Structured Merge)"},{"Type":"NodeText","Data":" 树作为存储结构，MongoDB 在使用 WiredTiger 作为存储引擎时，默认使用的是 B+ 树。"}]},{"ID":"20240201213559-l1eseb0","Type":"NodeParagraph","Properties":{"id":"20240201213559-l1eseb0","updated":"20240201213559"},"Children":[{"Type":"NodeText","Data":"如果想要了解 MongoDB 使用 B 树的原因，可以看看这篇文章："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://mp.weixin.qq.com/s/mMWdpbYRiT6LQcdaj4hgXQ","TextMarkTextContent":"为什么 MongoDB 使用 B 树？"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240201213560-s9n9vsd","Type":"NodeParagraph","Properties":{"id":"20240201213560-s9n9vsd","updated":"20240201213560"},"Children":[{"Type":"NodeText","Data":"使用 B+ 树时，WiredTiger 以 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"page"},{"Type":"NodeText","Data":" 为基本单位往磁盘读写数据。B+ 树的每个节点为一个 page，共有三种类型的 page："}]},{"ID":"20240201213561-j65pevp","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213561-j65pevp","updated":"20240201213561"},"Children":[{"ID":"20240201213562-qjt2qyv","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213562-qjt2qyv","updated":"20240201213562"},"Children":[{"ID":"20240201213563-ffyanlp","Type":"NodeParagraph","Properties":{"id":"20240201213563-ffyanlp","updated":"20240201213563"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"root page（根节点）"},{"Type":"NodeText","Data":"：B+ 树的根节点。"}]}]},{"ID":"20240201213564-ver2gqi","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213564-ver2gqi","updated":"20240201213564"},"Children":[{"ID":"20240201213565-iebcq6h","Type":"NodeParagraph","Properties":{"id":"20240201213565-iebcq6h","updated":"20240201213565"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"internal page（内部节点）"},{"Type":"NodeText","Data":"：不实际存储数据的中间索引节点。"}]}]},{"ID":"20240201213566-vs8adey","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213566-vs8adey","updated":"20240201213566"},"Children":[{"ID":"20240201213567-yclilom","Type":"NodeParagraph","Properties":{"id":"20240201213567-yclilom","updated":"20240201213567"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"leaf page（叶子节点）"},{"Type":"NodeText","Data":"：真正存储数据的叶子节点，包含一个页头（page header）、块头（block header）和真正的数据（key/value），其中页头定义了页的类型、页中实际载荷数据的大小、页中记录条数等信息；块头定义了此页的 checksum、块在磁盘上的寻址位置等信息。"}]}]}]},{"ID":"20240201213568-kjpvuye","Type":"NodeParagraph","Properties":{"id":"20240201213568-kjpvuye","updated":"20240201213568"},"Children":[{"Type":"NodeText","Data":"其整体结构如下图所示："}]},{"ID":"20240201213569-3d5fpdu","Type":"NodeParagraph","Properties":{"id":"20240201213569-3d5fpdu","updated":"20240201213569"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"WiredTiger B+树整体结构","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/database/mongodb/mongodb-b-plus-tree-integral-structure.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213570-s8yfi6i","Type":"NodeParagraph","Properties":{"id":"20240201213570-s8yfi6i","updated":"20240201213570"},"Children":[{"Type":"NodeText","Data":"如果想要深入研究学习 WiredTiger 存储引擎，推荐阅读 MongoDB 中文社区的 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://mongoing.com/archives/category/wiredtiger%e5%ad%98%e5%82%a8%e5%bc%95%e6%93%8e%e7%b3%bb%e5%88%97","TextMarkTextContent":"WiredTiger 存储引擎系列"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240201213571-bmi3frs","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213571-bmi3frs","updated":"20240201213571"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 聚合"}]},{"ID":"20240201213572-6fl2l53","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213572-6fl2l53","updated":"20240201213572"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 聚合有什么用？"}]},{"ID":"20240201213573-y9q0ib5","Type":"NodeParagraph","Properties":{"id":"20240201213573-y9q0ib5","updated":"20240201213573"},"Children":[{"Type":"NodeText","Data":"实际项目中，我们经常需要将多个文档甚至是多个集合汇总到一起计算分析（比如求和、取最大值）并返回计算后的结果，这个过程被称为 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"聚合操作"},{"Type":"NodeText","Data":" 。"}]},{"ID":"20240201213574-4c5jhcd","Type":"NodeParagraph","Properties":{"id":"20240201213574-4c5jhcd","updated":"20240201213574"},"Children":[{"Type":"NodeText","Data":"根据官方文档介绍，我们可以使用聚合操作来："}]},{"ID":"20240201213575-28rwr9u","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213575-28rwr9u","updated":"20240201213575"},"Children":[{"ID":"20240201213576-uswy6yp","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213576-uswy6yp","updated":"20240201213576"},"Children":[{"ID":"20240201213577-w8pj5in","Type":"NodeParagraph","Properties":{"id":"20240201213577-w8pj5in","updated":"20240201213577"},"Children":[{"Type":"NodeText","Data":"将来自多个文档的值组合在一起。"}]}]},{"ID":"20240201213578-5pm9dbu","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213578-5pm9dbu","updated":"20240201213578"},"Children":[{"ID":"20240201213579-63li9kn","Type":"NodeParagraph","Properties":{"id":"20240201213579-63li9kn","updated":"20240201213579"},"Children":[{"Type":"NodeText","Data":"对集合中的数据进行的一系列运算。"}]}]},{"ID":"20240201213580-1au12y2","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213580-1au12y2","updated":"20240201213580"},"Children":[{"ID":"20240201213581-hq109su","Type":"NodeParagraph","Properties":{"id":"20240201213581-hq109su","updated":"20240201213581"},"Children":[{"Type":"NodeText","Data":"分析数据随时间的变化。"}]}]}]},{"ID":"20240201213582-315kf7s","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240201213582-315kf7s","updated":"20240201213582"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 提供了哪几种执行聚合的方法？"}]},{"ID":"20240201213583-xw26hy8","Type":"NodeParagraph","Properties":{"id":"20240201213583-xw26hy8","updated":"20240201213583"},"Children":[{"Type":"NodeText","Data":"MongoDB 提供了两种执行聚合的方法："}]},{"ID":"20240201213584-szcbutt","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213584-szcbutt","updated":"20240201213584"},"Children":[{"ID":"20240201213585-q7c466h","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213585-q7c466h","updated":"20240201213585"},"Children":[{"ID":"20240201213586-hkwq0t8","Type":"NodeParagraph","Properties":{"id":"20240201213586-hkwq0t8","updated":"20240201213586"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"聚合管道（Aggregation Pipeline）"},{"Type":"NodeText","Data":"：执行聚合操作的首选方法。"}]}]},{"ID":"20240201213587-7y0p370","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213587-7y0p370","updated":"20240201213587"},"Children":[{"ID":"20240201213588-rzzbgb5","Type":"NodeParagraph","Properties":{"id":"20240201213588-rzzbgb5","updated":"20240201213588"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"单一目的聚合方法（Single purpose aggregation methods）"},{"Type":"NodeText","Data":"：也就是单一作用的聚合函数比如 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"count()"},{"Type":"NodeText","Data":"、"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"distinct()"},{"Type":"NodeText","Data":"、"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"estimatedDocumentCount()"},{"Type":"NodeText","Data":"。"}]}]}]},{"ID":"20240201213589-ncg0en8","Type":"NodeParagraph","Properties":{"id":"20240201213589-ncg0en8","updated":"20240201213589"},"Children":[{"Type":"NodeText","Data":"绝大部分文章中还提到了 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"map-reduce"},{"Type":"NodeText","Data":" 这种聚合方法。不过，从 MongoDB 5.0 开始，map-reduce 已经不被官方推荐使用了，替代方案是 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/core/aggregation-pipeline/","TextMarkTextContent":"聚合管道"},{"Type":"NodeText","Data":"。聚合管道提供比 map-reduce 更好的性能和可用性。"}]},{"ID":"20240201213590-g87louw","Type":"NodeParagraph","Properties":{"id":"20240201213590-g87louw","updated":"20240201213590"},"Children":[{"Type":"NodeText","Data":"MongoDB 聚合管道由多个阶段组成，每个阶段在文档通过管道时转换文档。每个阶段接收前一个阶段的输出，进一步处理数据，并将其作为输入数据发送到下一个阶段。"}]},{"ID":"20240201213591-sehkqry","Type":"NodeParagraph","Properties":{"id":"20240201213591-sehkqry","updated":"20240201213591"},"Children":[{"Type":"NodeText","Data":"每个管道的工作流程是："}]},{"ID":"20240201213592-bkl68uk","Type":"NodeList","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213592-bkl68uk","updated":"20240201213592"},"Children":[{"ID":"20240201213593-elwwcr3","Type":"NodeListItem","Data":"1","ListData":{"Typ":1,"Tight":true,"Start":1,"Delimiter":46,"Padding":3,"Marker":"MQ==","Num":1},"Properties":{"id":"20240201213593-elwwcr3","updated":"20240201213593"},"Children":[{"ID":"20240201213594-nmcqrfg","Type":"NodeParagraph","Properties":{"id":"20240201213594-nmcqrfg","updated":"20240201213594"},"Children":[{"Type":"NodeText","Data":"接受一系列原始数据文档"}]}]},{"ID":"20240201213595-kx9pxi5","Type":"NodeListItem","Data":"2","ListData":{"Typ":1,"Tight":true,"Start":2,"Delimiter":46,"Padding":3,"Marker":"Mg==","Num":2},"Properties":{"id":"20240201213595-kx9pxi5","updated":"20240201213595"},"Children":[{"ID":"20240201213596-6uj835h","Type":"NodeParagraph","Properties":{"id":"20240201213596-6uj835h","updated":"20240201213596"},"Children":[{"Type":"NodeText","Data":"对这些文档进行一系列运算"}]}]},{"ID":"20240201213597-x9z8ecy","Type":"NodeListItem","Data":"3","ListData":{"Typ":1,"Tight":true,"Start":3,"Delimiter":46,"Padding":3,"Marker":"Mw==","Num":3},"Properties":{"id":"20240201213597-x9z8ecy","updated":"20240201213597"},"Children":[{"ID":"20240201213598-xzzop10","Type":"NodeParagraph","Properties":{"id":"20240201213598-xzzop10","updated":"20240201213598"},"Children":[{"Type":"NodeText","Data":"结果文档输出给下一个阶段"}]}]}]},{"ID":"20240201213599-p48x9d4","Type":"NodeParagraph","Properties":{"id":"20240201213599-p48x9d4","updated":"20240201213599"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"管道的工作流程","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://oss.javaguide.cn/github/javaguide/database/mongodb/mongodb-aggregation-stage.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20240201213600-qwb6r1n","Type":"NodeParagraph","Properties":{"id":"20240201213600-qwb6r1n","updated":"20240201213600"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"常用阶段操作符"},{"Type":"NodeText","Data":"："}]},{"ID":"20240201213601-8s7zpd8","Type":"NodeTable","Data":"| 操作符    | 简述                                                                                                 |\n| --------- | ---------------------------------------------------------------------------------------------------- |\n| \\$match   | 匹配操作符，用于对文档集合进行筛选                                                                   |\n| \\$project | 投射操作符，用于重构每一个文档的字段，可以提取字段，重命名字段，甚至可以对原有字段进行操作后新增字段 |\n| \\$sort    | 排序操作符，用于根据一个或多个字段对文档进行排序                                                     |\n| \\$limit   | 限制操作符，用于限制返回文档的数量                                                                   |\n| \\$skip    | 跳过操作符，用于跳过指定数量的文档                                                                   |\n| \\$count   | 统计操作符，用于统计文档的数量                                                                       |\n| \\$group   | 分组操作符，用于对文档集合进行分组                                                                   |\n| \\$unwind  | 拆分操作符，用于将数组中的每一个值拆分为单独的文档                                                   |\n| \\$lookup  | 连接操作符，用于连接同一个数据库中另一个集合，并获取指定的文档，类似于 populate                      |","TableAligns":[0,0],"Properties":{"id":"20240201213601-8s7zpd8","updated":"20240201213601"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"操作符"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"简述"}]}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"match"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"匹配操作符，用于对文档集合进行筛选"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"project"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"投射操作符，用于重构每一个文档的字段，可以提取字段，重命名字段，甚至可以对原有字段进行操作后新增字段"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"sort"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"排序操作符，用于根据一个或多个字段对文档进行排序"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"limit"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"限制操作符，用于限制返回文档的数量"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"skip"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"跳过操作符，用于跳过指定数量的文档"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"count"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"统计操作符，用于统计文档的数量"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"group"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"分组操作符，用于对文档集合进行分组"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"unwind"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"拆分操作符，用于将数组中的每一个值拆分为单独的文档"}]}]},{"Type":"NodeTableRow","TableAligns":[0,0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"$","Properties":{"id":""}}]},{"Type":"NodeText","Data":"lookup"}]},{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"连接操作符，用于连接同一个数据库中另一个集合，并获取指定的文档，类似于 populate"}]}]}]},{"ID":"20240201213602-livbmzd","Type":"NodeParagraph","Properties":{"id":"20240201213602-livbmzd","updated":"20240201213602"},"Children":[{"Type":"NodeText","Data":"更多操作符介绍详见官方文档："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://docs.mongodb.com/manual/reference/operator/aggregation/","TextMarkTextContent":"https://docs.mongodb.com/manual/reference/operator/aggregation/"}]},{"ID":"20240201213603-souc33n","Type":"NodeParagraph","Properties":{"id":"20240201213603-souc33n","updated":"20240201213603"},"Children":[{"Type":"NodeText","Data":"阶段操作符用于 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"db.collection.aggregate"},{"Type":"NodeText","Data":" 方法里面，数组参数中的第一层。"}]},{"ID":"20240201213604-hf0kdel","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213604-hf0kdel","updated":"20240201213604"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"db.collection.aggregate( [ { 阶段操作符：表述 }, { 阶段操作符：表述 }, ... ] )\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213605-3878lst","Type":"NodeParagraph","Properties":{"id":"20240201213605-3878lst","updated":"20240201213605"},"Children":[{"Type":"NodeText","Data":"下面是 MongoDB 官方文档中的一个例子："}]},{"ID":"20240201213606-7d5g5vc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c3Fs","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240201213606-7d5g5vc","updated":"20240201213606"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c3Fs","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"db.orders.aggregate([\n   # 第一阶段：$match阶段按status字段过滤文档，并将status等于\"A\"的文档传递到下一阶段。\n    { $match: { status: \"A\" } },\n  # 第二阶段：$group阶段按cust_id字段将文档分组，以计算每个cust_id唯一值的金额总和。\n    { $group: { _id: \"$cust_id\", total: { $sum: \"$amount\" } } }\n])\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240201213607-djlf1nz","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213607-djlf1nz","updated":"20240201213607"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 事务"}]},{"ID":"20240201213608-ezx8mhj","Type":"NodeBlockquote","Properties":{"id":"20240201213608-ezx8mhj","updated":"20240201213608"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213609-singgu2","Type":"NodeParagraph","Properties":{"id":"20240201213609-singgu2","updated":"20240201213609"},"Children":[{"Type":"NodeText","Data":"MongoDB 事务想要搞懂原理还是比较花费时间的，我自己也没有搞太明白。因此，我这里只是简单介绍一下 MongoDB 事务，想要了解原理的小伙伴，可以自行搜索查阅相关资料。"}]},{"ID":"20240201213610-5evz7yz","Type":"NodeParagraph","Properties":{"id":"20240201213610-5evz7yz","updated":"20240201213610"},"Children":[{"Type":"NodeText","Data":"这里推荐几篇文章，供大家参考："}]},{"ID":"20240201213611-0nbfji5","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213611-0nbfji5","updated":"20240201213611"},"Children":[{"ID":"20240201213612-wokltg7","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213612-wokltg7","updated":"20240201213612"},"Children":[{"ID":"20240201213613-sfgaurx","Type":"NodeParagraph","Properties":{"id":"20240201213613-sfgaurx","updated":"20240201213613"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://mongoing.com/archives/82187","TextMarkTextContent":"技术干货| MongoDB 事务原理"}]}]},{"ID":"20240201213614-iy6osnf","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213614-iy6osnf","updated":"20240201213614"},"Children":[{"ID":"20240201213615-0xl48s3","Type":"NodeParagraph","Properties":{"id":"20240201213615-0xl48s3","updated":"20240201213615"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://developer.aliyun.com/article/782494","TextMarkTextContent":"MongoDB 一致性模型设计与实现"}]}]},{"ID":"20240201213616-rikjj8h","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213616-rikjj8h","updated":"20240201213616"},"Children":[{"ID":"20240201213617-siym9dz","Type":"NodeParagraph","Properties":{"id":"20240201213617-siym9dz","updated":"20240201213617"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/upcoming/core/transactions/","TextMarkTextContent":"MongoDB 官方文档对事务的介绍"}]}]}]}]},{"ID":"20240201213618-h2y2jtd","Type":"NodeParagraph","Properties":{"id":"20240201213618-h2y2jtd","updated":"20240201213618"},"Children":[{"Type":"NodeText","Data":"我们在介绍 NoSQL 数据的时候也说过，NoSQL 数据库通常不支持事务，为了可扩展和高性能进行了权衡。不过，也有例外，MongoDB 就支持事务。"}]},{"ID":"20240201213619-pwqbgx2","Type":"NodeParagraph","Properties":{"id":"20240201213619-pwqbgx2","updated":"20240201213619"},"Children":[{"Type":"NodeText","Data":"与关系型数据库一样，MongoDB 事务同样具有 ACID 特性："}]},{"ID":"20240201213620-ljjmdr8","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213620-ljjmdr8","updated":"20240201213620"},"Children":[{"ID":"20240201213621-k7zaefc","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213621-k7zaefc","updated":"20240201213621"},"Children":[{"ID":"20240201213622-81jmptc","Type":"NodeParagraph","Properties":{"id":"20240201213622-81jmptc","updated":"20240201213622"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"原子性"},{"Type":"NodeText","Data":"（"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Atomicity"},{"Type":"NodeText","Data":"）：事务是最小的执行单位，不允许分割。事务的原子性确保动作要么全部完成，要么完全不起作用；"}]}]},{"ID":"20240201213623-6dmvzb2","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213623-6dmvzb2","updated":"20240201213623"},"Children":[{"ID":"20240201213624-pg99wna","Type":"NodeParagraph","Properties":{"id":"20240201213624-pg99wna","updated":"20240201213624"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"一致性"},{"Type":"NodeText","Data":"（"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Consistency"},{"Type":"NodeText","Data":"）：执行事务前后，数据保持一致，例如转账业务中，无论事务是否成功，转账者和收款人的总额应该是不变的；"}]}]},{"ID":"20240201213625-tivjsaf","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213625-tivjsaf","updated":"20240201213625"},"Children":[{"ID":"20240201213626-o60yqjf","Type":"NodeParagraph","Properties":{"id":"20240201213626-o60yqjf","updated":"20240201213626"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"隔离性"},{"Type":"NodeText","Data":"（"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Isolation"},{"Type":"NodeText","Data":"）：并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的。WiredTiger 存储引擎支持读未提交（ read-uncommitted ）、读已提交（ read-committed ）和快照（ snapshot ）隔离，MongoDB 启动时默认选快照隔离。在不同隔离级别下，一个事务的生命周期内，可能出现脏读、不可重复读、幻读等现象。"}]}]},{"ID":"20240201213627-eanikci","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213627-eanikci","updated":"20240201213627"},"Children":[{"ID":"20240201213628-le4q85t","Type":"NodeParagraph","Properties":{"id":"20240201213628-le4q85t","updated":"20240201213628"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"持久性"},{"Type":"NodeText","Data":"（"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Durability"},{"Type":"NodeText","Data":"）：一个事务被提交之后。它对数据库中数据的改变是持久的，即使数据库发生故障也不应该对其有任何影响。"}]}]}]},{"ID":"20240201213629-ouy2kwd","Type":"NodeParagraph","Properties":{"id":"20240201213629-ouy2kwd","updated":"20240201213629"},"Children":[{"Type":"NodeText","Data":"关于事务的详细介绍这篇文章就不多说了，感兴趣的可以看看我写的"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"../mysql/mysql-questions-01.md","TextMarkTextContent":"MySQL 常见面试题总结"},{"Type":"NodeText","Data":"这篇文章，里面有详细介绍到。"}]},{"ID":"20240201213630-rpr17ry","Type":"NodeParagraph","Properties":{"id":"20240201213630-rpr17ry","updated":"20240201213630"},"Children":[{"Type":"NodeText","Data":"MongoDB 单文档原生支持原子性，也具备事务的特性。当谈论 MongoDB 事务的时候，通常指的是 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"多文档"},{"Type":"NodeText","Data":" 。MongoDB 4.0 加入了对多文档 ACID 事务的支持，但只支持复制集部署模式下的 ACID 事务，也就是说事务的作用域限制为一个副本集内。MongoDB 4.2 引入了 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"分布式事务"},{"Type":"NodeText","Data":" ，增加了对分片集群上多文档事务的支持，并合并了对副本集上多文档事务的现有支持。"}]},{"ID":"20240201213631-2iqqnsw","Type":"NodeParagraph","Properties":{"id":"20240201213631-2iqqnsw","updated":"20240201213631"},"Children":[{"Type":"NodeText","Data":"根据官方文档介绍："}]},{"ID":"20240201213632-dfyn4v3","Type":"NodeBlockquote","Properties":{"id":"20240201213632-dfyn4v3","updated":"20240201213632"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20240201213633-fdkubf6","Type":"NodeParagraph","Properties":{"id":"20240201213633-fdkubf6","updated":"20240201213633"},"Children":[{"Type":"NodeText","Data":"从 MongoDB 4.2 开始，分布式事务和多文档事务在 MongoDB 中是一个意思。分布式事务是指分片集群和副本集上的多文档事务。从 MongoDB 4.2 开始，多文档事务（无论是在分片集群还是副本集上）也称为分布式事务。"}]}]},{"ID":"20240201213634-x520c0r","Type":"NodeParagraph","Properties":{"id":"20240201213634-x520c0r","updated":"20240201213634"},"Children":[{"Type":"NodeText","Data":"在大多数情况下，多文档事务比单文档写入会产生更大的性能成本。对于大部分场景来说， "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/upcoming/core/data-model-design/#std-label-data-modeling-embedding","TextMarkTextContent":"非规范化数据模型（嵌入式文档和数组）"},{"Type":"NodeText","Data":" 依然是最佳选择。也就是说，适当地对数据进行建模可以最大限度地减少对多文档事务的需求。"}]},{"ID":"20240201213635-obiahd8","Type":"NodeParagraph","Properties":{"id":"20240201213635-obiahd8","updated":"20240201213635"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"注意"},{"Type":"NodeText","Data":"："}]},{"ID":"20240201213636-qs5msrb","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213636-qs5msrb","updated":"20240201213636"},"Children":[{"ID":"20240201213637-jm0b5cn","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213637-jm0b5cn","updated":"20240201213637"},"Children":[{"ID":"20240201213638-4wqbf43","Type":"NodeParagraph","Properties":{"id":"20240201213638-4wqbf43","updated":"20240201213638"},"Children":[{"Type":"NodeText","Data":"从 MongoDB 4.2 开始，多文档事务支持副本集和分片集群，其中：主节点使用 WiredTiger 存储引擎，同时从节点使用 WiredTiger 存储引擎或 In-Memory 存储引擎。在 MongoDB 4.0 中，只有使用 WiredTiger 存储引擎的副本集支持事务。"}]}]},{"ID":"20240201213639-2j4uyc0","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213639-2j4uyc0","updated":"20240201213639"},"Children":[{"ID":"20240201213640-opq17lw","Type":"NodeParagraph","Properties":{"id":"20240201213640-opq17lw","updated":"20240201213640"},"Children":[{"Type":"NodeText","Data":"在 MongoDB 4.2 及更早版本中，你无法在事务中创建集合。从 MongoDB 4.4 开始，您可以在事务中创建集合和索引。有关详细信息，请参阅 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/upcoming/core/transactions/#std-label-transactions-create-collections-indexes","TextMarkTextContent":"在事务中创建集合和索引"},{"Type":"NodeText","Data":"。"}]}]}]},{"ID":"20240201213641-lx47a8v","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213641-lx47a8v","updated":"20240201213641"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"MongoDB 数据压缩"}]},{"ID":"20240201213642-i51ndyd","Type":"NodeParagraph","Properties":{"id":"20240201213642-i51ndyd","updated":"20240201213642"},"Children":[{"Type":"NodeText","Data":"借助 WiredTiger 存储引擎（ MongoDB 3.2 后的默认存储引擎），MongoDB 支持对所有集合和索引进行压缩。压缩以额外的 CPU 为代价最大限度地减少存储使用。"}]},{"ID":"20240201213643-7x5e14j","Type":"NodeParagraph","Properties":{"id":"20240201213643-7x5e14j","updated":"20240201213643"},"Children":[{"Type":"NodeText","Data":"默认情况下，WiredTiger 使用 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/google/snappy","TextMarkTextContent":"Snappy"},{"Type":"NodeText","Data":" 压缩算法（谷歌开源，旨在实现非常高的速度和合理的压缩，压缩比 3 ～ 5 倍）对所有集合使用块压缩，对所有索引使用前缀压缩。"}]},{"ID":"20240201213644-6a76nre","Type":"NodeParagraph","Properties":{"id":"20240201213644-6a76nre","updated":"20240201213644"},"Children":[{"Type":"NodeText","Data":"除了 Snappy 之外，对于集合还有下面这些压缩算法："}]},{"ID":"20240201213645-zgs75m3","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213645-zgs75m3","updated":"20240201213645"},"Children":[{"ID":"20240201213646-x15h7mf","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213646-x15h7mf","updated":"20240201213646"},"Children":[{"ID":"20240201213647-seyr67g","Type":"NodeParagraph","Properties":{"id":"20240201213647-seyr67g","updated":"20240201213647"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/madler/zlib","TextMarkTextContent":"zlib"},{"Type":"NodeText","Data":"：高度压缩算法，压缩比 5 ～ 7 倍"}]}]},{"ID":"20240201213648-3eshbac","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213648-3eshbac","updated":"20240201213648"},"Children":[{"ID":"20240201213649-p6s4sk4","Type":"NodeParagraph","Properties":{"id":"20240201213649-p6s4sk4","updated":"20240201213649"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/facebook/zstd","TextMarkTextContent":"Zstandard"},{"Type":"NodeText","Data":"（简称 zstd）：Facebook 开源的一种快速无损压缩算法，针对 zlib 级别的实时压缩场景和更好的压缩比，提供更高的压缩率和更低的 CPU 使用率，MongoDB 4.2 开始可用。"}]}]}]},{"ID":"20240201213650-54pqf49","Type":"NodeParagraph","Properties":{"id":"20240201213650-54pqf49","updated":"20240201213650"},"Children":[{"Type":"NodeText","Data":"WiredTiger 日志也会被压缩，默认使用的也是 Snappy 压缩算法。如果日志记录小于或等于 128 字节，WiredTiger 不会压缩该记录。"}]},{"ID":"20240201213651-exr22pb","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201213651-exr22pb","updated":"20240201213651"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"参考"}]},{"ID":"20240201213652-ayxm2tf","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213652-ayxm2tf","updated":"20240201213652"},"Children":[{"ID":"20240201213653-hfq8hbh","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213653-hfq8hbh","updated":"20240201213653"},"Children":[{"ID":"20240201213654-slwy0jt","Type":"NodeParagraph","Properties":{"id":"20240201213654-slwy0jt","updated":"20240201213654"},"Children":[{"Type":"NodeText","Data":"MongoDB 官方文档（主要参考资料，以官方文档为准）："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/","TextMarkTextContent":"https://www.mongodb.com/docs/manual/"}]}]},{"ID":"20240201213655-mjk7ohk","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213655-mjk7ohk","updated":"20240201213655"},"Children":[{"ID":"20240201213656-n4e6acy","Type":"NodeParagraph","Properties":{"id":"20240201213656-n4e6acy","updated":"20240201213656"},"Children":[{"Type":"NodeText","Data":"《MongoDB 权威指南》"}]}]},{"ID":"20240201213657-mo7frv6","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213657-mo7frv6","updated":"20240201213657"},"Children":[{"ID":"20240201213658-d6b8eu8","Type":"NodeParagraph","Properties":{"id":"20240201213658-d6b8eu8","updated":"20240201213658"},"Children":[{"Type":"NodeText","Data":"技术干货| MongoDB 事务原理 - MongoDB 中文社区："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://mongoing.com/archives/82187","TextMarkTextContent":"https://mongoing.com/archives/82187"}]}]},{"ID":"20240201213659-ccbh6fn","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213659-ccbh6fn","updated":"20240201213659"},"Children":[{"ID":"20240201213660-hx8b9af","Type":"NodeParagraph","Properties":{"id":"20240201213660-hx8b9af","updated":"20240201213660"},"Children":[{"Type":"NodeText","Data":"Transactions - MongoDB 官方文档："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/core/transactions/","TextMarkTextContent":"https://www.mongodb.com/docs/manual/core/transactions/"}]}]},{"ID":"20240201213661-jbq492b","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213661-jbq492b","updated":"20240201213661"},"Children":[{"ID":"20240201213662-4f4vjv1","Type":"NodeParagraph","Properties":{"id":"20240201213662-4f4vjv1","updated":"20240201213662"},"Children":[{"Type":"NodeText","Data":"WiredTiger Storage Engine - MongoDB 官方文档："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://www.mongodb.com/docs/manual/core/wiredtiger/","TextMarkTextContent":"https://www.mongodb.com/docs/manual/core/wiredtiger/"}]}]},{"ID":"20240201213663-rkmyrpo","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240201213663-rkmyrpo","updated":"20240201213663"},"Children":[{"ID":"20240201213664-prqs6ma","Type":"NodeParagraph","Properties":{"id":"20240201213664-prqs6ma","updated":"20240201213664"},"Children":[{"Type":"NodeText","Data":"WiredTiger 存储引擎之一：基础数据结构分析："},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://mongoing.com/topic/archives-35143","TextMarkTextContent":"https://mongoing.com/topic/archives-35143"}]}]}]},{"ID":"20240201213665-h5jfrf8","Type":"NodeHTMLBlock","Data":"\u003cdiv\u003e\n\u003c!-- @include: @article-footer.snippet.md --\u003e\n\u003c/div\u003e","HtmlBlockType":2,"Properties":{"id":"20240201213665-h5jfrf8","updated":"20240201213665"}}]}