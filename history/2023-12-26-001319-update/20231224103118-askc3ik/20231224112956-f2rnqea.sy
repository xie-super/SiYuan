{"ID":"20231224112956-f2rnqea","Spec":"1","Type":"NodeDocument","Properties":{"id":"20231224112956-f2rnqea","title":"The State Pattern（状态模式）","updated":"20231226001218"},"Children":[{"ID":"20231224113022-1ezi2j6","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231224113022-1ezi2j6","updated":"20231226000829"},"Children":[{"Type":"NodeText","Data":"范例：自动糖果售卖机"}]},{"ID":"20231224113022-nnoltjy","Type":"NodeParagraph","Properties":{"id":"20231224113022-nnoltjy","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c9154acd1ded47acbaaefe0a22fda57d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1088\u0026h=866\u0026s=408372\u0026e=png\u0026b=f9f9f9"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231226000947-txnhxgq","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231226000947-txnhxgq","updated":"20231226000949"},"Children":[{"Type":"NodeText","Data":"原先设计"}]},{"ID":"20231224113022-uztuyxu","Type":"NodeParagraph","Properties":{"id":"20231224113022-uztuyxu","updated":"20231226000947"},"Children":[{"Type":"NodeText","Data":"创建一个实例变量来保存当前状态，并为每个状态定义值"}]},{"ID":"20231224113022-w8f7n0b","Type":"NodeParagraph","Properties":{"id":"20231224113022-w8f7n0b","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eb2294a43aac4203ac3e850a54166b4e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1120\u0026h=452\u0026s=183497\u0026e=png\u0026b=fffefe"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231226001107-hmxb16t","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20231226001107-hmxb16t","updated":"20231226001117"},"Children":[{"Type":"NodeText","Data":"代码逻辑"}]},{"ID":"20231226001133-939z4pg","Type":"NodeList","ListData":{},"Properties":{"id":"20231226001133-939z4pg","updated":"20231226001218"},"Children":[{"ID":"20231226001134-47jrtlq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231226001134-47jrtlq","updated":"20231226001218"},"Children":[{"ID":"20231226001134-gpyburr","Type":"NodeParagraph","Properties":{"id":"20231226001134-gpyburr","updated":"20231226001156"},"Children":[{"Type":"NodeText","Data":"insertQuarter事件"}]},{"ID":"20231226001156-o3i7bd8","Type":"NodeList","ListData":{},"Properties":{"id":"20231226001156-o3i7bd8","updated":"20231226001218"},"Children":[{"ID":"20231226001159-guhti7d","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231226001159-guhti7d","updated":"20231226001218"},"Children":[{"ID":"20231226001159-gch9rw0","Type":"NodeParagraph","Properties":{"id":"20231226001159-gch9rw0","updated":"20231226001218"},"Children":[{"Type":"NodeText","Data":"当前状态是 HAS_QUARTER-\u003e"}]}]}]}]}]},{"ID":"20231224113022-lwui1dj","Type":"NodeParagraph","Properties":{"id":"20231224113022-lwui1dj","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"通过在对象内部创建一个实例变量来存储状态值，并在方法中编写条件代码来处理各种状态。"}]},{"ID":"20231224113022-qyejwbf","Type":"NodeParagraph","Properties":{"id":"20231224113022-qyejwbf","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"新加入一个 winner状态"}]},{"ID":"20231224113022-jciuxxe","Type":"NodeParagraph","Properties":{"id":"20231224113022-jciuxxe","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/02969ae6897b49d4b71c607db9cd5c34~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=680\u0026h=688\u0026s=207534\u0026e=png\u0026b=f5f5f5"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231224113022-nmao9at","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231224113022-nmao9at","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"设计"}]},{"ID":"20231224113022-c3c014c","Type":"NodeParagraph","Properties":{"id":"20231224113022-c3c014c","updated":"20231224113022"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"首先定义抽象状态(State）"}]},{"ID":"20231224113022-kni8x75","Type":"NodeList","ListData":{},"Properties":{"id":"20231224113022-kni8x75","updated":"20231224113022"},"Children":[{"ID":"20231224113022-smiq9wb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-smiq9wb","updated":"20231224113022"},"Children":[{"ID":"20231224113022-qg0v8fp","Type":"NodeParagraph","Properties":{"id":"20231224113022-qg0v8fp","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"抽象状态是一个接口或抽象类，定义了具体状态类需要实现的方法。"}]}]},{"ID":"20231224113022-ab38288","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-ab38288","updated":"20231224113022"},"Children":[{"ID":"20231224113022-zikvmy5","Type":"NodeParagraph","Properties":{"id":"20231224113022-zikvmy5","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"这个接口或抽象类通常包含了处理请求的方法，以及可以切换到其他状态的方法。"}]}]}]},{"ID":"20231224113022-6w9njps","Type":"NodeParagraph","Properties":{"id":"20231224113022-6w9njps","updated":"20231224113022"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"定义上下文(Context)"}]},{"ID":"20231224113022-6h4rn7l","Type":"NodeList","ListData":{},"Properties":{"id":"20231224113022-6h4rn7l","updated":"20231224113022"},"Children":[{"ID":"20231224113022-pe4j4u0","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-pe4j4u0","updated":"20231224113022"},"Children":[{"ID":"20231224113022-al1vk0d","Type":"NodeParagraph","Properties":{"id":"20231224113022-al1vk0d","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"上下文是拥有某个状态的对象，可以维护一个对抽象状态的引用，并根据状态的变化而改变行为。"}]}]},{"ID":"20231224113022-5kr6q82","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-5kr6q82","updated":"20231224113022"},"Children":[{"ID":"20231224113022-ufb93p4","Type":"NodeParagraph","Properties":{"id":"20231224113022-ufb93p4","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"上下文可以在运行时动态地改变其状态，从而改变其行为。\n​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f48775dd9c944a8e941294fa94db73f2~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1104\u0026h=704\u0026s=433653\u0026e=png\u0026b=fdfcfc"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20231224113022-coejeeb","Type":"NodeParagraph","Properties":{"id":"20231224113022-coejeeb","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a63ca7f48f3d432b85234c360d1769e4~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1122\u0026h=848\u0026s=235444\u0026e=png\u0026b=ffffff"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231224113022-wbq1bxc","Type":"NodeParagraph","Properties":{"id":"20231224113022-wbq1bxc","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c8a43eb5a91e43078015fe2505865ef7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1116\u0026h=700\u0026s=200912\u0026e=png\u0026b=fffefe"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"具体状态（Concrete State）："}]},{"ID":"20231224113022-496a8kf","Type":"NodeList","ListData":{},"Properties":{"id":"20231224113022-496a8kf","updated":"20231224113022"},"Children":[{"ID":"20231224113022-lan3w92","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-lan3w92","updated":"20231224113022"},"Children":[{"ID":"20231224113022-9olt1hw","Type":"NodeParagraph","Properties":{"id":"20231224113022-9olt1hw","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"具体状态是抽象状态的具体实现，对应于上下文的不同状态。"}]}]},{"ID":"20231224113022-14tprhy","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-14tprhy","updated":"20231224113022"},"Children":[{"ID":"20231224113022-t3nzb9s","Type":"NodeParagraph","Properties":{"id":"20231224113022-t3nzb9s","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"每个具体状态类负责定义在其状态下的具体行为和处理方式。\n下面是SoldState具体状态"}]}]}]},{"ID":"20231224113022-pty6d82","Type":"NodeParagraph","Properties":{"id":"20231224113022-pty6d82","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/afccae91f57647ec836cb79b0c6916bf~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1102\u0026h=834\u0026s=187475\u0026e=png\u0026b=ffffff"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231224113022-47nmn1k","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231224113022-47nmn1k","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"模式定义"}]},{"ID":"20231224113022-avrf2hk","Type":"NodeParagraph","Properties":{"id":"20231224113022-avrf2hk","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fdf9783350ea4ceb9d97832e13f2d5b4~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1502\u0026h=942\u0026s=270670\u0026e=png\u0026b=fefefe"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231224113022-xxq64vv","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231224113022-xxq64vv","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"与策略模式关系"}]},{"ID":"20231224113022-z8aetnx","Type":"NodeList","ListData":{},"Properties":{"id":"20231224113022-z8aetnx","updated":"20231224113022"},"Children":[{"ID":"20231224113022-fgbsmbd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-fgbsmbd","updated":"20231224113022"},"Children":[{"ID":"20231224113022-qmzyc1v","Type":"NodeParagraph","Properties":{"id":"20231224113022-qmzyc1v","updated":"20231224113022"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"相似性："},{"Type":"NodeText","Data":" 两者都涉及到将特定的行为封装起来，使得行为可以相互替换。"}]}]},{"ID":"20231224113022-wyvmgzw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-wyvmgzw","updated":"20231224113022"},"Children":[{"ID":"20231224113022-dunt5m6","Type":"NodeParagraph","Properties":{"id":"20231224113022-dunt5m6","updated":"20231224113022"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"差异性："}]},{"ID":"20231224113022-vwx7vql","Type":"NodeList","ListData":{},"Properties":{"id":"20231224113022-vwx7vql","updated":"20231224113022"},"Children":[{"ID":"20231224113022-aeari12","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-aeari12","updated":"20231224113022"},"Children":[{"ID":"20231224113022-hr3nh14","Type":"NodeParagraph","Properties":{"id":"20231224113022-hr3nh14","updated":"20231224113022"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"使用方式不同："},{"Type":"NodeText","Data":" 在策略模式中，客户端通常选择具体的策略对象，而在状态模式中，上下文的状态是在内部管理的，客户端对状态对象了解较少。\n​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"状态模式，状态改变是在上下文中管理"},{"Type":"NodeText","Data":"​\n​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8b421b8115434e8e8e13e3d8be5c0ea1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1076\u0026h=640\u0026s=158255\u0026e=png\u0026b=ffffff"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]}]},{"ID":"20231224113022-9ahku0q","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-9ahku0q","updated":"20231224113022"},"Children":[{"ID":"20231224113022-ez3mrkr","Type":"NodeParagraph","Properties":{"id":"20231224113022-ez3mrkr","updated":"20231224113022"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"动态性："},{"Type":"NodeText","Data":" 策略模式允许在运行时动态更改策略对象，而状态模式是通过内部状态的变化来改变行为。"}]}]}]},{"ID":"20231224113022-mcuzuae","Type":"NodeParagraph","Properties":{"id":"20231224113022-mcuzuae","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/41da618654ca41cd97a34b3f461f103a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1398\u0026h=902\u0026s=806769\u0026e=png\u0026b=f7f7f7"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231224113022-etxfxnw","Type":"NodeList","ListData":{},"Properties":{"id":"20231224113022-etxfxnw","updated":"20231224113022"},"Children":[{"ID":"20231224113022-2qua490","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231224113022-2qua490","updated":"20231224113022"},"Children":[{"ID":"20231224113022-y1bgz8k","Type":"NodeParagraph","Properties":{"id":"20231224113022-y1bgz8k","updated":"20231224113022"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"选择标准："},{"Type":"NodeText","Data":" 策略模式适用于在不同情况下选择算法，而状态模式适用于对象在内部状态变化时改变行为。"}]}]}]},{"ID":"20231224113022-cyxjbcz","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231224113022-cyxjbcz","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"总结"}]},{"ID":"20231224113022-qbymfr7","Type":"NodeParagraph","Properties":{"id":"20231224113022-qbymfr7","updated":"20231224113022"},"Children":[{"Type":"NodeText","Data":"状态模式允许一个对象根据其内部状态拥有许多不同的行为。 • 与过程式状态机不同，状态模式将状态表示为一个完整的类。 • 上下文通过委托给其当前所组合的状态对象来获取其行为。 • 通过将每个状态封装成一个类，我们局部化了需要进行的任何更改。"}]}]}