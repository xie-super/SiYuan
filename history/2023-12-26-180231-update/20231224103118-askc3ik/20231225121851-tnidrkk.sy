{"ID":"20231225121851-tnidrkk","Spec":"1","Type":"NodeDocument","Properties":{"id":"20231225121851-tnidrkk","title":"Observer pattern（观察者模式）","updated":"20231226175856"},"Children":[{"ID":"20231225121854-5ih0naa","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231225121854-5ih0naa","updated":"20231226171205"},"Children":[{"Type":"NodeText","Data":"案例：气象观测站"}]},{"ID":"20231225121854-5x5okfg","Type":"NodeParagraph","Properties":{"id":"20231225121854-5x5okfg","updated":"20231226171434"},"Children":[{"Type":"NodeText","Data":"WeatherData对象，负责追踪温度、湿度和气压等数据。建立一个气象观测站，并且这个气象观测站暂时有三种布告板，分别显示：目前的状况、气象统计、简单的预报。当 WeatherData对象获得最新的测量数据时，三种布告板必须实时更新。"}]},{"ID":"20231225121854-e1j8z2z","Type":"NodeParagraph","Properties":{"id":"20231225121854-e1j8z2z","updated":"20231226171855"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 50%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/767f8935c4a84f3ea25b1b72aba5b820~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1512\u0026h=774\u0026s=450997\u0026e=png\u0026b=f8f8f8"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 50%;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20231226171541-jhmlr2z","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231226171541-jhmlr2z","updated":"20231226172035"},"Children":[{"Type":"NodeText","Data":"原实现代码"}]},{"ID":"20231226171602-jgr9ena","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231226171602-jgr9ena","updated":"20231226171631"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public class WeatherData{\n    //实例变量声明\n    public void measurementsChanged(){\n        //获取温度、湿度、气压数据\n        float temp=getTemperature();\n        float humidity=getHumidity();\n        float pressure=getPressure();\n        //调用update()更新布告板\n        currentConditionsDisplay.update(temp,humidity,pressure);\n        statisticsDisplay.update(temp,humidity,pressure);\n        forecastDisplay.update(temp,humidity,pressure);\n}\n    //其他WeatherData方法\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231226171637-k43ko5i","Type":"NodeParagraph","Properties":{"id":"20231226171637-k43ko5i","updated":"20231226171912"},"Children":[{"Type":"NodeText","Data":"从上面的代码可以明显看出：面向实现编程，以后增删布告板都要修改程序。"}]},{"ID":"20231226171951-q9yjumj","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231226171951-q9yjumj","updated":"20231226172056"},"Children":[{"Type":"NodeText","Data":"优化策略：观察者模式"}]},{"ID":"20231226172058-rx2rdjf","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20231226172058-rx2rdjf","updated":"20231226172134"},"Children":[{"Type":"NodeText","Data":"报纸的订阅业务"}]},{"ID":"20231226172131-p6ln2xb","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20231226172131-p6ln2xb","updated":"20231226172131"},"Children":[{"ID":"20231226172131-uqhu8r5","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20231226172131-uqhu8r5","updated":"20231226172131"},"Children":[{"ID":"20231226172131-36zz5dm","Type":"NodeParagraph","Properties":{"id":"20231226172131-36zz5dm","updated":"20231226172131"},"Children":[{"Type":"NodeText","Data":"报社的业务就是出版报纸；"}]}]},{"ID":"20231226172131-655n98p","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20231226172131-655n98p","updated":"20231226172131"},"Children":[{"ID":"20231226172131-kcwg77q","Type":"NodeParagraph","Properties":{"id":"20231226172131-kcwg77q","updated":"20231226172131"},"Children":[{"Type":"NodeText","Data":"向某家报社订阅报纸，只要他们有新报纸出版，就会给你送来。只要你是他们的订户，你就会一直收到新报纸；"}]}]},{"ID":"20231226172131-5t9jr7s","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20231226172131-5t9jr7s","updated":"20231226172131"},"Children":[{"ID":"20231226172131-b79h2n8","Type":"NodeParagraph","Properties":{"id":"20231226172131-b79h2n8","updated":"20231226172131"},"Children":[{"Type":"NodeText","Data":"当你不想再看报纸的时候，取消订阅，他们就不会再送新报来；"}]}]},{"ID":"20231226172131-dc4gw3b","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20231226172131-dc4gw3b","updated":"20231226172131"},"Children":[{"ID":"20231226172131-vkhkw3s","Type":"NodeParagraph","Properties":{"id":"20231226172131-vkhkw3s","updated":"20231226172131"},"Children":[{"Type":"NodeText","Data":"只要报社还在运营，就会有人向他们订阅报纸或取消订阅报纸。"}]}]}]},{"ID":"20231226172141-ht0a6xr","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20231226172141-ht0a6xr","updated":"20231226172150"},"Children":[{"Type":"NodeText","Data":"类比报纸订阅业务"}]},{"ID":"20231226172150-s76572i","Type":"NodeParagraph","Properties":{"id":"20231226172150-s76572i","updated":"20231226172207"},"Children":[{"Type":"NodeText","Data":"观察者模式与订阅报纸类似，出版者改称为“主题”（Subject），订阅者改称为“观察者”（Observer）。主题对象管理某些数据。当主题内的数据改变，就会通知观察者。已经订阅了主题的观察者会在主题数据发送改变时收到通知。如果观察者不想接收新的数据，可以取消订阅，之后主题数据改变时就不会收到通知。"}]},{"ID":"20231225121854-xjqv2qu","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20231225121854-xjqv2qu","updated":"20231226172522"},"Children":[{"Type":"NodeText","Data":"定义"}]},{"ID":"20231225121854-35neh12","Type":"NodeParagraph","Properties":{"id":"20231225121854-35neh12","updated":"20231226173115"},"Children":[{"Type":"NodeText","Data":"观察者模式定义了对象之间的一对多依赖关系，因此当一个对象改变状态时，所有依赖它的对象都会被通知并自动更新。\n​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 50%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/869fe47806ea428cbd704bebf6733361~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1294\u0026h=892\u0026s=202520\u0026e=png\u0026b=fefefe"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 50%;\"}"},{"Type":"NodeText","Data":"\n主题与观察者之间是松耦合关系，主题唯一依赖的东西是一个实现Observer接口的对象列表，可以随时增加或删除观察者。改变主题或者观察者一方，不会影响另一方。"}]},{"ID":"20231225121854-2ibk1dj","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20231225121854-2ibk1dj","updated":"20231226175308"},"Children":[{"Type":"NodeText","Data":"代码"}]},{"ID":"20231226175326-2u5o0cu","Type":"NodeParagraph","Properties":{"id":"20231226175326-2u5o0cu","updated":"20231226175835"},"Children":[{"Type":"NodeText","Data":"在这个例子中，我们将 WeatherData作为主题，三个布告板作为观察者（布告板根据主题中的三个属性update）"}]},{"ID":"20231226175240-05yngf4","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20231226175240-05yngf4","updated":"20231226175245"},"Children":[{"Type":"NodeText","Data":"对应的 UML 类图"}]},{"ID":"20231226175311-yuv9cl8","Type":"NodeParagraph","Properties":{"id":"20231226175311-yuv9cl8","updated":"20231226175315"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 50%;","style":"width: 10000px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20231226175311-0jqs0pr.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 10000px;\" parent-style=\"width: 50%;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20231226175852-w6ncpmo","Type":"NodeParagraph","Properties":{"id":"20231226175852-w6ncpmo","updated":"20231226175852"}},{"ID":"20231226175852-j3jorwz","Type":"NodeParagraph","Properties":{"id":"20231226175852-j3jorwz","updated":"20231226175852"}},{"ID":"20231226175852-t8b1gtq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231226175852-t8b1gtq","updated":"20231226175856"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231225121854-n1bp4yq","Type":"NodeParagraph","Properties":{"id":"20231225121854-n1bp4yq","updated":"20231226175240"},"Children":[{"Type":"NodeText","Data":"具体可观察对象"}]},{"ID":"20231225121854-hroh9yr","Type":"NodeParagraph","Properties":{"id":"20231225121854-hroh9yr","updated":"20231225121854"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bed692c09ab349bfa1496ab79ba463df~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=856\u0026h=768\u0026s=291133\u0026e=png\u0026b=fcfcfc"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231225121854-mlvnhyi","Type":"NodeParagraph","Properties":{"id":"20231225121854-mlvnhyi","updated":"20231225121854"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/21c974da989d4d2b9e9254b9bc807f10~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1738\u0026h=1050\u0026s=210878\u0026e=png\u0026b=fefdfd"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231225121854-3qsare0","Type":"NodeParagraph","Properties":{"id":"20231225121854-3qsare0","updated":"20231225121854"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image.png"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/61559169d13d4663bc0e6bebbf42412b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1644\u0026h=1368\u0026s=776706\u0026e=png\u0026b=fcfcfc"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}