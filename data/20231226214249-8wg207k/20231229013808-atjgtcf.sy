{"ID":"20231229013808-atjgtcf","Spec":"1","Type":"NodeDocument","Properties":{"id":"20231229013808-atjgtcf","title":"微信自动发送","updated":"20231229013824"},"Children":[{"ID":"20231229013814-pv8plqt","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229013814-pv8plqt","updated":"20231229013821"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u"},{"Type":"NodeCodeBlockCode","Data":"import time\nimport pyperclip\nimport pyautogui\nimport schedule\n\n\ndef openWechat(str1, str2, str3):\n    pyautogui.keyDown(str1)\n    pyautogui.keyDown(str2)\n    pyautogui.keyDown(str3)\n    pyautogui.keyUp(str1)\n    pyautogui.keyUp(str2)\n    pyautogui.keyUp(str3)\n\n\ndef searchWechat(str1):\n    pyautogui.keyDown('command')\n    pyautogui.keyDown('f')\n    pyautogui.keyUp('command')\n    pyautogui.keyUp('f')\n    pyperclip.copy(str1)\n    paste()\n    time.sleep(1)\n    pyautogui.keyUp('command')\n    pyautogui.press('\\n')\n    time.sleep(1)\n\n\ndef sendMsg(str):\n    openWechat('ctrl', 'command', 'w')\n    openWechat('ctrl', 'command', 'w')  # 这两布的作用是聚焦输入框\n    pyperclip.copy(str)  # 需要发送的消息内容\n    paste()\n    time.sleep(1)\n    pyautogui.keyUp('command')\n    pyautogui.press('\\n')  # 内容\n\n\ndef paste():\n    pyautogui.keyDown('command')\n    pyautogui.keyDown('v')\n\n\ndef job1():\n    print(\"Sending message...\")\n    openWechat('ctrl', 'command', 'w')\n    openWechat('ctrl', 'command', 'w')\n    openWechat('ctrl', 'command', 'w')\n    searchWechat(\"公主\")\n    sendMsg('公主晚安')\n\n\ndef job2():\n    print(\"Sending message2...\")\n    openWechat('ctrl', 'command', 'w')\n    openWechat('ctrl', 'command', 'w')\n    searchWechat(\"公主\")\n    sendMsg('公主早安')\n    sendMsg('我再睡会啦')\n\n\n# 设置定时任务，每天早上5点20分执行一次\nschedule.every().day.at(\"02:30:00\").do(job1)\nschedule.every().day.at(\"07:00:00\").do(job2)\n\nwhile True:\n    schedule.run_pending()\n    time.sleep(1)\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229013824-n8qclez","Type":"NodeParagraph","Properties":{"id":"20231229013824-n8qclez"}}]}